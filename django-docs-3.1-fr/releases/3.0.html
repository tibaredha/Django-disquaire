
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Notes de publication de Django 3.0 &#8212; Documentation Django 3.1.3.dev</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Django 2.2.17 release notes" href="2.2.17.html" />
    <link rel="prev" title="Notes de publication de Django 3.0.1" href="3.0.1.html" />



 
<script src="../templatebuiltins.js"></script>
<script>
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);</script>

  </head><body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../index.html">Documentation Django 3.1.3.dev</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../index.html">Home</a>  |
        <a title="Table of contents" href="../contents.html">Table of contents</a>  |
        <a title="Global index" href="../genindex.html">Index</a>  |
        <a title="Module index" href="../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="3.0.1.html" title="Notes de publication de Django 3.0.1">previous</a>
     |
    <a href="index.html" title="Notes de publication" accesskey="U">up</a>
   |
    <a href="2.2.17.html" title="Django 2.2.17 release notes">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="releases-3.0">
            
  <div class="section" id="s-django-3-0-release-notes">
<span id="django-3-0-release-notes"></span><h1>Notes de publication de Django 3.0<a class="headerlink" href="#django-3-0-release-notes" title="Lien permanent vers ce titre">¶</a></h1>
<p><em>2 décembre 2019</em></p>
<p>Bienvenue dans Django 3.0&nbsp;!</p>
<p>Ces notes de publications couvrent les <a class="reference internal" href="#whats-new-3-0"><span class="std std-ref">nouvelles fonctionnalités</span></a>, ainsi que certaines <a class="reference internal" href="#backwards-incompatible-3-0"><span class="std std-ref">modifications non rétro-compatibles</span></a> dont il faut être au courant lors la mise à jour depuis Django 2.2 ou des versions plus anciennes. Nous avons <a class="reference internal" href="#removed-features-3-0"><span class="std std-ref">abandonné certaines fonctionnalités</span></a> qui ont atteint la fin de leur cycle d’obsolescence et nous avons commencé <a class="reference internal" href="#deprecated-features-3-0"><span class="std std-ref">le processus d’obsolescence de certaines fonctionnalités</span></a>.</p>
<p>Voir le guide <a class="reference internal" href="../howto/upgrade-version.html"><span class="doc">Mise à jour de Django à une version plus récente</span></a> si vous mettez à jour un projet existant.</p>
<div class="section" id="s-python-compatibility">
<span id="python-compatibility"></span><h2>Compatibilité Python<a class="headerlink" href="#python-compatibility" title="Lien permanent vers ce titre">¶</a></h2>
<p>Django 3.0 supports Python 3.6, 3.7, 3.8, and 3.9 (as of 3.0.11). We <strong>highly
recommend</strong> and only officially support the latest release of each series.</p>
<p>La série Django 2.2.x est la dernière à prendre en charge Python 3.5.</p>
</div>
<div class="section" id="s-third-party-library-support-for-older-version-of-django">
<span id="third-party-library-support-for-older-version-of-django"></span><h2>Prise en charge des bibliothèques tierces pour les anciennes versions de Django<a class="headerlink" href="#third-party-library-support-for-older-version-of-django" title="Lien permanent vers ce titre">¶</a></h2>
<p>Après la publication de Django 3.0, nous suggérons aux applications tierces de ne plus prendre en charge les versions de Django plus anciennes que 2.2. À ce moment, vous devriez pouvoir exécuter les tests de votre projet en utilisant python -Wd afin de faire apparaître les avertissements d’obsolescence. Après avoir corrigé ceux-ci, votre application devrait être compatible avec Django 3.0.</p>
</div>
<div class="section" id="s-what-s-new-in-django-3-0">
<span id="s-whats-new-3-0"></span><span id="what-s-new-in-django-3-0"></span><span id="whats-new-3-0"></span><h2>Quoi de neuf dans Django 3.0<a class="headerlink" href="#what-s-new-in-django-3-0" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="s-mariadb-support">
<span id="mariadb-support"></span><h3>Prise en charge de MariaDB<a class="headerlink" href="#mariadb-support" title="Lien permanent vers ce titre">¶</a></h3>
<p>Django prend dorénavant officiellement en charge <a class="reference external" href="https://mariadb.org/">MariaDB</a> 10.1 ou plus récent. Lisez les <a class="reference internal" href="../ref/databases.html#mariadb-notes"><span class="std std-ref">notes MariaDB</span></a> pour plus de détails.</p>
</div>
<div class="section" id="s-asgi-support">
<span id="asgi-support"></span><h3>Prise en charge d’ASGI<a class="headerlink" href="#asgi-support" title="Lien permanent vers ce titre">¶</a></h3>
<p>Django 3.0 commence le voyage vers la fonctionnalité asynchrone de Django en fournissant la prise en charge de l’exécution d’applications <a class="reference external" href="https://asgi.readthedocs.io/">ASGI</a>.</p>
<p>Il s’agit d’un ajout en plus de la prise en charge existante du protocole WSGI. Django prévoit de prendre en charge les deux à l’avenir. Les fonctionnalités asychrones ne seront toutefois disponibles que pour les applications fonctionnant avec ASGI.</p>
<p>At this stage async support only applies to the outer ASGI application.
Internally everything remains synchronous. Asynchronous middleware, views, etc.
are not yet supported. You can, however, use ASGI middleware around Django’s
application, allowing you to combine Django with other ASGI frameworks.</p>
<p>Aucun besoin de convertir vos applications sauf si vous souhaitez expérimenter avec du code asynchrone ; si vous souhaitez en savoir plus, vous pouvez lire la <a class="reference internal" href="../howto/deployment/asgi/index.html"><span class="doc">documentation sur le déploiement avec ASGI</span></a>.</p>
<p>Notez qu’un effet de bord de cette nouveauté est que Django sait maintenant détecter des boucles événementielles asynchrones et vous empêchera d’appeler du code marqué comme non adapté à l’asynchrone (« async unsafe »), tel que des opérations avec l’ORM, à partir d’un contexte asynchrone. Si vous utilisiez précédemment Django à partir de code asynchrone, ceci pourrait vous bloquer si vous ne le faisiez pas correctement. Si vous voyez une erreur <code class="docutils literal notranslate"><span class="pre">SynchronousOnlyOperation</span></code>, examinez attentivement votre code et déplacez d’éventuelles opérations de base de données plutôt dans un fil d’exécution synchrone.</p>
</div>
<div class="section" id="s-exclusion-constraints-on-postgresql">
<span id="exclusion-constraints-on-postgresql"></span><h3>Contraintes d’exclusion avec PostgreSQL<a class="headerlink" href="#exclusion-constraints-on-postgresql" title="Lien permanent vers ce titre">¶</a></h3>
<p>La nouvelle classe <a class="reference internal" href="../ref/contrib/postgres/constraints.html#django.contrib.postgres.constraints.ExclusionConstraint" title="django.contrib.postgres.constraints.ExclusionConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExclusionConstraint</span></code></a> permet d’ajouter des contraintes d’exclusion avec PostgreSQL Ces contraintes peuvent être ajoutées aux modèles en utilisant l’option <a class="reference internal" href="../ref/models/options.html#django.db.models.Options.constraints" title="django.db.models.Options.constraints"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Meta.constraints</span></code></a>.</p>
</div>
<div class="section" id="s-filter-expressions">
<span id="filter-expressions"></span><h3>Expressions de filtres<a class="headerlink" href="#filter-expressions" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les expressions qui produisent des résultats <a class="reference internal" href="../ref/models/fields.html#django.db.models.BooleanField" title="django.db.models.BooleanField"><code class="xref py py-class docutils literal notranslate"><span class="pre">BooleanField</span></code></a> peuvent dorénavant être directement utilisées dans des filtres <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code>, sans devoir passer par une annotation préalable et un filtre sur cette annotation.</p>
</div>
<div class="section" id="s-enumerations-for-model-field-choices">
<span id="enumerations-for-model-field-choices"></span><h3>Énumérations pour les choix de champs de modèles<a class="headerlink" href="#enumerations-for-model-field-choices" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les types d’énumération personnalisés <code class="docutils literal notranslate"><span class="pre">TextChoices</span></code>, <code class="docutils literal notranslate"><span class="pre">IntegerChoices</span></code> et <code class="docutils literal notranslate"><span class="pre">Choices</span></code> sont dorénavant disponibles dans l’optique de définir <a class="reference internal" href="../ref/models/fields.html#django.db.models.Field.choices" title="django.db.models.Field.choices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Field.choices</span></code></a>. Les types <code class="docutils literal notranslate"><span class="pre">TextChoices</span></code> et <code class="docutils literal notranslate"><span class="pre">IntegerChoices</span></code> sont fournis pour les champs texte et nombre entier. La classe <code class="docutils literal notranslate"><span class="pre">Choices</span></code> permet de définir une énumération compatible avec les autres types de données concrets. Ces types personnalisés prennent en charge les étiquettes conviviales pouvant être traduites et obtenues par une propriété de l’énumération ou de ses membres. Lisez <a class="reference internal" href="../ref/models/fields.html#field-choices-enum-types"><span class="std std-ref">Types énumératifs</span></a> pour plus de détails et des exemples.</p>
</div>
<div class="section" id="s-minor-features">
<span id="minor-features"></span><h3>Fonctionnalités mineures<a class="headerlink" href="#minor-features" title="Lien permanent vers ce titre">¶</a></h3>
<div class="section" id="s-django-contrib-admin">
<span id="django-contrib-admin"></span><h4><a class="reference internal" href="../ref/contrib/admin/index.html#module-django.contrib.admin" title="django.contrib.admin: Django's admin site."><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.admin</span></code></a><a class="headerlink" href="#django-contrib-admin" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>La prise en charge de l’attribut <code class="docutils literal notranslate"><span class="pre">admin_order_field</span></code> pour les propriétés dans <a class="reference internal" href="../ref/contrib/admin/index.html#django.contrib.admin.ModelAdmin.list_display" title="django.contrib.admin.ModelAdmin.list_display"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelAdmin.list_display</span></code></a>.</li>
<li>La nouvelle méthode <a class="reference internal" href="../ref/contrib/admin/index.html#django.contrib.admin.ModelAdmin.get_inlines" title="django.contrib.admin.ModelAdmin.get_inlines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ModelAdmin.get_inlines()</span></code></a> permet de définir les sous-formulaires intégrés sur la base de la requête ou de l’instance de modèle.</li>
<li>La bibliothèque Select2 a été mise à jour de la version 4.0.3 vers 4.0.7.</li>
<li>La version intégrée de jQuery a été mise à jour de 3.3.1 vers 3.4.1.</li>
</ul>
</div>
<div class="section" id="s-django-contrib-auth">
<span id="django-contrib-auth"></span><h4><a class="reference internal" href="../topics/auth/index.html#module-django.contrib.auth" title="django.contrib.auth: Django's authentication framework."><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.auth</span></code></a><a class="headerlink" href="#django-contrib-auth" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>Le nouvel attribut <code class="docutils literal notranslate"><span class="pre">reset_url_token</span></code> dans <a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.views.PasswordResetConfirmView" title="django.contrib.auth.views.PasswordResetConfirmView"><code class="xref py py-class docutils literal notranslate"><span class="pre">PasswordResetConfirmView</span></code></a> permet de définir un paramètre jeton affiché comme composant des URL de réinitialisation de mot de passe.</li>
<li>La classe <a class="reference internal" href="../ref/contrib/auth.html#django.contrib.auth.backends.BaseBackend" title="django.contrib.auth.backends.BaseBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseBackend</span></code></a> a été ajoutée pour faciliter la personnalisation des moteurs d’authentification.</li>
<li>La méthode <a class="reference internal" href="../ref/contrib/auth.html#django.contrib.auth.models.User.get_user_permissions" title="django.contrib.auth.models.User.get_user_permissions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_user_permissions()</span></code></a> a été ajoutée pour faire écho à la méthode existante <a class="reference internal" href="../ref/contrib/auth.html#django.contrib.auth.models.User.get_group_permissions" title="django.contrib.auth.models.User.get_group_permissions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_group_permissions()</span></code></a>.</li>
<li>L’attribut HTML <code class="docutils literal notranslate"><span class="pre">autocomplete</span></code> a été ajouté aux composants des champs nom d’utilisateur, courriel et mot de passe dans <a class="reference internal" href="../topics/auth/default.html#module-django.contrib.auth.forms" title="django.contrib.auth.forms"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.auth.forms</span></code></a> pour une meilleure interaction avec les gestionnaires de mots de passe des navigateurs.</li>
<li><a class="reference internal" href="../ref/django-admin.html#django-admin-createsuperuser"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">createsuperuser</span></code></a> se replie sur les variables d’environnement pour les champs mot de passe et autres champs obligatoires, lorsqu’elle ne trouve pas de paramètre correspondant sur la ligne de commande en mode non interactif.</li>
<li><a class="reference internal" href="../topics/auth/customizing.html#django.contrib.auth.models.CustomUser.REQUIRED_FIELDS" title="django.contrib.auth.models.CustomUser.REQUIRED_FIELDS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">REQUIRED_FIELDS</span></code></a> prend dorénavant en charge les champs <a class="reference internal" href="../ref/models/fields.html#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a>.</li>
<li>La nouvelle méthode <a class="reference internal" href="../ref/contrib/auth.html#django.contrib.auth.models.UserManager.with_perm" title="django.contrib.auth.models.UserManager.with_perm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UserManager.with_perm()</span></code></a> renvoie les utilisateurs ayant la permission indiquée.</li>
<li>Le nombre d’itération par défaut du hacheur de mot de passe PBKDF2 a été augmenté de 150’000 à 180’000.</li>
</ul>
</div>
<div class="section" id="s-django-contrib-gis">
<span id="django-contrib-gis"></span><h4><a class="reference internal" href="../ref/contrib/gis/index.html#module-django.contrib.gis" title="django.contrib.gis: Geographic Information System (GIS) extensions for Django"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.gis</span></code></a><a class="headerlink" href="#django-contrib-gis" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>Les fonctions de requête spatiale MySQL opèrent dorénavant sur les géométries réelles. Précédemment, seules les boîtes englobantes étaient prises en compte.</li>
<li>La fonction <a class="reference internal" href="../ref/contrib/gis/functions.html#django.contrib.gis.db.models.functions.GeometryDistance" title="django.contrib.gis.db.models.functions.GeometryDistance"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometryDistance</span></code></a> a été ajoutée, prise en charge par PostGIS.</li>
<li>La prise en charge de l’unité <code class="docutils literal notranslate"><span class="pre">furlong</span></code> (sillon) a été ajoutée dans <a class="reference internal" href="../ref/contrib/gis/measure.html#django.contrib.gis.measure.Distance" title="django.contrib.gis.measure.Distance"><code class="xref py py-class docutils literal notranslate"><span class="pre">Distance</span></code></a>.</li>
<li>Le réglage <a class="reference internal" href="../ref/contrib/gis/geoip2.html#std:setting-GEOIP_PATH"><code class="xref std std-setting docutils literal notranslate"><span class="pre">GEOIP_PATH</span></code></a> accepte maintenant les chemins <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(disponible dans Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>.</li>
<li>La classe <a class="reference internal" href="../ref/contrib/gis/geoip2.html#django.contrib.gis.geoip2.GeoIP2" title="django.contrib.gis.geoip2.GeoIP2"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeoIP2</span></code></a> accepte maintenant les chemins <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(disponible dans Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>.</li>
</ul>
</div>
<div class="section" id="s-django-contrib-postgres">
<span id="django-contrib-postgres"></span><h4><a class="reference internal" href="../ref/contrib/postgres/index.html#module-django.contrib.postgres" title="django.contrib.postgres: PostgreSQL-specific fields and features"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.postgres</span></code></a><a class="headerlink" href="#django-contrib-postgres" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>La nouvelle classe <a class="reference internal" href="../ref/contrib/postgres/fields.html#django.contrib.postgres.fields.RangeOperators" title="django.contrib.postgres.fields.RangeOperators"><code class="xref py py-class docutils literal notranslate"><span class="pre">RangeOperators</span></code></a> aide à éviter les erreurs de syntaxe dans les opérateurs SQL qui peuvent être utilisés conjointement avec <a class="reference internal" href="../ref/contrib/postgres/fields.html#django.contrib.postgres.fields.RangeField" title="django.contrib.postgres.fields.RangeField"><code class="xref py py-class docutils literal notranslate"><span class="pre">RangeField</span></code></a>.</li>
<li>La nouvelle expression <a class="reference internal" href="../ref/contrib/postgres/fields.html#django.contrib.postgres.fields.RangeBoundary" title="django.contrib.postgres.fields.RangeBoundary"><code class="xref py py-class docutils literal notranslate"><span class="pre">RangeBoundary</span></code></a> représente les limites des intervalles.</li>
<li>Les nouvelles classes <a class="reference internal" href="../ref/contrib/postgres/operations.html#django.contrib.postgres.operations.AddIndexConcurrently" title="django.contrib.postgres.operations.AddIndexConcurrently"><code class="xref py py-class docutils literal notranslate"><span class="pre">AddIndexConcurrently</span></code></a> et <a class="reference internal" href="../ref/contrib/postgres/operations.html#django.contrib.postgres.operations.RemoveIndexConcurrently" title="django.contrib.postgres.operations.RemoveIndexConcurrently"><code class="xref py py-class docutils literal notranslate"><span class="pre">RemoveIndexConcurrently</span></code></a> permettent de créer et de supprimer des index de manière concurrente avec PostgreSQL.</li>
</ul>
</div>
<div class="section" id="s-django-contrib-sessions">
<span id="django-contrib-sessions"></span><h4><a class="reference internal" href="../topics/http/sessions.html#module-django.contrib.sessions" title="django.contrib.sessions: Provides session management for Django projects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.sessions</span></code></a><a class="headerlink" href="#django-contrib-sessions" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>La nouvelle méthode <a class="reference internal" href="../topics/http/sessions.html#django.contrib.sessions.backends.base.SessionBase.get_session_cookie_age" title="django.contrib.sessions.backends.base.SessionBase.get_session_cookie_age"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_session_cookie_age()</span></code></a> permet de définir dynmaiquement l’âge du cookie de session.</li>
</ul>
</div>
<div class="section" id="s-django-contrib-syndication">
<span id="django-contrib-syndication"></span><h4><a class="reference internal" href="../ref/contrib/syndication.html#module-django.contrib.syndication" title="django.contrib.syndication: A framework for generating syndication feeds, in RSS and Atom, quite easily."><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.syndication</span></code></a><a class="headerlink" href="#django-contrib-syndication" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>Un attribut de classe <code class="docutils literal notranslate"><span class="pre">language</span></code> a été ajouté à <a class="reference internal" href="../ref/contrib/syndication.html#django.contrib.syndication.views.Feed" title="django.contrib.syndication.views.Feed"><code class="xref py py-class docutils literal notranslate"><span class="pre">django.contrib.syndication.views.Feed</span></code></a> pour pouvoir personnaliser la langue d’un flux. La valeur par défaut est <a class="reference internal" href="../ref/utils.html#django.utils.translation.get_language" title="django.utils.translation.get_language"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_language()</span></code></a> au lieu de <a class="reference internal" href="../ref/settings.html#std:setting-LANGUAGE_CODE"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LANGUAGE_CODE</span></code></a>.</li>
</ul>
</div>
<div class="section" id="s-cache">
<span id="cache"></span><h4>Cache<a class="headerlink" href="#cache" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li><a class="reference internal" href="../ref/utils.html#django.utils.cache.add_never_cache_headers" title="django.utils.cache.add_never_cache_headers"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_never_cache_headers()</span></code></a> et <a class="reference internal" href="../topics/http/decorators.html#django.views.decorators.cache.never_cache" title="django.views.decorators.cache.never_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">never_cache()</span></code></a> ajoutent dorénavant la directive <code class="docutils literal notranslate"><span class="pre">private</span></code> aux en-têtes <code class="docutils literal notranslate"><span class="pre">Cache-Control</span></code>.</li>
</ul>
</div>
<div class="section" id="s-file-storage">
<span id="file-storage"></span><h4>Stockage de fichier<a class="headerlink" href="#file-storage" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>La nouvelle méthode <a class="reference internal" href="../ref/files/storage.html#django.core.files.storage.Storage.get_alternative_name" title="django.core.files.storage.Storage.get_alternative_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Storage.get_alternative_name()</span></code></a> permet d’adapter l’algorithme de génération des noms de fichiers lorsque le nom d’un fichier téléversé existe déjà.</li>
</ul>
</div>
<div class="section" id="s-forms">
<span id="forms"></span><h4>Formulaires<a class="headerlink" href="#forms" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>Les jeux de formulaires peuvent contrôler le composant utilisé pour le tri des formulaires avec <a class="reference internal" href="../topics/forms/formsets.html#django.forms.formsets.BaseFormSet.can_order" title="django.forms.formsets.BaseFormSet.can_order"><code class="xref py py-attr docutils literal notranslate"><span class="pre">can_order</span></code></a> en définissant l’attribut <a class="reference internal" href="../topics/forms/formsets.html#django.forms.formsets.BaseFormSet.ordering_widget" title="django.forms.formsets.BaseFormSet.ordering_widget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ordering_widget</span></code></a> ou en surchargeant <a class="reference internal" href="../topics/forms/formsets.html#django.forms.formsets.BaseFormSet.get_ordering_widget" title="django.forms.formsets.BaseFormSet.get_ordering_widget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">get_ordering_widget()</span></code></a>.</li>
</ul>
</div>
<div class="section" id="s-internationalization">
<span id="internationalization"></span><h4>Internationalisation<a class="headerlink" href="#internationalization" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>Les réglages <a class="reference internal" href="../ref/settings.html#std:setting-LANGUAGE_COOKIE_HTTPONLY"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LANGUAGE_COOKIE_HTTPONLY</span></code></a>, <a class="reference internal" href="../ref/settings.html#std:setting-LANGUAGE_COOKIE_SAMESITE"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LANGUAGE_COOKIE_SAMESITE</span></code></a> et <a class="reference internal" href="../ref/settings.html#std:setting-LANGUAGE_COOKIE_SECURE"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LANGUAGE_COOKIE_SECURE</span></code></a> ont été ajoutés pour définir les drapeaux <code class="docutils literal notranslate"><span class="pre">HttpOnly</span></code>, <code class="docutils literal notranslate"><span class="pre">SameSite</span></code> et <code class="docutils literal notranslate"><span class="pre">Secure</span></code> sur les cookies de langue. Les valeurs par défaut de ces réglages préservent le comportement historique.</li>
<li>La prise en charge des traductions en ouzbek a été ajoutée.</li>
</ul>
</div>
<div class="section" id="s-logging">
<span id="logging"></span><h4>Journalisation<a class="headerlink" href="#logging" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>Le nouveau paramètre <code class="docutils literal notranslate"><span class="pre">reporter_class</span></code> de <a class="reference internal" href="../topics/logging.html#django.utils.log.AdminEmailHandler" title="django.utils.log.AdminEmailHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdminEmailHandler</span></code></a> permet de fournir une sous-classe de <code class="docutils literal notranslate"><span class="pre">django.views.debug.ExceptionReporter</span></code> pour personnaliser le texte de trace d’erreur envoyé aux <a class="reference internal" href="../ref/settings.html#std:setting-ADMINS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">ADMINS</span></code></a> du site lorsque <a class="reference internal" href="../ref/settings.html#std:setting-DEBUG"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DEBUG</span></code></a> vaut <code class="docutils literal notranslate"><span class="pre">False</span></code>.</li>
</ul>
</div>
<div class="section" id="s-management-commands">
<span id="management-commands"></span><h4>Commandes d’administration<a class="headerlink" href="#management-commands" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>La nouvelle option <a class="reference internal" href="../ref/django-admin.html#cmdoption-compilemessages-ignore"><code class="xref std std-option docutils literal notranslate"><span class="pre">compilemessages</span> <span class="pre">--ignore</span></code></a> permet d’ignorer des répertoires spécifiques lors de la recherche de fichiers <code class="docutils literal notranslate"><span class="pre">.po</span></code> à compiler.</li>
<li><a class="reference internal" href="../ref/django-admin.html#cmdoption-showmigrations-list"><code class="xref std std-option docutils literal notranslate"><span class="pre">showmigrations</span> <span class="pre">--list</span></code></a> affiche dorénavant la date d’application  lorsque <code class="docutils literal notranslate"><span class="pre">--verbosity</span></code> est de 2 ou plus.</li>
<li>Avec PostgreSQL,  <a class="reference internal" href="../ref/django-admin.html#django-admin-dbshell"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">dbshell</span></code></a> prend dorénavant en charge les certificats TLS client.</li>
<li><a class="reference internal" href="../ref/django-admin.html#django-admin-inspectdb"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">inspectdb</span></code></a> sait dorénavant découvrir les champs <a class="reference internal" href="../ref/models/fields.html#django.db.models.OneToOneField" title="django.db.models.OneToOneField"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneToOneField</span></code></a> lorsqu’une clé étrangère possède une contrainte unique ou de clé primaire.</li>
<li>La nouvelle option <a class="reference internal" href="../ref/django-admin.html#cmdoption-skip-checks"><code class="xref std std-option docutils literal notranslate"><span class="pre">--skip-checks</span></code></a> omet l’exécution des contrôles système avant de lancer la commande.</li>
<li>Les options <a class="reference internal" href="../ref/django-admin.html#cmdoption-startapp-template"><code class="xref std std-option docutils literal notranslate"><span class="pre">startapp</span> <span class="pre">--template</span></code></a> et <a class="reference internal" href="../ref/django-admin.html#cmdoption-startproject-template"><code class="xref std std-option docutils literal notranslate"><span class="pre">startproject</span> <span class="pre">--template</span></code></a> prennent maintenant en charge les gabarits stockés dans des archives XZ (<code class="docutils literal notranslate"><span class="pre">.tar.xz</span></code>, <code class="docutils literal notranslate"><span class="pre">.txz</span></code>) et LZMA (<code class="docutils literal notranslate"><span class="pre">.tar.lzma</span></code>, <code class="docutils literal notranslate"><span class="pre">.tlz</span></code>).</li>
</ul>
</div>
<div class="section" id="s-models">
<span id="models"></span><h4>Modèles<a class="headerlink" href="#models" title="Lien permanent vers ce titre">¶</a></h4>
<ul>
<li><p class="first">Les fonctions de base de données de génération d’empreintes <a class="reference internal" href="../ref/models/database-functions.html#django.db.models.functions.MD5" title="django.db.models.functions.MD5"><code class="xref py py-class docutils literal notranslate"><span class="pre">MD5</span></code></a>, <a class="reference internal" href="../ref/models/database-functions.html#django.db.models.functions.SHA1" title="django.db.models.functions.SHA1"><code class="xref py py-class docutils literal notranslate"><span class="pre">SHA1</span></code></a>, <a class="reference internal" href="../ref/models/database-functions.html#django.db.models.functions.SHA224" title="django.db.models.functions.SHA224"><code class="xref py py-class docutils literal notranslate"><span class="pre">SHA224</span></code></a>, <a class="reference internal" href="../ref/models/database-functions.html#django.db.models.functions.SHA256" title="django.db.models.functions.SHA256"><code class="xref py py-class docutils literal notranslate"><span class="pre">SHA256</span></code></a>, <a class="reference internal" href="../ref/models/database-functions.html#django.db.models.functions.SHA384" title="django.db.models.functions.SHA384"><code class="xref py py-class docutils literal notranslate"><span class="pre">SHA384</span></code></a> et <a class="reference internal" href="../ref/models/database-functions.html#django.db.models.functions.SHA512" title="django.db.models.functions.SHA512"><code class="xref py py-class docutils literal notranslate"><span class="pre">SHA512</span></code></a> ont été ajoutées.</p>
</li>
<li><p class="first">La fonction de base de données <a class="reference internal" href="../ref/models/database-functions.html#django.db.models.functions.Sign" title="django.db.models.functions.Sign"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sign</span></code></a> a été ajoutée.</p>
</li>
<li><p class="first">Le nouveau paramètre <code class="docutils literal notranslate"><span class="pre">is_dst</span></code> des fonctions de base de données <a class="reference internal" href="../ref/models/database-functions.html#django.db.models.functions.Trunc" title="django.db.models.functions.Trunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trunc</span></code></a> détermine le traitement des heures non existantes ou ambiguës.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">connection.queries</span></code> affiche dorénavant les instructions <code class="docutils literal notranslate"><span class="pre">COPY</span> <span class="pre">…</span> <span class="pre">TO</span></code> avec PostgreSQL.</p>
</li>
<li><p class="first"><a class="reference internal" href="../ref/models/fields.html#django.db.models.FilePathField" title="django.db.models.FilePathField"><code class="xref py py-class docutils literal notranslate"><span class="pre">FilePathField</span></code></a> accepte dorénavant un objet exécutable pour <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
</li>
<li><p class="first">Les tables intermédiaires symétriques sont permises pour les champs auto-référencés <a class="reference internal" href="../ref/models/fields.html#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a>.</p>
</li>
<li><p class="first">Les attributs <code class="docutils literal notranslate"><span class="pre">name</span></code> de <a class="reference internal" href="../ref/models/constraints.html#django.db.models.CheckConstraint" title="django.db.models.CheckConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">CheckConstraint</span></code></a>, <a class="reference internal" href="../ref/models/constraints.html#django.db.models.UniqueConstraint" title="django.db.models.UniqueConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueConstraint</span></code></a> et <a class="reference internal" href="../ref/models/indexes.html#django.db.models.Index" title="django.db.models.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a> prennent dorénavant en charge l’interpolation de classe et d’étiquette d’application en utilisant les substituants <code class="docutils literal notranslate"><span class="pre">'%(app_label)s'</span></code> et <code class="docutils literal notranslate"><span class="pre">'%(class)s'</span></code>.</p>
</li>
<li><p class="first">Le nouvel attribut <a class="reference internal" href="../ref/models/fields.html#django.db.models.Field.descriptor_class" title="django.db.models.Field.descriptor_class"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Field.descriptor_class</span></code></a> permet aux champs de modèles de personnaliser le comportement get et set en surchargeant leurs <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#descriptors" title="(disponible dans Python v3.9)"><span class="xref std std-ref">descripteurs</span></a>.</p>
</li>
<li><p class="first"><a class="reference internal" href="../ref/models/querysets.html#django.db.models.Avg" title="django.db.models.Avg"><code class="xref py py-class docutils literal notranslate"><span class="pre">Avg</span></code></a> et <a class="reference internal" href="../ref/models/querysets.html#django.db.models.Sum" title="django.db.models.Sum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sum</span></code></a> acceptent dorénavant un paramètre <code class="docutils literal notranslate"><span class="pre">distinct</span></code>.</p>
</li>
<li><p class="first">Le champ <a class="reference internal" href="../ref/models/fields.html#django.db.models.SmallAutoField" title="django.db.models.SmallAutoField"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmallAutoField</span></code></a> a été ajouté ; il est similaire à <a class="reference internal" href="../ref/models/fields.html#django.db.models.AutoField" title="django.db.models.AutoField"><code class="xref py py-class docutils literal notranslate"><span class="pre">AutoField</span></code></a> sauf qu’il ne permet des valeurs que jusqu’à une certaine limite (dépendante de la base de données). Les valeurs de <code class="docutils literal notranslate"><span class="pre">1</span></code> à <code class="docutils literal notranslate"><span class="pre">32767</span></code> sont valables pour toutes les bases de données prises en charge par Django.</p>
</li>
<li><p class="first"><a class="reference internal" href="../ref/models/fields.html#django.db.models.AutoField" title="django.db.models.AutoField"><code class="xref py py-class docutils literal notranslate"><span class="pre">AutoField</span></code></a>, <a class="reference internal" href="../ref/models/fields.html#django.db.models.BigAutoField" title="django.db.models.BigAutoField"><code class="xref py py-class docutils literal notranslate"><span class="pre">BigAutoField</span></code></a> et <a class="reference internal" href="../ref/models/fields.html#django.db.models.SmallAutoField" title="django.db.models.SmallAutoField"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmallAutoField</span></code></a> héritent dorénavant respectivement de <code class="docutils literal notranslate"><span class="pre">IntegerField</span></code>, <code class="docutils literal notranslate"><span class="pre">BigIntegerField</span></code> et <code class="docutils literal notranslate"><span class="pre">SmallIntegerField</span></code>. Les contrôles système et les validateurs sont aussi correctement hérités.</p>
</li>
<li><p class="first"><a class="reference internal" href="../ref/models/fields.html#django.db.models.FileField.upload_to" title="django.db.models.FileField.upload_to"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FileField.upload_to</span></code></a> accepte maintenant les chemins <a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(disponible dans Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>.</p>
</li>
<li><p class="first"><a class="reference internal" href="../ref/models/constraints.html#django.db.models.CheckConstraint" title="django.db.models.CheckConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">CheckConstraint</span></code></a> est dorénavant prise en charge avec MySQL 8.0.16+.</p>
</li>
<li><p class="first">La nouvelle méthode <code class="docutils literal notranslate"><span class="pre">allows_group_by_selected_pks_on_model()</span></code> de <code class="docutils literal notranslate"><span class="pre">django.db.backends.base.BaseDatabaseFeatures</span></code> permet d’optimiser les clauses <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> pour n’exiger que les clés primaires des modèles sélectionnés. Par défaut, elle n’est prise en charge que pour les modèles gérés avec PostgreSQL.</p>
<p>Pour activer l’optimisation de clé primaire seule pour <code class="docutils literal notranslate"><span class="pre">GROUP</span> <span class="pre">BY</span></code> pour les modèles non gérés (« unmanaged »), vous deez créer une sous-classe du moteur de base de données PostgreSQL, surchargeant la classe de fonctionnalité <code class="docutils literal notranslate"><span class="pre">features</span></code> avec une méthode <code class="docutils literal notranslate"><span class="pre">allows_group_by_selected_pks_on_model()</span></code> selon vos besoins. Voir l’exemple <a class="reference internal" href="../ref/databases.html#subclassing-database-backends"><span class="std std-ref">Sous-classes des moteurs de base de données intégrés</span></a>.</p>
</li>
</ul>
</div>
<div class="section" id="s-requests-and-responses">
<span id="requests-and-responses"></span><h4>Requêtes et réponses<a class="headerlink" href="#requests-and-responses" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li><a class="reference internal" href="../ref/request-response.html#django.http.HttpResponse" title="django.http.HttpResponse"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpResponse</span></code></a> peut maintenant être initialisée avec du contenu <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#memoryview" title="(disponible dans Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">memoryview</span></code></a>.</li>
<li>For use in, for example, Django templates, <a class="reference internal" href="../ref/request-response.html#django.http.HttpRequest.headers" title="django.http.HttpRequest.headers"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HttpRequest.headers</span></code></a> now
allows lookups using underscores (e.g. <code class="docutils literal notranslate"><span class="pre">user_agent</span></code>) in place of hyphens.</li>
</ul>
</div>
<div class="section" id="s-security">
<span id="s-whats-new-security-3-0"></span><span id="security"></span><span id="whats-new-security-3-0"></span><h4>Sécurité<a class="headerlink" href="#security" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>La valeur par défaut de <a class="reference internal" href="../ref/settings.html#std:setting-X_FRAME_OPTIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">X_FRAME_OPTIONS</span></code></a> est dorénavant <code class="docutils literal notranslate"><span class="pre">'DENY'</span></code>. Dans les anciennes versions, cette valeur par défaut était <code class="docutils literal notranslate"><span class="pre">'SAMEORIGIN'</span></code>. Si votre site utilise des cadres (« frames ») de lui-même, vous devrez explicitement définir <code class="docutils literal notranslate"><span class="pre">X_FRAME_OPTIONS</span> <span class="pre">=</span> <span class="pre">'SAMEORIGIN'</span></code> pour qu’ils continuent à fonctionner.</li>
<li><a class="reference internal" href="../ref/settings.html#std:setting-SECURE_CONTENT_TYPE_NOSNIFF"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_CONTENT_TYPE_NOSNIFF</span></code></a> now defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>. With this
enabled, <a class="reference internal" href="../ref/middleware.html#django.middleware.security.SecurityMiddleware" title="django.middleware.security.SecurityMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code></a> sets the
<a class="reference internal" href="../ref/middleware.html#x-content-type-options"><span class="std std-ref">X-Content-Type-Options: nosniff</span></a> header on all responses that do not already
have it.</li>
<li><a class="reference internal" href="../ref/middleware.html#django.middleware.security.SecurityMiddleware" title="django.middleware.security.SecurityMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code></a> peut dorénavant envoyer l’en-tête <a class="reference internal" href="../ref/middleware.html#referrer-policy"><span class="std std-ref">Referrer-Policy</span></a>.</li>
</ul>
</div>
<div class="section" id="s-tests">
<span id="tests"></span><h4>Tests<a class="headerlink" href="#tests" title="Lien permanent vers ce titre">¶</a></h4>
<ul class="simple">
<li>Le nouveau paramètre <code class="docutils literal notranslate"><span class="pre">raise_request_exception</span></code> de la classe de test <a class="reference internal" href="../topics/testing/tools.html#django.test.Client" title="django.test.Client"><code class="xref py py-class docutils literal notranslate"><span class="pre">Client</span></code></a> permet de contrôler si les exceptions générées pendant la requête doivent être propagées dans les tests. La valeur par défaut est <code class="docutils literal notranslate"><span class="pre">True</span></code> pour des raisons de rétrocompatibilité. Quand elle vaut <code class="docutils literal notranslate"><span class="pre">False</span></code> et qu’une exception survient, le client de test renverra une réponse 500 avec l’attribut <a class="reference internal" href="../topics/testing/tools.html#django.test.Response.exc_info" title="django.test.Response.exc_info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">exc_info</span></code></a>, un tuple fournissant des informations sur l’exception survenue.</li>
<li>Les tests et les cas de tests à lancer peuvent être choisis par un motif de nom de test à l’aide de la nouvelle option <a class="reference internal" href="../ref/django-admin.html#cmdoption-test-k"><code class="xref std std-option docutils literal notranslate"><span class="pre">test</span> <span class="pre">-k</span></code></a>.</li>
<li>La comparaison HTML, telle qu’utilisée par <a class="reference internal" href="../topics/testing/tools.html#django.test.SimpleTestCase.assertHTMLEqual" title="django.test.SimpleTestCase.assertHTMLEqual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assertHTMLEqual()</span></code></a> traite dorénavant le texte, les références de caractères et les références d’entité qui se réfèrent au même caractère comme équivalents.</li>
<li>Le lanceur de tests de Django prend dorénavant en charge le mode sans interface pour les tests Selenium avec les navigateurs pris en charge. Ajoutez l’option <code class="docutils literal notranslate"><span class="pre">--headless</span></code> pour activer ce mode.</li>
<li>Le lanceur de tests de Django prend dorénavant en charge les options <code class="docutils literal notranslate"><span class="pre">--start-at</span></code> et <code class="docutils literal notranslate"><span class="pre">--start-after</span></code> pour lancer les tests en commençant à partir d’un certain module de premier niveau.</li>
<li>Le lanceur de tests de Django prend dorénavant en charge une option <code class="docutils literal notranslate"><span class="pre">--pdb</span></code> pour déclencher un débogueur à chaque erreur ou échec.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="s-backwards-incompatible-changes-in-3-0">
<span id="s-backwards-incompatible-3-0"></span><span id="backwards-incompatible-changes-in-3-0"></span><span id="backwards-incompatible-3-0"></span><h2>Changements incompatibles avec les anciennes versions dans Django 3.0<a class="headerlink" href="#backwards-incompatible-changes-in-3-0" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="s-model-save-when-providing-a-default-for-the-primary-key">
<span id="model-save-when-providing-a-default-for-the-primary-key"></span><h3><code class="docutils literal notranslate"><span class="pre">Model.save()</span></code> when providing a default for the primary key<a class="headerlink" href="#model-save-when-providing-a-default-for-the-primary-key" title="Lien permanent vers ce titre">¶</a></h3>
<p><a class="reference internal" href="../ref/models/instances.html#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.save()</span></code></a> no longer attempts to find a row when saving a new
<code class="docutils literal notranslate"><span class="pre">Model</span></code> instance and a default value for the primary key is provided, and
always performs a single <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> query. In older Django versions,
<code class="docutils literal notranslate"><span class="pre">Model.save()</span></code> performed either an <code class="docutils literal notranslate"><span class="pre">INSERT</span></code> or an <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> based on
whether or not the row exists.</p>
<p>This makes calling <code class="docutils literal notranslate"><span class="pre">Model.save()</span></code> while providing a default primary key value
equivalent to passing <a class="reference internal" href="../ref/models/instances.html#ref-models-force-insert"><span class="std std-ref">force_insert=True</span></a> to
model’s <code class="docutils literal notranslate"><span class="pre">save()</span></code>. Attempts to use a new <code class="docutils literal notranslate"><span class="pre">Model</span></code> instance to update an
existing row will result in an <code class="docutils literal notranslate"><span class="pre">IntegrityError</span></code>.</p>
<p>In order to update an existing model for a specific primary key value, use the
<a class="reference internal" href="../ref/models/querysets.html#django.db.models.query.QuerySet.update_or_create" title="django.db.models.query.QuerySet.update_or_create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_or_create()</span></code></a> method or
<code class="docutils literal notranslate"><span class="pre">QuerySet.filter(pk=…).update(…)</span></code> instead. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MyModel</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">update_or_create</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">existing_pk</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;new name&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MyModel</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">existing_pk</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;new name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-database-backend-api">
<span id="database-backend-api"></span><h3>API de moteur de base de données<a class="headerlink" href="#database-backend-api" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette section décrit des modifications qui pourraient être nécessaires dans des moteurs de base de données tiers.</p>
<ul class="simple">
<li>Le second paramètre de <code class="docutils literal notranslate"><span class="pre">DatabaseIntrospection.get_geometry_type()</span></code> est dorénavant la description de la ligne au lieu du nom de la colonne.</li>
<li><code class="docutils literal notranslate"><span class="pre">DatabaseIntrospection.get_field_type()</span></code> ne renvoie plus forcément des tuples.</li>
<li>Si une base de données peut créer des clés étrangères dans la même instruction SQL qui ajoute un champ, ajoutez l’attribut <code class="docutils literal notranslate"><span class="pre">SchemaEditor.sql_create_column_inline_fk</span></code> à son moteur, avec le contenu SQL approprié ; sinon, définissez <code class="docutils literal notranslate"><span class="pre">DatabaseFeatures.can_create_inline_fk</span> <span class="pre">=</span> <span class="pre">False</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">DatabaseFeatures.can_return_id_from_insert</span></code> et <code class="docutils literal notranslate"><span class="pre">can_return_ids_from_bulk_insert</span></code> sont renommés en <code class="docutils literal notranslate"><span class="pre">can_return_columns_from_insert</span></code> et <code class="docutils literal notranslate"><span class="pre">can_return_rows_from_bulk_insert</span></code>.</li>
<li>Les fonctions de base de données prennent maintenant en charge les formats <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timezone" title="(disponible dans Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.timezone</span></code></a> lorsqu’elles sont créées avec des instances <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(disponible dans Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.timedelta</span></code></a> (par ex. <code class="docutils literal notranslate"><span class="pre">timezone(timedelta(hours=5))</span></code>, qui produirait <code class="docutils literal notranslate"><span class="pre">'UTC+05:00'</span></code>). Les moteurs tiers doivent prendre en compte ce format lors de la préparation de <a class="reference internal" href="../ref/models/fields.html#django.db.models.DateTimeField" title="django.db.models.DateTimeField"><code class="xref py py-class docutils literal notranslate"><span class="pre">DateTimeField</span></code></a> dans <code class="docutils literal notranslate"><span class="pre">datetime_cast_date_sql()</span></code>, <code class="docutils literal notranslate"><span class="pre">datetime_extract_sql()</span></code>, etc.</li>
<li>Des lignes sont ajoutées à <code class="docutils literal notranslate"><span class="pre">DatabaseOperations.integer_field_ranges</span></code> pour les champs <code class="docutils literal notranslate"><span class="pre">AutoField</span></code>, <code class="docutils literal notranslate"><span class="pre">BigAutoField</span></code> et <code class="docutils literal notranslate"><span class="pre">SmallAutoField</span></code> afin de prendre en charge les validateurs d’intervalles de nombres entiers pour ces types de champ. Les moteurs tiers pourraient avoir à adapter les lignes par défaut.</li>
<li><code class="docutils literal notranslate"><span class="pre">DatabaseOperations.fetch_returned_insert_id()</span></code> est remplacée par <code class="docutils literal notranslate"><span class="pre">fetch_returned_insert_columns()</span></code> qui renvoie une liste de valeurs renvoyées par l’instruction <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">…</span> <span class="pre">RETURNING</span></code> au lieu d’une valeur unique.</li>
<li><code class="docutils literal notranslate"><span class="pre">DatabaseOperations.return_insert_id()</span></code> est remplacée par <code class="docutils literal notranslate"><span class="pre">return_insert_columns()</span></code> qui accepte un paramètre <code class="docutils literal notranslate"><span class="pre">fields</span></code> qui est un itérable de champs à renvoyer après l’insertion. Généralement, il ne s’agit que du champ clé primaire auto-généré.</li>
</ul>
</div>
<div class="section" id="s-id1">
<span id="id1"></span><h3><a class="reference internal" href="../ref/contrib/admin/index.html#module-django.contrib.admin" title="django.contrib.admin: Django's admin site."><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.admin</span></code></a><a class="headerlink" href="#id1" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li>Les messages de changement des historiques de modèle du site d’administration préfèrent dorénavant les étiquettes de champ plus lisibles plutôt que les noms de champ.</li>
</ul>
</div>
<div class="section" id="s-id2">
<span id="id2"></span><h3><a class="reference internal" href="../ref/contrib/gis/index.html#module-django.contrib.gis" title="django.contrib.gis: Geographic Information System (GIS) extensions for Django"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.gis</span></code></a><a class="headerlink" href="#id2" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li>La prise en charge de PostGIS 2.1 a été supprimée.</li>
<li>La prise en charge de SpatiaLite 4.1 et 4.2  a été supprimée.</li>
<li>La prise en charge de GDAL 1.11 et GEOS 3.4 a été supprimée.</li>
</ul>
</div>
<div class="section" id="s-dropped-support-for-postgresql-9-4">
<span id="dropped-support-for-postgresql-9-4"></span><h3>Abandon de la prise en charge de PostgreSQL 9.4<a class="headerlink" href="#dropped-support-for-postgresql-9-4" title="Lien permanent vers ce titre">¶</a></h3>
<p>La prise en charge amont de PostgreSQL 9.4 se termine en décembre 2019. Django 3.0 prend en charge PostgreSQL 9.5 et plus récent.</p>
</div>
<div class="section" id="s-dropped-support-for-oracle-12-1">
<span id="dropped-support-for-oracle-12-1"></span><h3>Abandon de la prise en charge de Oracle 12.1<a class="headerlink" href="#dropped-support-for-oracle-12-1" title="Lien permanent vers ce titre">¶</a></h3>
<p>La prise en charge de Oracle 12.1 par le projet amont se termine en juillet 2021. Django 2.2 sera pris en charge jusqu’en avril 2022. Django 3.0 prend officiellement en charge Oracle 12.2 et 18c.</p>
</div>
<div class="section" id="s-removed-private-python-2-compatibility-apis">
<span id="removed-private-python-2-compatibility-apis"></span><h3>Les API de compatibilité privées de Python 2 ont été supprimées.<a class="headerlink" href="#removed-private-python-2-compatibility-apis" title="Lien permanent vers ce titre">¶</a></h3>
<p>Bien que la prise en charge de Python 2 ait été supprimée dans Django 2.0, certaines API privées n’ont pas été supprimées de Django afin que des applications tierces puissent continuer à les utiliser jusqu’à la fin de vie de Python 2.</p>
<p>Comme nous nous attendons à ce que les applications abandonnent la compatibilité avec Python 2 lors de l’ajout de la prise en charge de Django 3.0, nous supprimons ces API dans cette version.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">django.test.utils.str_prefix()</span></code> - Les chaînes n’ont plus de préfixe « u » avec Python 3.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.test.utils.patch_logger()</span></code> - Utilisez <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertLogs" title="(disponible dans Python v3.9)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unittest.TestCase.assertLogs()</span></code></a> à la place.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.lru_cache.lru_cache()</span></code> - Alias de <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.lru_cache" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.lru_cache()</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.decorators.available_attrs()</span></code> - Cette fonction renvoie <code class="docutils literal notranslate"><span class="pre">functools.WRAPPER_ASSIGNMENTS</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.decorators.ContextDecorator</span></code> - Alias de <a class="reference external" href="https://docs.python.org/3/library/contextlib.html#contextlib.ContextDecorator" title="(disponible dans Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">contextlib.ContextDecorator</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils._os.abspathu()</span></code> - Alias de <a class="reference external" href="https://docs.python.org/3/library/os.path.html#os.path.abspath" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.path.abspath()</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils._os.upath()</span></code> et <code class="docutils literal notranslate"><span class="pre">npath()</span></code> - Ces fonctions ne font plus rien en Python 3.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.six</span></code> - Supprimez l’utilisation de cette bibliothèque embarquée ou passez à <a class="reference external" href="https://pypi.org/project/six/">six</a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.encoding.python_2_unicode_compatible()</span></code> - Alias de <code class="docutils literal notranslate"><span class="pre">six.python_2_unicode_compatible()</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.functional.curry()</span></code> - Utilisez <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.partial" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.partial()</span></code></a> ou <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.partialmethod" title="(disponible dans Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">functools.partialmethod</span></code></a>. Voir <a class="reference external" href="https://github.com/django/django/commit/5b1c389603a353625ae1603">5b1c389603a353625ae1603</a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.safestring.SafeBytes</span></code> - Inutilisée depuis Django 2.0.</li>
</ul>
</div>
<div class="section" id="s-new-default-value-for-the-file-upload-permissions-setting">
<span id="new-default-value-for-the-file-upload-permissions-setting"></span><h3>Nouvelle valeur par défaut du réglage <code class="docutils literal notranslate"><span class="pre">FILE_UPLOAD_PERMISSIONS</span></code><a class="headerlink" href="#new-default-value-for-the-file-upload-permissions-setting" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans les versions précédentes, le réglage <a class="reference internal" href="../ref/settings.html#std:setting-FILE_UPLOAD_PERMISSIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">FILE_UPLOAD_PERMISSIONS</span></code></a> valait <code class="docutils literal notranslate"><span class="pre">None</span></code> par défaut. Avec le gestionnaire par défaut <a class="reference internal" href="../ref/settings.html#std:setting-FILE_UPLOAD_HANDLERS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">FILE_UPLOAD_HANDLERS</span></code></a>, cela pouvait aboutir à des fichiers téléversés ayant des permissions différentes dépendant de leur taille et donc de quel gestionnaire de téléversement était utilisé.</p>
<p><code class="docutils literal notranslate"><span class="pre">FILE_UPLOAD_PERMISSIONS</span></code> now defaults to <code class="docutils literal notranslate"><span class="pre">0o644</span></code> to avoid this
inconsistency.</p>
</div>
<div class="section" id="s-new-default-values-for-security-settings">
<span id="new-default-values-for-security-settings"></span><h3>Nouvelles valeurs par défaut de réglages de sécurité<a class="headerlink" href="#new-default-values-for-security-settings" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour rendre les projets Django plus sûrs par défaut, certains réglages de sécurité ont dorénavant des valeurs par défaut plus sûres :</p>
<ul class="simple">
<li>La nouvelle valeur par défaut de <a class="reference internal" href="../ref/settings.html#std:setting-X_FRAME_OPTIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">X_FRAME_OPTIONS</span></code></a> est <code class="docutils literal notranslate"><span class="pre">'DENY'</span></code>.</li>
<li>La nouvelle valeur par défaut de <a class="reference internal" href="../ref/settings.html#std:setting-SECURE_CONTENT_TYPE_NOSNIFF"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_CONTENT_TYPE_NOSNIFF</span></code></a> est <code class="docutils literal notranslate"><span class="pre">True</span></code>.</li>
</ul>
<p>Consultez la <a class="reference internal" href="#whats-new-security-3-0"><span class="std std-ref">section sécurité</span></a> des nouveautés de Django 3.0 pour plus de détails sur ces changements.</p>
</div>
<div class="section" id="s-miscellaneous">
<span id="miscellaneous"></span><h3>Divers<a class="headerlink" href="#miscellaneous" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ContentType.__str__()</span></code> inclut dorénavant l’étiquette <code class="docutils literal notranslate"><span class="pre">app_label</span></code> de son modèle pour distinguer les modèles ayant le même nom dans des applications différentes.</li>
<li>Comme l’accès à la langue dans la session a été rendu obsolète au profit des cookies, <code class="docutils literal notranslate"><span class="pre">LocaleMiddleware</span></code> ne cherche plus la langue de l’utilisateur dans la session et <a class="reference internal" href="../topics/auth/default.html#django.contrib.auth.logout" title="django.contrib.auth.logout"><code class="xref py py-func docutils literal notranslate"><span class="pre">django.contrib.auth.logout()</span></code></a> ne préserve plus la langue de la session après la déconnexion.</li>
<li><a class="reference internal" href="../ref/utils.html#django.utils.html.escape" title="django.utils.html.escape"><code class="xref py py-func docutils literal notranslate"><span class="pre">django.utils.html.escape()</span></code></a> utilise dorénavant <a class="reference external" href="https://docs.python.org/3/library/html.html#html.escape" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">html.escape()</span></code></a> pour l’échappement du code HTML. Le guillemet simple <code class="docutils literal notranslate"><span class="pre">'</span></code> est dorénavant converti en <code class="docutils literal notranslate"><span class="pre">&amp;#x27;</span></code> au lieu de l’équivalent en format décimal <code class="docutils literal notranslate"><span class="pre">&amp;#39;</span></code>.</li>
<li>L’option <code class="docutils literal notranslate"><span class="pre">django-admin</span> <span class="pre">test</span> <span class="pre">-k</span></code> fonctionne dorénavant comme l’option <a class="reference external" href="https://docs.python.org/3/library/unittest.html#cmdoption-unittest-k" title="(disponible dans Python v3.9)"><code class="xref std std-option docutils literal notranslate"><span class="pre">unittest</span> <span class="pre">-k</span></code></a> plutôt que comme un raccourci de <code class="docutils literal notranslate"><span class="pre">--keepdb</span></code>.</li>
<li>La prise en charge de <code class="docutils literal notranslate"><span class="pre">pywatchman</span></code> &lt; 1.2.0 a été abandonnée.</li>
<li><a class="reference internal" href="../ref/utils.html#django.utils.http.urlencode" title="django.utils.http.urlencode"><code class="xref py py-func docutils literal notranslate"><span class="pre">urlencode()</span></code></a> code dorénavant les valeurs itérables telles qu’elles sont lorsque <code class="docutils literal notranslate"><span class="pre">doseq=False</span></code>, plutôt que de les passer en boucle, ce qui rapproche du comportement de la fonction de bibliothèque standard <a class="reference external" href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlencode" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">urllib.parse.urlencode()</span></code></a>.</li>
<li>Le filtre de gabarit <code class="docutils literal notranslate"><span class="pre">intword</span></code> traduit dorénavant <code class="docutils literal notranslate"><span class="pre">1.0</span></code> avec une phrase au singulier et toutes les autres valeurs numériques comme une phrase au pluriel, ce qui n’est pas toujours correct selon les langues.</li>
<li>L’attribution d’une valeur à un attribut <code class="docutils literal notranslate"><span class="pre">'_id'</span></code> d’un champ <a class="reference internal" href="../ref/models/fields.html#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a> ou <a class="reference internal" href="../ref/models/fields.html#django.db.models.OneToOneField" title="django.db.models.OneToOneField"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneToOneField</span></code></a> efface dorénavant la valeur du champ correspondant. Tout accès postérieur à ce champ aboutira à une nouvelle requête.</li>
<li><a class="reference internal" href="../ref/utils.html#django.utils.cache.patch_vary_headers" title="django.utils.cache.patch_vary_headers"><code class="xref py py-func docutils literal notranslate"><span class="pre">patch_vary_headers()</span></code></a> traite dorénavant l’astérisque <code class="docutils literal notranslate"><span class="pre">'*'</span></code> en accord avec la <span class="target" id="index-2"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7231.html#section-7.1.4"><strong>RFC 7231#section-7.1.4</strong></a>, c’est-à-dire que si une liste de noms de champs d’en-tête contient un astérisque, l’en-tête <code class="docutils literal notranslate"><span class="pre">Vary</span></code> sera formé d’un seul astérisque <code class="docutils literal notranslate"><span class="pre">'*'</span></code>.</li>
<li>Avec MySQL 8.0.16+, <code class="docutils literal notranslate"><span class="pre">PositiveIntegerField</span></code> et <code class="docutils literal notranslate"><span class="pre">PositiveSmallIntegerField</span></code> incluent dorénavant une contrainte de contrôle pour empêcher les valeurs négatives dans la base de données.</li>
<li><code class="docutils literal notranslate"><span class="pre">alias=None</span></code> a été ajouté à la signature de <a class="reference internal" href="../ref/models/expressions.html#django.db.models.Expression.get_group_by_cols" title="django.db.models.Expression.get_group_by_cols"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Expression.get_group_by_cols()</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">RegexPattern</span></code>, used by <a class="reference internal" href="../ref/urls.html#django.urls.re_path" title="django.urls.re_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">re_path()</span></code></a>, no longer returns
keyword arguments with <code class="docutils literal notranslate"><span class="pre">None</span></code> values to be passed to the view for the
optional named groups that are missing.</li>
</ul>
</div>
</div>
<div class="section" id="s-features-deprecated-in-3-0">
<span id="s-deprecated-features-3-0"></span><span id="features-deprecated-in-3-0"></span><span id="deprecated-features-3-0"></span><h2>Fonctionnalités rendues obsolètes dans Django 3.0<a class="headerlink" href="#features-deprecated-in-3-0" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="s-django-utils-encoding-force-text-and-smart-text">
<span id="django-utils-encoding-force-text-and-smart-text"></span><h3><code class="docutils literal notranslate"><span class="pre">django.utils.encoding.force_text()</span></code> et <code class="docutils literal notranslate"><span class="pre">smart_text()</span></code><a class="headerlink" href="#django-utils-encoding-force-text-and-smart-text" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les alias <code class="docutils literal notranslate"><span class="pre">smart_text()</span></code> et <code class="docutils literal notranslate"><span class="pre">force_text()</span></code> (depuis Django 2.0) de <code class="docutils literal notranslate"><span class="pre">smart_str()</span></code> et <code class="docutils literal notranslate"><span class="pre">force_str()</span></code> sont rendus obsolètes. Vous pouvez ignorer l’avertissement si votre code prend en charge Python 2 car le comportement de <code class="docutils literal notranslate"><span class="pre">smart_str()</span></code> et <code class="docutils literal notranslate"><span class="pre">force_str()</span></code> est différent dans ce contexte.</p>
</div>
<div class="section" id="s-id3">
<span id="id3"></span><h3>Divers<a class="headerlink" href="#id3" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">django.utils.http.urlquote()</span></code>, <code class="docutils literal notranslate"><span class="pre">urlquote_plus()</span></code>, <code class="docutils literal notranslate"><span class="pre">urlunquote()</span></code> et <code class="docutils literal notranslate"><span class="pre">urlunquote_plus()</span></code> sont rendus obsolètes en faveur des fonctions pour lesquelles elles sont des alias : <a class="reference external" href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.quote" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">urllib.parse.quote()</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.quote_plus" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">quote_plus()</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.unquote" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">unquote()</span></code></a> et <a class="reference external" href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.unquote_plus" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">unquote_plus()</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.translation.ugettext()</span></code>, <code class="docutils literal notranslate"><span class="pre">ugettext_lazy()</span></code>, <code class="docutils literal notranslate"><span class="pre">ugettext_noop()</span></code>, <code class="docutils literal notranslate"><span class="pre">ungettext()</span></code> et <code class="docutils literal notranslate"><span class="pre">ungettext_lazy()</span></code> sont rendues obsolètes en faveur des fonctions pour lesquelles elles sont des alias : <a class="reference internal" href="../ref/utils.html#django.utils.translation.gettext" title="django.utils.translation.gettext"><code class="xref py py-func docutils literal notranslate"><span class="pre">django.utils.translation.gettext()</span></code></a>, <a class="reference internal" href="../ref/utils.html#django.utils.translation.gettext_lazy" title="django.utils.translation.gettext_lazy"><code class="xref py py-func docutils literal notranslate"><span class="pre">gettext_lazy()</span></code></a>, <a class="reference internal" href="../ref/utils.html#django.utils.translation.gettext_noop" title="django.utils.translation.gettext_noop"><code class="xref py py-func docutils literal notranslate"><span class="pre">gettext_noop()</span></code></a>, <a class="reference internal" href="../ref/utils.html#django.utils.translation.ngettext" title="django.utils.translation.ngettext"><code class="xref py py-func docutils literal notranslate"><span class="pre">ngettext()</span></code></a> et <a class="reference internal" href="../ref/utils.html#django.utils.translation.ngettext_lazy" title="django.utils.translation.ngettext_lazy"><code class="xref py py-func docutils literal notranslate"><span class="pre">ngettext_lazy()</span></code></a>.</li>
<li>Afin de limiter la création de sessions et donc de favorise certaines stratégies de cache, <a class="reference internal" href="../topics/i18n/translation.html#django.views.i18n.set_language" title="django.views.i18n.set_language"><code class="xref py py-func docutils literal notranslate"><span class="pre">django.views.i18n.set_language()</span></code></a> arrêtera de définir la langue de l’utilisateur dans la session à partir de Django 4.0. Dès Django 2.1, la langue est toujours stockée dans le cookie <a class="reference internal" href="../ref/settings.html#std:setting-LANGUAGE_COOKIE_NAME"><code class="xref std std-setting docutils literal notranslate"><span class="pre">LANGUAGE_COOKIE_NAME</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.text.unescape_entities()</span></code> est rendu obsolète en faveur de <a class="reference external" href="https://docs.python.org/3/library/html.html#html.unescape" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">html.unescape()</span></code></a>. Notez qu’au contraire de <code class="docutils literal notranslate"><span class="pre">unescape_entities()</span></code>, <code class="docutils literal notranslate"><span class="pre">html.unescape()</span></code> évalue immédiatement les chaînes différées.</li>
<li>Pour éviter une possible confusion sur sa portée réelle, l’utilitaire interne privé <code class="docutils literal notranslate"><span class="pre">is_safe_url()</span></code> a été renommé en <code class="docutils literal notranslate"><span class="pre">url_has_allowed_host_and_scheme()</span></code>. Le fait que le protocole et l’hôte d’une URL soit autorisés n’implique en général pas qu’elle soit sûre. Elle pourrait par exemple être codée de façon incorrecte. Assurez-vous d’appliquer aussi <a class="reference internal" href="../ref/utils.html#django.utils.encoding.iri_to_uri" title="django.utils.encoding.iri_to_uri"><code class="xref py py-func docutils literal notranslate"><span class="pre">iri_to_uri()</span></code></a> sur la partie chemin des URL de source non fiable.</li>
</ul>
</div>
</div>
<div class="section" id="s-features-removed-in-3-0">
<span id="s-removed-features-3-0"></span><span id="features-removed-in-3-0"></span><span id="removed-features-3-0"></span><h2>Fonctionnalités supprimées dans 3.0<a class="headerlink" href="#features-removed-in-3-0" title="Lien permanent vers ce titre">¶</a></h2>
<p>Ces fonctionnalités ont atteint la fin de leur cycle d’obsolescence et sont supprimées dans Django 3.0.</p>
<p>Voir <a class="reference internal" href="2.0.html#deprecated-features-2-0"><span class="std std-ref">Features deprecated in 2.0</span></a> pour les détails de ces changements, ainsi que pour savoir comment supprimer l’utilisation de ces fonctionnalités.</p>
<ul class="simple">
<li>Le module <code class="docutils literal notranslate"><span class="pre">django.db.backends.postgresql_psycopg2</span></code> a été supprimé.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.shortcuts.render_to_response()</span></code> a été supprimée.</li>
<li>Le réglage <code class="docutils literal notranslate"><span class="pre">DEFAULT_CONTENT_TYPE</span></code> a été supprimé.</li>
<li><code class="docutils literal notranslate"><span class="pre">HttpRequest.xreadlines()</span></code> a été supprimée.</li>
<li>La prise en charge du paramètre <code class="docutils literal notranslate"><span class="pre">context</span></code> de <code class="docutils literal notranslate"><span class="pre">Field.from_db_value()</span></code> et de <code class="docutils literal notranslate"><span class="pre">Expression.convert_value()</span></code> a été supprimée.</li>
<li>Le paramètre nommé <code class="docutils literal notranslate"><span class="pre">field_name</span></code> de <code class="docutils literal notranslate"><span class="pre">QuerySet.earliest()</span></code> et de <code class="docutils literal notranslate"><span class="pre">latest()</span></code> a été supprimé.</li>
</ul>
<p>Voir <a class="reference internal" href="2.1.html#deprecated-features-2-1"><span class="std std-ref">Fonctionnalités rendues obsolètes dans Django 2.1</span></a> pour les détails de ces changements, ainsi que pour savoir comment supprimer l’utilisation de ces fonctionnalités.</p>
<ul class="simple">
<li>La fonction SIG <code class="docutils literal notranslate"><span class="pre">ForceRHR</span></code> a été supprimée.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.utils.http.cookie_date()</span></code> a été supprimée.</li>
<li>Les bibliothèques de balises de gabarits <code class="docutils literal notranslate"><span class="pre">staticfiles</span></code> et <code class="docutils literal notranslate"><span class="pre">admin_static</span></code> ont été supprimées.</li>
<li><code class="docutils literal notranslate"><span class="pre">django.contrib.staticfiles.templatetags.staticfiles.static()</span></code> a été supprimée.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Notes de publication de Django 3.0</a><ul>
<li><a class="reference internal" href="#python-compatibility">Compatibilité Python</a></li>
<li><a class="reference internal" href="#third-party-library-support-for-older-version-of-django">Prise en charge des bibliothèques tierces pour les anciennes versions de Django</a></li>
<li><a class="reference internal" href="#what-s-new-in-django-3-0">Quoi de neuf dans Django 3.0</a><ul>
<li><a class="reference internal" href="#mariadb-support">Prise en charge de MariaDB</a></li>
<li><a class="reference internal" href="#asgi-support">Prise en charge d’ASGI</a></li>
<li><a class="reference internal" href="#exclusion-constraints-on-postgresql">Contraintes d’exclusion avec PostgreSQL</a></li>
<li><a class="reference internal" href="#filter-expressions">Expressions de filtres</a></li>
<li><a class="reference internal" href="#enumerations-for-model-field-choices">Énumérations pour les choix de champs de modèles</a></li>
<li><a class="reference internal" href="#minor-features">Fonctionnalités mineures</a><ul>
<li><a class="reference internal" href="#django-contrib-admin"><code class="docutils literal notranslate"><span class="pre">django.contrib.admin</span></code></a></li>
<li><a class="reference internal" href="#django-contrib-auth"><code class="docutils literal notranslate"><span class="pre">django.contrib.auth</span></code></a></li>
<li><a class="reference internal" href="#django-contrib-gis"><code class="docutils literal notranslate"><span class="pre">django.contrib.gis</span></code></a></li>
<li><a class="reference internal" href="#django-contrib-postgres"><code class="docutils literal notranslate"><span class="pre">django.contrib.postgres</span></code></a></li>
<li><a class="reference internal" href="#django-contrib-sessions"><code class="docutils literal notranslate"><span class="pre">django.contrib.sessions</span></code></a></li>
<li><a class="reference internal" href="#django-contrib-syndication"><code class="docutils literal notranslate"><span class="pre">django.contrib.syndication</span></code></a></li>
<li><a class="reference internal" href="#cache">Cache</a></li>
<li><a class="reference internal" href="#file-storage">Stockage de fichier</a></li>
<li><a class="reference internal" href="#forms">Formulaires</a></li>
<li><a class="reference internal" href="#internationalization">Internationalisation</a></li>
<li><a class="reference internal" href="#logging">Journalisation</a></li>
<li><a class="reference internal" href="#management-commands">Commandes d’administration</a></li>
<li><a class="reference internal" href="#models">Modèles</a></li>
<li><a class="reference internal" href="#requests-and-responses">Requêtes et réponses</a></li>
<li><a class="reference internal" href="#security">Sécurité</a></li>
<li><a class="reference internal" href="#tests">Tests</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#backwards-incompatible-changes-in-3-0">Changements incompatibles avec les anciennes versions dans Django 3.0</a><ul>
<li><a class="reference internal" href="#model-save-when-providing-a-default-for-the-primary-key"><code class="docutils literal notranslate"><span class="pre">Model.save()</span></code> when providing a default for the primary key</a></li>
<li><a class="reference internal" href="#database-backend-api">API de moteur de base de données</a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">django.contrib.admin</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">django.contrib.gis</span></code></a></li>
<li><a class="reference internal" href="#dropped-support-for-postgresql-9-4">Abandon de la prise en charge de PostgreSQL 9.4</a></li>
<li><a class="reference internal" href="#dropped-support-for-oracle-12-1">Abandon de la prise en charge de Oracle 12.1</a></li>
<li><a class="reference internal" href="#removed-private-python-2-compatibility-apis">Les API de compatibilité privées de Python 2 ont été supprimées.</a></li>
<li><a class="reference internal" href="#new-default-value-for-the-file-upload-permissions-setting">Nouvelle valeur par défaut du réglage <code class="docutils literal notranslate"><span class="pre">FILE_UPLOAD_PERMISSIONS</span></code></a></li>
<li><a class="reference internal" href="#new-default-values-for-security-settings">Nouvelles valeurs par défaut de réglages de sécurité</a></li>
<li><a class="reference internal" href="#miscellaneous">Divers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#features-deprecated-in-3-0">Fonctionnalités rendues obsolètes dans Django 3.0</a><ul>
<li><a class="reference internal" href="#django-utils-encoding-force-text-and-smart-text"><code class="docutils literal notranslate"><span class="pre">django.utils.encoding.force_text()</span></code> et <code class="docutils literal notranslate"><span class="pre">smart_text()</span></code></a></li>
<li><a class="reference internal" href="#id3">Divers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#features-removed-in-3-0">Fonctionnalités supprimées dans 3.0</a></li>
</ul>
</li>
</ul>

  <h4>Sujet précédent</h4>
  <p class="topless"><a href="3.0.1.html"
                        title="Chapitre précédent">Notes de publication de Django 3.0.1</a></p>
  <h4>Sujet suivant</h4>
  <p class="topless"><a href="2.2.17.html"
                        title="Chapitre suivant">Django 2.2.17 release notes</a></p>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/releases/3.0.txt"
            rel="nofollow">Montrer le code source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">oct. 29, 2020</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="3.0.1.html" title="Notes de publication de Django 3.0.1">previous</a>
     |
    <a href="index.html" title="Notes de publication" accesskey="U">up</a>
   |
    <a href="2.2.17.html" title="Django 2.2.17 release notes">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>