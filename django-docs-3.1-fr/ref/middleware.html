
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Intergiciels (« middleware ») &#8212; Documentation Django 3.1.3.dev</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Opérations de migration" href="migration-operations.html" />
    <link rel="prev" title="La validation de formulaires et de champs" href="forms/validation.html" />



 
<script src="../templatebuiltins.js"></script>
<script>
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);</script>

  </head><body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../index.html">Documentation Django 3.1.3.dev</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../index.html">Home</a>  |
        <a title="Table of contents" href="../contents.html">Table of contents</a>  |
        <a title="Global index" href="../genindex.html">Index</a>  |
        <a title="Module index" href="../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="forms/validation.html" title="La validation de formulaires et de champs">previous</a>
     |
    <a href="index.html" title="Référence de l’API" accesskey="U">up</a>
   |
    <a href="migration-operations.html" title="Opérations de migration">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="ref-middleware">
            
  <div class="section" id="s-module-django.middleware">
<span id="s-middleware"></span><span id="module-django.middleware"></span><span id="middleware"></span><h1>Intergiciels («&nbsp;middleware&nbsp;»)<a class="headerlink" href="#module-django.middleware" title="Lien permanent vers ce titre">¶</a></h1>
<p>Ce document présente tous les composants intergiciels livrés avec Django. Pour plus d’informations sur la façon de les utiliser et sur la manière d’écrire ses propres intergiciels, consultez le <a class="reference internal" href="../topics/http/middleware.html"><span class="doc">guide d’utilisation des intergiciels</span></a>.</p>
<div class="section" id="s-available-middleware">
<span id="available-middleware"></span><h2>Intergiciels disponibles<a class="headerlink" href="#available-middleware" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="s-module-django.middleware.cache">
<span id="s-cache-middleware"></span><span id="module-django.middleware.cache"></span><span id="cache-middleware"></span><h3>Intergiciel de cache<a class="headerlink" href="#module-django.middleware.cache" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.middleware.cache.UpdateCacheMiddleware">
<em class="property">class </em><code class="descname">UpdateCacheMiddleware</code><a class="headerlink" href="#django.middleware.cache.UpdateCacheMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="django.middleware.cache.FetchFromCacheMiddleware">
<em class="property">class </em><code class="descname">FetchFromCacheMiddleware</code><a class="headerlink" href="#django.middleware.cache.FetchFromCacheMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Active le cache global du site. Quand il est actif, chaque page générée par Django est mise en cache pour une durée équivalente au réglage <a class="reference internal" href="settings.html#std:setting-CACHE_MIDDLEWARE_SECONDS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CACHE_MIDDLEWARE_SECONDS</span></code></a>. Voir la <a class="reference internal" href="../topics/cache.html"><span class="doc">documentation du cache</span></a>.</p>
</div>
<div class="section" id="s-module-django.middleware.common">
<span id="s-common-middleware"></span><span id="module-django.middleware.common"></span><span id="common-middleware"></span><h3>Intergiciel «&nbsp;common&nbsp;»<a class="headerlink" href="#module-django.middleware.common" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.middleware.common.CommonMiddleware">
<em class="property">class </em><code class="descname">CommonMiddleware</code><a class="headerlink" href="#django.middleware.common.CommonMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Ajoute quelques commodités pour les perfectionnistes&nbsp;:</p>
<ul>
<li><p class="first">Interdit l’accès aux agents utilisateurs (navigateurs) mentionnés dans le réglage <a class="reference internal" href="settings.html#std:setting-DISALLOWED_USER_AGENTS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DISALLOWED_USER_AGENTS</span></code></a>, qui devrait contenir une liste d’objets expression régulière compilés.</p>
</li>
<li><p class="first">Effectue une réécriture d’URL sur la base des réglages <a class="reference internal" href="settings.html#std:setting-APPEND_SLASH"><code class="xref std std-setting docutils literal notranslate"><span class="pre">APPEND_SLASH</span></code></a> et <a class="reference internal" href="settings.html#std:setting-PREPEND_WWW"><code class="xref std std-setting docutils literal notranslate"><span class="pre">PREPEND_WWW</span></code></a>.</p>
<p>Si <a class="reference internal" href="settings.html#std:setting-APPEND_SLASH"><code class="xref std std-setting docutils literal notranslate"><span class="pre">APPEND_SLASH</span></code></a> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code> et que l’URL initiale ne se termine pas par une barre oblique et que l’URL n’est pas trouvée dans les configuration d’URL, une nouvelle URL est formée en y ajoutant une barre oblique à la fin. Si la nouvelle URL est trouvée dans la configuration d’URL, Django redirige la requête vers cette URL. Sinon, l’URL de départ est traitée comme d’habitude.</p>
<p>Par exemple, <code class="docutils literal notranslate"><span class="pre">foo.com/bar</span></code> sera redirigée vers <code class="docutils literal notranslate"><span class="pre">foo.com/bar/</span></code> s’il n’existe pas de motif d’URL valide correspondant à <code class="docutils literal notranslate"><span class="pre">foo.com/bar</span></code> mais qu’il <em>existe</em> un motif valide pour <code class="docutils literal notranslate"><span class="pre">foo.com/bar/</span></code>.</p>
<p>Si <a class="reference internal" href="settings.html#std:setting-PREPEND_WWW"><code class="xref std std-setting docutils literal notranslate"><span class="pre">PREPEND_WWW</span></code></a> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>, les URL ne commençant pas par «&nbsp;www.&nbsp;» seront redirigées vers la même URL commençant par «&nbsp;www.&nbsp;».</p>
<p>Ces deux options visent à normaliser les URL. L’idée étant que chaque URL devrait exister sous une et une seule forme. Techniquement, une URL <code class="docutils literal notranslate"><span class="pre">foo.com/bar</span></code> est différente de <code class="docutils literal notranslate"><span class="pre">foo.com/bar/</span></code> – un index de moteur de recherche les traiterait comme des URL distinctes – ce qui justifie la bonne pratique de normaliser les URL.</p>
</li>
<li><p class="first">Définit l’en-tête <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> pour les réponses qui ne sont pas de type flux.</p>
</li>
</ul>
<dl class="attribute">
<dt id="django.middleware.common.CommonMiddleware.response_redirect_class">
<code class="descclassname">CommonMiddleware.</code><code class="descname">response_redirect_class</code><a class="headerlink" href="#django.middleware.common.CommonMiddleware.response_redirect_class" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>La valeur par défaut est <a class="reference internal" href="request-response.html#django.http.HttpResponsePermanentRedirect" title="django.http.HttpResponsePermanentRedirect"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpResponsePermanentRedirect</span></code></a>. Créez une sous-classe de <code class="docutils literal notranslate"><span class="pre">CommonMiddleware</span></code> et surchargez cet attribut pour personnaliser les redirections émises par l’intergiciel.</p>
<dl class="class">
<dt id="django.middleware.common.BrokenLinkEmailsMiddleware">
<em class="property">class </em><code class="descname">BrokenLinkEmailsMiddleware</code><a class="headerlink" href="#django.middleware.common.BrokenLinkEmailsMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<ul class="simple">
<li>Envoie des courriels de notification de lien brisé aux <a class="reference internal" href="settings.html#std:setting-MANAGERS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">MANAGERS</span></code></a> (voir <a class="reference internal" href="../howto/error-reporting.html"><span class="doc">Signalement d’erreurs</span></a>).</li>
</ul>
</div>
<div class="section" id="s-module-django.middleware.gzip">
<span id="s-gzip-middleware"></span><span id="module-django.middleware.gzip"></span><span id="gzip-middleware"></span><h3>Intergiciel GZip<a class="headerlink" href="#module-django.middleware.gzip" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.middleware.gzip.GZipMiddleware">
<em class="property">class </em><code class="descname">GZipMiddleware</code><a class="headerlink" href="#django.middleware.gzip.GZipMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Les chercheurs en sécurité ont récemment découvert que lorsque des techniques de compression (y compris avec <code class="docutils literal notranslate"><span class="pre">GZipMiddleware</span></code>) sont utilisés sur un site Web, le site peut être exposé à un certain nombre d’attaques potentielles. Avant d’utiliser <code class="docutils literal notranslate"><span class="pre">GZipMiddleware</span></code> pour votre site, vous devriez évaluer avec soin si vous êtes une cible possible de ces attaques. Si vous doutez d’une façon ou d’une autre à ce sujet, vous devriez éviter d’utiliser cet intergiciel. Pour plus de détails, consultez le <a class="reference external" href="http://breachattack.com/resources/BREACH%20-%20SSL,%20gone%20in%2030%20seconds.pdf">document présentant la faille (PDF)</a> et <a class="reference external" href="http://breachattack.com">breachattack.com</a>.</p>
</div>
<p>L’intergiciel <code class="docutils literal notranslate"><span class="pre">django.middleware.gzip.GZipMiddleware</span></code> compresse le contenu pour les navigateurs qui prennent en charge la compression GZip (tous les navigateurs modernes).</p>
<p>Cet intergiciel devrait être placé avant tout autre intergiciel qui a besoin de lire ou d’écrire le corps de la réponse afin que la compression puisse avoir lieu après.</p>
<p>Il ne compresse PAS le contenu si l’un des critères suivants est vrai&nbsp;:</p>
<ul class="simple">
<li>La taille du corps du contenu est plus petite que 200 octets.</li>
<li>La réponse a déjà défini l’en-tête <code class="docutils literal notranslate"><span class="pre">Content-Encoding</span></code>.</li>
<li>La requête (le navigateur) n’a pas envoyé d’en-tête <code class="docutils literal notranslate"><span class="pre">Accept-Encoding</span></code> incluant <code class="docutils literal notranslate"><span class="pre">gzip</span></code>.</li>
</ul>
<p>Si la réponse possède un en-tête <code class="docutils literal notranslate"><span class="pre">ETag</span></code>, l’ETag est rendu faible pour se conformer à <span class="target" id="index-2"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc7232.html#section-2.1"><strong>RFC 7232#section-2.1</strong></a>.</p>
<p>Vous pouvez appliquer la compression GZip pour des vues individuelles en utilisant le décorateur <a class="reference internal" href="../topics/http/decorators.html#django.views.decorators.gzip.gzip_page" title="django.views.decorators.gzip.gzip_page"><code class="xref py py-func docutils literal notranslate"><span class="pre">gzip_page()</span></code></a>.</p>
</div>
<div class="section" id="s-module-django.middleware.http">
<span id="s-conditional-get-middleware"></span><span id="module-django.middleware.http"></span><span id="conditional-get-middleware"></span><h3>Intergiciel GET conditionnel<a class="headerlink" href="#module-django.middleware.http" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.middleware.http.ConditionalGetMiddleware">
<em class="property">class </em><code class="descname">ConditionalGetMiddleware</code><a class="headerlink" href="#django.middleware.http.ConditionalGetMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Traite les opérations GET conditionnelles. Si la réponse ne possède pas d’en-tête <code class="docutils literal notranslate"><span class="pre">ETag</span></code>, l’intergiciel en crée un si nécessaire. Si la réponse possède un en-tête <code class="docutils literal notranslate"><span class="pre">ETag</span></code> ou <code class="docutils literal notranslate"><span class="pre">Last-Modified</span></code> et que la requête possède l’en-tête <code class="docutils literal notranslate"><span class="pre">If-None-Match</span></code> ou <code class="docutils literal notranslate"><span class="pre">If-Modified-Since</span></code>, la réponse est remplacée par <a class="reference internal" href="request-response.html#django.http.HttpResponseNotModified" title="django.http.HttpResponseNotModified"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpResponseNotModified</span></code></a>.</p>
</div>
<div class="section" id="s-module-django.middleware.locale">
<span id="s-locale-middleware"></span><span id="module-django.middleware.locale"></span><span id="locale-middleware"></span><h3>Intergiciel de locale<a class="headerlink" href="#module-django.middleware.locale" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.middleware.locale.LocaleMiddleware">
<em class="property">class </em><code class="descname">LocaleMiddleware</code><a class="headerlink" href="#django.middleware.locale.LocaleMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Active le choix de la langue en fonction de données de la requête. Le contenu est alors personnalisé par utilisateur. Voir la <a class="reference internal" href="../topics/i18n/translation.html"><span class="doc">documentation sur l’internationalisation</span></a>.</p>
<dl class="attribute">
<dt id="django.middleware.locale.LocaleMiddleware.response_redirect_class">
<code class="descclassname">LocaleMiddleware.</code><code class="descname">response_redirect_class</code><a class="headerlink" href="#django.middleware.locale.LocaleMiddleware.response_redirect_class" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>La valeur par défaut est <a class="reference internal" href="request-response.html#django.http.HttpResponseRedirect" title="django.http.HttpResponseRedirect"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpResponseRedirect</span></code></a>. Créez une sous-classe de <code class="docutils literal notranslate"><span class="pre">LocaleMiddleware</span></code> et surchargez cet attribut pour personnaliser les redirections émises par l’intergiciel.</p>
</div>
<div class="section" id="s-module-django.contrib.messages.middleware">
<span id="s-message-middleware"></span><span id="module-django.contrib.messages.middleware"></span><span id="message-middleware"></span><h3>Intergiciel de messages<a class="headerlink" href="#module-django.contrib.messages.middleware" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.contrib.messages.middleware.MessageMiddleware">
<em class="property">class </em><code class="descname">MessageMiddleware</code><a class="headerlink" href="#django.contrib.messages.middleware.MessageMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Active la prise en charge des messages par session ou par cookie. Voir la <a class="reference internal" href="contrib/messages.html"><span class="doc">documentation sur les messages</span></a>.</p>
</div>
<div class="section" id="s-module-django.middleware.security">
<span id="s-id1"></span><span id="s-security-middleware"></span><span id="module-django.middleware.security"></span><span id="id1"></span><span id="security-middleware"></span><h3>Intergiciel de sécurité<a class="headerlink" href="#module-django.middleware.security" title="Lien permanent vers ce titre">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Si votre situation de déploiement le permet, il est généralement préférable de déléguer au serveur Web frontal la fonctionnalité fournie par l’intergiciel <code class="docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code>. De cette façon, si certaines requêtes ne sont pas fournies par Django (comme des fichiers statiques ou des fichiers envoyés par les utilisateurs), elles bénéficieront de la même protection que les requêtes servies par l’application Django.</p>
</div>
<dl class="class">
<dt id="django.middleware.security.SecurityMiddleware">
<em class="property">class </em><code class="descname">SecurityMiddleware</code><a class="headerlink" href="#django.middleware.security.SecurityMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>L’intergiciel <code class="docutils literal notranslate"><span class="pre">django.middleware.security.SecurityMiddleware</span></code> fournit plusieurs améliorations de sécurité au cycle de requête/réponse. Chaque amélioration peut être activée ou désactivée indépendamment par un réglage.</p>
<ul class="simple">
<li><a class="reference internal" href="settings.html#std:setting-SECURE_BROWSER_XSS_FILTER"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_BROWSER_XSS_FILTER</span></code></a></li>
<li><a class="reference internal" href="settings.html#std:setting-SECURE_CONTENT_TYPE_NOSNIFF"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_CONTENT_TYPE_NOSNIFF</span></code></a></li>
<li><a class="reference internal" href="settings.html#std:setting-SECURE_HSTS_INCLUDE_SUBDOMAINS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_HSTS_INCLUDE_SUBDOMAINS</span></code></a></li>
<li><a class="reference internal" href="settings.html#std:setting-SECURE_HSTS_PRELOAD"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_HSTS_PRELOAD</span></code></a></li>
<li><a class="reference internal" href="settings.html#std:setting-SECURE_HSTS_SECONDS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_HSTS_SECONDS</span></code></a></li>
<li><a class="reference internal" href="settings.html#std:setting-SECURE_REDIRECT_EXEMPT"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_REDIRECT_EXEMPT</span></code></a></li>
<li><a class="reference internal" href="settings.html#std:setting-SECURE_REFERRER_POLICY"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_REFERRER_POLICY</span></code></a></li>
<li><a class="reference internal" href="settings.html#std:setting-SECURE_SSL_HOST"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_SSL_HOST</span></code></a></li>
<li><a class="reference internal" href="settings.html#std:setting-SECURE_SSL_REDIRECT"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_SSL_REDIRECT</span></code></a></li>
</ul>
<div class="section" id="s-http-strict-transport-security">
<span id="s-id2"></span><span id="http-strict-transport-security"></span><span id="id2"></span><h4>Sécurité de transport HTTP stricte (HSTS)<a class="headerlink" href="#http-strict-transport-security" title="Lien permanent vers ce titre">¶</a></h4>
<p>Pour les sites qui ne devraient pouvoir être accédés que par HTTPS, vous pouvez demander aux navigateurs modernes de refuser les connexions à votre nom de domaine si la connexion n’est pas sécurisée (pour une certaine période de temps) en définissant l”<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">en-tête «&nbsp;Strict-Transport-Security&nbsp;»</a>. Cela réduit l’exposition à certaines attaques de type «&nbsp;homme du milieu&nbsp;» (MITM) par détournement SSL.</p>
<p><code class="docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code> définit cet en-tête pour vous sur toutes les réponses HTTPS si vous définissez le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_HSTS_SECONDS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_HSTS_SECONDS</span></code></a> à une valeur entière différente de zéro.</p>
<p>Lors de l’activation de HSTS, il est recommandé d’utiliser d’abord une faible valeur pour tester, par exemple <a class="reference internal" href="settings.html#std:setting-SECURE_HSTS_SECONDS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_HSTS_SECONDS</span> <span class="pre">=</span> <span class="pre">3600</span></code></a> pour une heure. Chaque fois qu’un navigateur Web lit l’en-tête HSTS pour votre site, il refusera de communiquer de manière non sécurisée (par HTTP) avec votre domaine pour la durée de temps indiquée. Après avoir obtenu confirmation que toutes les ressources de votre site sont servies de manière sécurisée (c’est-à-dire que HSTS ne casse rien du tout), il est alors possible et souhaité d’augmenter cette valeur afin que les visiteurs occasionnels soient protégés (il est fréquent de voir 31536000 secondes, c’est-à-dire 1 an).</p>
<p>De plus, si vous définissez le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_HSTS_INCLUDE_SUBDOMAINS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_HSTS_INCLUDE_SUBDOMAINS</span></code></a> à <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code> ajoute la directive <code class="docutils literal notranslate"><span class="pre">includeSubDomains</span></code> à l’en-tête <code class="docutils literal notranslate"><span class="pre">Strict-Transport-Security</span></code>. C’est recommandé (pour autant que tous les sous-domaines soient servis exclusivement par HTTPS), sinon votre site pourrait rester vulnérable au travers d’une connexion non sécurisée à un sous-domaine.</p>
<p>Si vous souhaitez soumettre votre site à la <a class="reference external" href="https://hstspreload.org/">liste de préchargement du navigateur</a>, définissez le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_HSTS_PRELOAD"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_HSTS_PRELOAD</span></code></a> à <code class="docutils literal notranslate"><span class="pre">True</span></code>. Cela ajoute la directive <code class="docutils literal notranslate"><span class="pre">preload</span></code> à l’en-tête <code class="docutils literal notranslate"><span class="pre">Strict-Transport-Security</span></code>.</p>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p>La politique HSTS s’applique à un domaine entier, pas seulement pour l’URL de la réponse pour laquelle vous définissez cet en-tête. Il ne faut donc l’utiliser que si tout le domaine est servi exclusivement par HTTPS.</p>
<p class="last">Les navigateurs respectant scrupuleusement l’en-tête HSTS refuseront aux utilisateurs de passer outre les avertissements et de se connecter à un site avec un certificat SSL expiré, auto-signé ou non valide pour toute autre raison. Si vous utilisez HSTS, assurez-vous que vos certificats sont en bon état et qu’ils le restent&nbsp;!</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Si votre déploiement se trouve derrière un répartiteur de charge ou un serveur mandataire inverse, et que l’en-tête <code class="docutils literal notranslate"><span class="pre">Strict-Transport-Security</span></code> n’est pas ajouté à vos réponses, il est possible que Django ne détecte pas qu’il fonctionne sur une connexion sécurisée&nbsp;; il faut alors définir le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_PROXY_SSL_HEADER"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_PROXY_SSL_HEADER</span></code></a>.</p>
</div>
</div>
<div class="section" id="s-referrer-policy">
<span id="s-id4"></span><span id="referrer-policy"></span><span id="id4"></span><h4>Politique de référencement<a class="headerlink" href="#referrer-policy" title="Lien permanent vers ce titre">¶</a></h4>
<div class="versionadded">
<span class="title">New in Django 3.0.</span> </div>
<p>Les navigateurs utilisent <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer">l’en-tête Referer</a> comme manière d’envoyer aux sites l’information sur la provenance des utilisateurs. Lorsqu’on clique sur un lien, le navigateur envoie l’URL complète de la page contenant le lien en tant que référent. Bien que cela puisse être utile dans certains cas, comme pour savoir qui place des liens vers votre site, cela pose des problèmes de confidentialité en informant un site que l’utilisateur vient de visiter un autre site.</p>
<p>Certains navigateurs ont la capacité d’accepter des indices pour savoir s’ils doivent inclure ou non l’en-tête HTTP <code class="docutils literal notranslate"><span class="pre">Referer</span></code> lorsque quelqu’un clique sur un lien ; cette astuce est transmise par <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy">l’en-tête Referrer-Policy</a>. Cet en-tête peut suggérer trois différents comportements aux navigateurs :</p>
<ul class="simple">
<li>URL complète : envoi de l’URL complète dans l’en-tête <code class="docutils literal notranslate"><span class="pre">Referer</span></code>. Par exemple, si quelqu’un visite <code class="docutils literal notranslate"><span class="pre">https://example.com/page.html</span></code>, l’en-tête <code class="docutils literal notranslate"><span class="pre">Referer</span></code> contiendra <code class="docutils literal notranslate"><span class="pre">&quot;https://example.com/page.html&quot;</span></code>.</li>
<li>Origine uniquement : envoi uniquement de l’origine dans le référent. L’origine est composée du protocole, de l’hôte et du numéro de port (facultatif). Par exemple, si quelqu’un visite <code class="docutils literal notranslate"><span class="pre">https://example.com/page.html</span></code>, l’origine sera <code class="docutils literal notranslate"><span class="pre">https://example.com/</span></code>.</li>
<li>Aucun référent : l’en-tête <code class="docutils literal notranslate"><span class="pre">Referer</span></code> ne sera pas envoyée du tout.</li>
</ul>
<p>Il y a deux types de conditions que cet en-tête peut signaler au navigateur :</p>
<ul class="simple">
<li>Same-origin versus cross-origin : un lien de <code class="docutils literal notranslate"><span class="pre">https://example.com/1.html</span></code> vers <code class="docutils literal notranslate"><span class="pre">https://example.com/2.html</span></code> est de même origine (same-origin). Une lien de <code class="docutils literal notranslate"><span class="pre">https://example.com/page.html</span></code> vers <code class="docutils literal notranslate"><span class="pre">https://not.example.com/page.html</span></code> est d’origine croisée (cross-origin).</li>
<li>Rétrogradation (downgrade) de protocole : une rétrogradation survient si la page contenant le lien est servie en HTTPS mais que la page de destination n’est pas servie en HTTPS.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Quand votre site est servi par HTTPS, <a class="reference internal" href="csrf.html#using-csrf"><span class="std std-ref">la protection CSRF de Django</span></a> exige la présence de l’en-tête <code class="docutils literal notranslate"><span class="pre">Referer</span></code>, ce qui fait qu’une désactivation complète de l’en-tête va empêcher la protection CSRF. Pour obtenir la plupart des bénéfices de la désactivation des en-têtes <code class="docutils literal notranslate"><span class="pre">Referer</span></code> tout en conservant la protection CSRF, nous conseillons de n’activer que les référents de même origine.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code> peut définir l’en-tête <code class="docutils literal notranslate"><span class="pre">Referrer-Policy</span></code> pour vous, sur la base du réglage <a class="reference internal" href="settings.html#std:setting-SECURE_REFERRER_POLICY"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_REFERRER_POLICY</span></code></a> (notez l’orthographe : les navigateurs envoient un en-tête <code class="docutils literal notranslate"><span class="pre">Referer</span></code> quand on clique sur un lien, mais l’en-tête indiquant au navigateur de le faire est orthographié <code class="docutils literal notranslate"><span class="pre">Referrer-Policy</span></code>). Les valeurs valables pour ce réglage sont :</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">no-referrer</span></code></dt>
<dd>Indique au navigateur de ne pas envoyer de référent pour les liens sur lesquels on clique sur ce site.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">no-referrer-when-downgrade</span></code></dt>
<dd>Indique au navigateur d’envoyer une URL complète comme référent, mais seulement si aucune rétrogradation de protocole n’a lieu.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">origin</span></code></dt>
<dd>Indique au navigateur de n’envoyer que l’origine comme référent, pas l’URL complète.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">origin-when-cross-origin</span></code></dt>
<dd>Indique au navigateur d’envoyer une URL complète comme référent pour les liens de même origine, mais seulement l’origine pour les liens d’origine croisée.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">same-origin</span></code></dt>
<dd>Indique au navigateur d’envoyer une URL complète, mais seulement pour les liens de même origine. Aucun référent n’est envoyé pour les liens d’origine croisée.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">strict-origin</span></code></dt>
<dd>Indique au navigateur de n’envoyer que l’origine comme référent, pas l’URL complète, et de ne pas envoyer de référent lorsqu’une rétrogradation de protocole survient.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">strict-origin-when-cross-origin</span></code></dt>
<dd>Indique au navigateur d’envoyer l’URL complète lorsque le lien est de même origine et qu’aucune rétrogradation de protocole ne survient ; envoyer uniquement l’origine lorsque le lien est d’origine croisée et ne rien envoyer du tout si une rétrogradation de protocole survient.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsafe-url</span></code></dt>
<dd>Indique au navigateur de toujours envoyer une URL complète comme référent.</dd>
</dl>
<div class="admonition-unknown-policy-values admonition">
<p class="first admonition-title">Valeurs de politique inconnues</p>
<p class="last">Il est possible que certaines valeurs de politique soient <a class="reference external" href="https://w3c.github.io/webappsec-referrer-policy/#unknown-policy-values">inconnues</a> pour un agent utilisateur. Il est de ce fait autorisé d’indiquer plusieurs valeurs de politique pour fournir une valeur de repli. La priorité est donnée à la dernière valeur fournie qui est comprise. Pour prendre cela en charge, un objet itérable ou une chaîne séparée par des virgules peut être utilisée dans <a class="reference internal" href="settings.html#std:setting-SECURE_REFERRER_POLICY"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_REFERRER_POLICY</span></code></a>.</p>
</div>
</div>
<div class="section" id="s-x-content-type-options-nosniff">
<span id="s-x-content-type-options"></span><span id="x-content-type-options-nosniff"></span><span id="x-content-type-options"></span><h4><code class="docutils literal notranslate"><span class="pre">X-Content-Type-Options:</span> <span class="pre">nosniff</span></code><a class="headerlink" href="#x-content-type-options-nosniff" title="Lien permanent vers ce titre">¶</a></h4>
<p>Certains navigateurs essaient de deviner les types de contenu des ressources qu’ils appellent, sans tenir compte de l’en-tête <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code>. Bien que cela puisse aider à afficher des sites dont les serveurs sont mal configurés, cela peut aussi poser un risque de sécurité.</p>
<p>Si votre site sert des fichiers que des utilisateurs ont envoyés, un utilisateur mal intentionné pourrait envoyer un fichier spécialement écrit pour qu’il soit interprété comme du HTML ou du JavaScript par le navigateur alors que vous vous attendiez à ce que son contenu soit inoffensif.</p>
<p>Pour empêcher le navigateur de deviner le type de contenu et le forcer à toujours utiliser le type indiqué dans l’en-tête <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code>, vous pouvez définir l’en-tête <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options">X-Content-Type-Options: nosniff</a>. <code class="docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code> s’en charge pour toutes les réponses si le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_CONTENT_TYPE_NOSNIFF"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_CONTENT_TYPE_NOSNIFF</span></code></a> est défini à <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Notez que dans la plupart des situations de déploiement où Django n’est pas impliqué dans le service de fichiers envoyés par les utilisateurs, ce réglage ne va pas aider. Par exemple, si le contenu de <a class="reference internal" href="settings.html#std:setting-MEDIA_URL"><code class="xref std std-setting docutils literal notranslate"><span class="pre">MEDIA_URL</span></code></a> est directement servi par le serveur Web frontal (nginx, Apache, etc.), c’est par ce dernier que l’en-tête doit être défini. D’un autre côté, si vous utilisez Django pour s’occuper de choses comme exiger une autorisation avant de pouvoir télécharger des fichiers et que vous n’êtes pas en mesure de faire définir cet en-tête par le serveur Web, ce réglage sera utile.</p>
</div>
<div class="section" id="s-x-xss-protection-1-mode-block">
<span id="s-x-xss-protection"></span><span id="x-xss-protection-1-mode-block"></span><span id="x-xss-protection"></span><h4><code class="docutils literal notranslate"><span class="pre">X-XSS-Protection:</span> <span class="pre">1;</span> <span class="pre">mode=block</span></code><a class="headerlink" href="#x-xss-protection-1-mode-block" title="Lien permanent vers ce titre">¶</a></h4>
<p>Certains navigateurs ont la capacité de bloquer du contenu qui ressemble à une <a class="reference external" href="https://en.wikipedia.org/wiki/Cross-site_scripting">attaque XSS</a>. Ils le font en examinant le contenu JavaScript dans les paramètres GET ou POST des pages. Si le JavaScript est rejoué dans la réponse du serveur, l’affichage de la page est bloqué et une page d’erreur s’affiche à la place.</p>
<p>L”<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection">en-tête X-XSS-Protection</a> est utilisé pour contrôler l’opération du filtre XSS.</p>
<p>Pour activer le filtre XSS dans le navigateur et le forcer à toujours bloquer les suspicions d’attaque XSS, vous pouvez définir l’en-tête <code class="docutils literal notranslate"><span class="pre">X-XSS-Protection:</span> <span class="pre">1;</span> <span class="pre">mode=block</span></code>. <code class="docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code> s’en charge pour toutes les réponses si le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_BROWSER_XSS_FILTER"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_BROWSER_XSS_FILTER</span></code></a> est défini à <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Le filtre XSS du navigateur est une mesure de défense utile, mais on ne peut pas s’y fier de manière exclusive. Il ne peut pas détecter toutes les attaques XSS et ce n’est pas pris en charge avec tous les navigateurs. Prenez soin de toujours <a class="reference internal" href="../topics/security.html#cross-site-scripting"><span class="std std-ref">valider et nettoyer</span></a> toutes les valeurs entrées pour éviter les attaques XSS.</p>
</div>
</div>
<div class="section" id="s-ssl-redirect">
<span id="s-id10"></span><span id="ssl-redirect"></span><span id="id10"></span><h4>Redirection SSL<a class="headerlink" href="#ssl-redirect" title="Lien permanent vers ce titre">¶</a></h4>
<p>Si votre site offre à la fois des connexions HTTP et HTTPS, la plupart des utilisateurs obtiendront une connexion non sécurisée par défaut. Pour une meilleure sécurité, vous devriez rediriger toutes les connexions HTTP vers HTTPS.</p>
<p>Si vous définissez le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_SSL_REDIRECT"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_SSL_REDIRECT</span></code></a> à <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code> va rediriger de manière permanente (HTTP 301) toutes les connexions HTTP vers HTTPS.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pour des raisons de performance, il est préférable de procéder à ces redirections en dehors de Django, dans une répartiteur de charge frontal ou un serveur mandataire inverse tel que <a class="reference external" href="https://nginx.org">nginx</a>. <a class="reference internal" href="settings.html#std:setting-SECURE_SSL_REDIRECT"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_SSL_REDIRECT</span></code></a> est prévu pour des situations de déploiement où ce scénario n’est pas envisageable.</p>
</div>
<p>Si le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_SSL_HOST"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_SSL_HOST</span></code></a> possède une valeur, toutes les redirections seront envoyées vers cet hôte au lieu de l’hôte d’origine de la requête.</p>
<p>Si certaines pages de votre site doivent rester disponibles par HTTP sans être redirigées vers HTTPS, vous pouvez ajouter des expressions régulières correspondantes à ces URL dans le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_REDIRECT_EXEMPT"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_REDIRECT_EXEMPT</span></code></a> (sous forme de liste).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Si votre déploiement se trouve derrière un répartiteur de charge ou un serveur mandataire inverse, et que Django ne semble pas pouvoir détecter si une requête est déjà sécurisée ou non, il peut alors être nécessaire de définir le réglage <a class="reference internal" href="settings.html#std:setting-SECURE_PROXY_SSL_HEADER"><code class="xref std std-setting docutils literal notranslate"><span class="pre">SECURE_PROXY_SSL_HEADER</span></code></a>.</p>
</div>
</div>
</div>
<div class="section" id="s-module-django.contrib.sessions.middleware">
<span id="s-session-middleware"></span><span id="module-django.contrib.sessions.middleware"></span><span id="session-middleware"></span><h3>Intergiciel de session<a class="headerlink" href="#module-django.contrib.sessions.middleware" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.contrib.sessions.middleware.SessionMiddleware">
<em class="property">class </em><code class="descname">SessionMiddleware</code><a class="headerlink" href="#django.contrib.sessions.middleware.SessionMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Active la prise en charge des sessions. Voir la <a class="reference internal" href="../topics/http/sessions.html"><span class="doc">documentation sur les sessions</span></a>.</p>
</div>
<div class="section" id="s-module-django.contrib.sites.middleware">
<span id="s-site-middleware"></span><span id="module-django.contrib.sites.middleware"></span><span id="site-middleware"></span><h3>Intergiciel de site<a class="headerlink" href="#module-django.contrib.sites.middleware" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.contrib.sites.middleware.CurrentSiteMiddleware">
<em class="property">class </em><code class="descname">CurrentSiteMiddleware</code><a class="headerlink" href="#django.contrib.sites.middleware.CurrentSiteMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Ajoute l’attribut <code class="docutils literal notranslate"><span class="pre">site</span></code> représentant le site en cours à chaque objet <code class="docutils literal notranslate"><span class="pre">HttpRequest</span></code> entrant. Voir la <a class="reference internal" href="contrib/sites.html#site-middleware"><span class="std std-ref">documentation sur les sites</span></a>.</p>
</div>
<div class="section" id="s-module-django.contrib.auth.middleware">
<span id="s-authentication-middleware"></span><span id="module-django.contrib.auth.middleware"></span><span id="authentication-middleware"></span><h3>Intergiciel d’authentification<a class="headerlink" href="#module-django.contrib.auth.middleware" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.contrib.auth.middleware.AuthenticationMiddleware">
<em class="property">class </em><code class="descname">AuthenticationMiddleware</code><a class="headerlink" href="#django.contrib.auth.middleware.AuthenticationMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Ajoute l’attribut <code class="docutils literal notranslate"><span class="pre">user</span></code> représentant l’utilisateur actuellement connecté à chaque objet <code class="docutils literal notranslate"><span class="pre">HttpRequest</span></code> entrant. Voir <a class="reference internal" href="../topics/auth/default.html#auth-web-requests"><span class="std std-ref">Authentification dans les requêtes Web</span></a>.</p>
<dl class="class">
<dt id="django.contrib.auth.middleware.RemoteUserMiddleware">
<em class="property">class </em><code class="descname">RemoteUserMiddleware</code><a class="headerlink" href="#django.contrib.auth.middleware.RemoteUserMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Intergiciel permettant d’exploiter l’authentification fournie par le serveur Web. Voir <a class="reference internal" href="../howto/auth-remote-user.html"><span class="doc">Authentification avec REMOTE_USER</span></a> pour les détails d’utilisation.</p>
<dl class="class">
<dt id="django.contrib.auth.middleware.PersistentRemoteUserMiddleware">
<em class="property">class </em><code class="descname">PersistentRemoteUserMiddleware</code><a class="headerlink" href="#django.contrib.auth.middleware.PersistentRemoteUserMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Intergiciel permettant d’exploiter l’authentification fournie par le serveur Web lorsqu’elle n’est activée que sur la page de connexion. Voir <a class="reference internal" href="../howto/auth-remote-user.html#persistent-remote-user-middleware-howto"><span class="std std-ref">Utilisation de REMOTE_USER uniquement pour les pages de connexion</span></a> pour les détails d’utilisation.</p>
</div>
<div class="section" id="s-csrf-protection-middleware">
<span id="csrf-protection-middleware"></span><h3>Intergiciel de protection CSRF<a class="headerlink" href="#csrf-protection-middleware" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.middleware.csrf.CsrfViewMiddleware">
<em class="property">class </em><code class="descname">CsrfViewMiddleware</code><a class="headerlink" href="#django.middleware.csrf.CsrfViewMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Ajoute la protection contre les attaques Cross Site Request Forgeries en ajoutant des champs de formulaires masqués aux formulaires POST et en contrôlant que les requêtes contiennent la valeur correcte. Voir la <a class="reference internal" href="csrf.html"><span class="doc">documentation concernant la protection contre les attaques Cross Site Request Forgery</span></a>.</p>
</div>
<div class="section" id="s-x-frame-options-middleware">
<span id="x-frame-options-middleware"></span><h3>Intergiciel <code class="docutils literal notranslate"><span class="pre">X-Frame-Options</span></code><a class="headerlink" href="#x-frame-options-middleware" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.middleware.clickjacking.XFrameOptionsMiddleware">
<em class="property">class </em><code class="descname">XFrameOptionsMiddleware</code><a class="headerlink" href="#django.middleware.clickjacking.XFrameOptionsMiddleware" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Protection simple contre les <a class="reference internal" href="clickjacking.html"><span class="doc">attaques par détournement de clic au moyen de l’en-tête X-Frame-Options</span></a>.</p>
</div>
</div>
<div class="section" id="s-middleware-ordering">
<span id="s-id11"></span><span id="middleware-ordering"></span><span id="id11"></span><h2>Ordre des intergiciels<a class="headerlink" href="#middleware-ordering" title="Lien permanent vers ce titre">¶</a></h2>
<p>Voici quelques indications au sujet de l’ordre des diverses classes d’intergiciel Django&nbsp;:</p>
<ol class="arabic">
<li><p class="first"><a class="reference internal" href="#django.middleware.security.SecurityMiddleware" title="django.middleware.security.SecurityMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">SecurityMiddleware</span></code></a></p>
<p>Il devrait se trouver assez haut dans la liste si vous prévoyez d’activer la redirection SSL car cela évite de passer par plusieurs autres intergiciels inutiles.</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.middleware.cache.UpdateCacheMiddleware" title="django.middleware.cache.UpdateCacheMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdateCacheMiddleware</span></code></a></p>
<p>Avant ceux qui modifient l’en-tête <code class="docutils literal notranslate"><span class="pre">Vary</span></code> (<code class="docutils literal notranslate"><span class="pre">SessionMiddleware</span></code>, <code class="docutils literal notranslate"><span class="pre">GZipMiddleware</span></code>, <code class="docutils literal notranslate"><span class="pre">LocaleMiddleware</span></code>).</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.middleware.gzip.GZipMiddleware" title="django.middleware.gzip.GZipMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">GZipMiddleware</span></code></a></p>
<p>Avant tout intergiciel susceptible de modifier ou d’utiliser le corps de la réponse.</p>
<p>Après <code class="docutils literal notranslate"><span class="pre">UpdateCacheMiddleware</span></code>: modifie l’en-tête <code class="docutils literal notranslate"><span class="pre">Vary</span></code>.</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.contrib.sessions.middleware.SessionMiddleware" title="django.contrib.sessions.middleware.SessionMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionMiddleware</span></code></a></p>
<p>Avant tout intergiciel pouvant générer une exception déclenchant une vue d’erreur (comme par exemple <a class="reference internal" href="exceptions.html#django.core.exceptions.PermissionDenied" title="django.core.exceptions.PermissionDenied"><code class="xref py py-exc docutils literal notranslate"><span class="pre">PermissionDenied</span></code></a>) dans le cas où vous utilisez <a class="reference internal" href="settings.html#std:setting-CSRF_USE_SESSIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CSRF_USE_SESSIONS</span></code></a>.</p>
<p>Après <code class="docutils literal notranslate"><span class="pre">UpdateCacheMiddleware</span></code>: modifie l’en-tête <code class="docutils literal notranslate"><span class="pre">Vary</span></code>.</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.middleware.http.ConditionalGetMiddleware" title="django.middleware.http.ConditionalGetMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalGetMiddleware</span></code></a></p>
<p>Avant tout intergiciel pouvant modifier la réponse (définit l’en-tête <code class="docutils literal notranslate"><span class="pre">ETag</span></code>).</p>
<p>Après <code class="docutils literal notranslate"><span class="pre">GZipMiddleware</span></code> afin qu’il ne calcule pas d’en-tête <code class="docutils literal notranslate"><span class="pre">ETag</span></code> pour du contenu compressé gzip.</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.middleware.locale.LocaleMiddleware" title="django.middleware.locale.LocaleMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocaleMiddleware</span></code></a></p>
<p>Doit être dans les premiers, après  <code class="docutils literal notranslate"><span class="pre">SessionMiddleware</span></code> (utilise les données de sessions) et <code class="docutils literal notranslate"><span class="pre">UpdateCacheMiddleware</span></code> (modifie l’en-tête <code class="docutils literal notranslate"><span class="pre">Vary</span></code>).</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.middleware.common.CommonMiddleware" title="django.middleware.common.CommonMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">CommonMiddleware</span></code></a></p>
<p>Avant tout intergiciel qui pourrait modifier la réponse (il définit l’en-tête <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code>). Un intergiciel apparaissant avant <code class="docutils literal notranslate"><span class="pre">CommonMiddleware</span></code> et modifiant la réponse doit réinitialiser <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code>.</p>
<p>Dans les tout premiers&nbsp;: il redirige lorsque <a class="reference internal" href="settings.html#std:setting-APPEND_SLASH"><code class="xref std std-setting docutils literal notranslate"><span class="pre">APPEND_SLASH</span></code></a> ou <a class="reference internal" href="settings.html#std:setting-PREPEND_WWW"><code class="xref std std-setting docutils literal notranslate"><span class="pre">PREPEND_WWW</span></code></a> valent <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Après <code class="docutils literal notranslate"><span class="pre">SessionMiddleware</span></code> si vous utilisez <a class="reference internal" href="settings.html#std:setting-CSRF_USE_SESSIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CSRF_USE_SESSIONS</span></code></a>.</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.middleware.csrf.CsrfViewMiddleware" title="django.middleware.csrf.CsrfViewMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">CsrfViewMiddleware</span></code></a></p>
<p>Avant tout intergiciel comptant sur le fait que des attaques CSRF ont déjà été contrées.</p>
<p>Avant <a class="reference internal" href="#django.contrib.auth.middleware.RemoteUserMiddleware" title="django.contrib.auth.middleware.RemoteUserMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">RemoteUserMiddleware</span></code></a> ou tout autre intergiciel d’authentification qui pourrait effectuer une connexion et ainsi activer la rotation du jeton CSRF, avant d’appeler la suite de la chaîne d’intergiciels.</p>
<p>Après <code class="docutils literal notranslate"><span class="pre">SessionMiddleware</span></code> si vous utilisez <a class="reference internal" href="settings.html#std:setting-CSRF_USE_SESSIONS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">CSRF_USE_SESSIONS</span></code></a>.</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.contrib.auth.middleware.AuthenticationMiddleware" title="django.contrib.auth.middleware.AuthenticationMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuthenticationMiddleware</span></code></a></p>
<p>Après <code class="docutils literal notranslate"><span class="pre">SessionMiddleware</span></code>: utilise le stockage des sessions.</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.contrib.messages.middleware.MessageMiddleware" title="django.contrib.messages.middleware.MessageMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">MessageMiddleware</span></code></a></p>
<p>Après <code class="docutils literal notranslate"><span class="pre">SessionMiddleware</span></code>: peut utiliser le stockage basé sur les sessions.</p>
</li>
<li><p class="first"><a class="reference internal" href="#django.middleware.cache.FetchFromCacheMiddleware" title="django.middleware.cache.FetchFromCacheMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">FetchFromCacheMiddleware</span></code></a></p>
<p>Après tout intergiciel qui modifie l’en-tête <code class="docutils literal notranslate"><span class="pre">Vary</span></code>: cet en-tête est utilisé pour choisir une valeur pour la clé de hachage du cache.</p>
</li>
<li><p class="first"><a class="reference internal" href="contrib/flatpages.html#django.contrib.flatpages.middleware.FlatpageFallbackMiddleware" title="django.contrib.flatpages.middleware.FlatpageFallbackMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlatpageFallbackMiddleware</span></code></a></p>
<p>Devrait se situer dans les derniers car c’est un type d’intergiciel de dernier recours.</p>
</li>
<li><p class="first"><a class="reference internal" href="contrib/redirects.html#django.contrib.redirects.middleware.RedirectFallbackMiddleware" title="django.contrib.redirects.middleware.RedirectFallbackMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedirectFallbackMiddleware</span></code></a></p>
<p>Devrait se situer dans les derniers car c’est un type d’intergiciel de dernier recours.</p>
</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Intergiciels («&nbsp;middleware&nbsp;»)</a><ul>
<li><a class="reference internal" href="#available-middleware">Intergiciels disponibles</a><ul>
<li><a class="reference internal" href="#module-django.middleware.cache">Intergiciel de cache</a></li>
<li><a class="reference internal" href="#module-django.middleware.common">Intergiciel «&nbsp;common&nbsp;»</a></li>
<li><a class="reference internal" href="#module-django.middleware.gzip">Intergiciel GZip</a></li>
<li><a class="reference internal" href="#module-django.middleware.http">Intergiciel GET conditionnel</a></li>
<li><a class="reference internal" href="#module-django.middleware.locale">Intergiciel de locale</a></li>
<li><a class="reference internal" href="#module-django.contrib.messages.middleware">Intergiciel de messages</a></li>
<li><a class="reference internal" href="#module-django.middleware.security">Intergiciel de sécurité</a><ul>
<li><a class="reference internal" href="#http-strict-transport-security">Sécurité de transport HTTP stricte (HSTS)</a></li>
<li><a class="reference internal" href="#referrer-policy">Politique de référencement</a></li>
<li><a class="reference internal" href="#x-content-type-options-nosniff"><code class="docutils literal notranslate"><span class="pre">X-Content-Type-Options:</span> <span class="pre">nosniff</span></code></a></li>
<li><a class="reference internal" href="#x-xss-protection-1-mode-block"><code class="docutils literal notranslate"><span class="pre">X-XSS-Protection:</span> <span class="pre">1;</span> <span class="pre">mode=block</span></code></a></li>
<li><a class="reference internal" href="#ssl-redirect">Redirection SSL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-django.contrib.sessions.middleware">Intergiciel de session</a></li>
<li><a class="reference internal" href="#module-django.contrib.sites.middleware">Intergiciel de site</a></li>
<li><a class="reference internal" href="#module-django.contrib.auth.middleware">Intergiciel d’authentification</a></li>
<li><a class="reference internal" href="#csrf-protection-middleware">Intergiciel de protection CSRF</a></li>
<li><a class="reference internal" href="#x-frame-options-middleware">Intergiciel <code class="docutils literal notranslate"><span class="pre">X-Frame-Options</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#middleware-ordering">Ordre des intergiciels</a></li>
</ul>
</li>
</ul>

  <h4>Sujet précédent</h4>
  <p class="topless"><a href="forms/validation.html"
                        title="Chapitre précédent">La validation de formulaires et de champs</a></p>
  <h4>Sujet suivant</h4>
  <p class="topless"><a href="migration-operations.html"
                        title="Chapitre suivant">Opérations de migration</a></p>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/ref/middleware.txt"
            rel="nofollow">Montrer le code source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">oct. 29, 2020</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="forms/validation.html" title="La validation de formulaires et de champs">previous</a>
     |
    <a href="index.html" title="Référence de l’API" accesskey="U">up</a>
   |
    <a href="migration-operations.html" title="Opérations de migration">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>