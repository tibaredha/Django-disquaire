
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="fr">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Fonctions de base de données &#8212; Documentation Django 3.1.3.dev</title>
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="Pagination" href="../paginator.html" />
    <link rel="prev" title="Expressions conditionnelles" href="conditional-expressions.html" />



 
<script src="../../templatebuiltins.js"></script>
<script>
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);</script>

  </head><body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../../index.html">Documentation Django 3.1.3.dev</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../../index.html">Home</a>  |
        <a title="Table of contents" href="../../contents.html">Table of contents</a>  |
        <a title="Global index" href="../../genindex.html">Index</a>  |
        <a title="Module index" href="../../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="conditional-expressions.html" title="Expressions conditionnelles">previous</a>
     |
    <a href="../index.html" title="Référence de l’API" accesskey="U">up</a>
   |
    <a href="../paginator.html" title="Pagination">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="ref-models-database-functions">
            
  <div class="section" id="s-module-django.db.models.functions">
<span id="s-database-functions"></span><span id="module-django.db.models.functions"></span><span id="database-functions"></span><h1>Fonctions de base de données<a class="headerlink" href="#module-django.db.models.functions" title="Lien permanent vers ce titre">¶</a></h1>
<p>Les classes documentées ci-dessous permettent d’exploiter dans Django les fonctions fournies par la base de données sous-jacente telles que les annotations, les agrégations ou les filtres. Les fonctions sont également des <a class="reference internal" href="expressions.html"><span class="doc">expressions</span></a>, elles peuvent donc être utilisées et combinées avec d’autres expressions comme les <a class="reference internal" href="querysets.html#aggregation-functions"><span class="std std-ref">fonctions d’agrégation</span></a>.</p>
<p>Nous allons utiliser le modèle suivant dans les exemples de chaque fonction&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">alias</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">goes_by</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Nous ne recommandons généralement pas de définir <code class="docutils literal notranslate"><span class="pre">null=True</span></code> pour les champs <code class="docutils literal notranslate"><span class="pre">CharField</span></code> car cela permet au champ de posséder deux valeurs «&nbsp;vides&nbsp;» différentes, mais nous l’utilisons ici pour l’exemple <code class="docutils literal notranslate"><span class="pre">Coalesce</span></code> ci-dessous.</p>
<div class="section" id="s-comparison-and-conversion-functions">
<span id="s-comparison-functions"></span><span id="comparison-and-conversion-functions"></span><span id="comparison-functions"></span><h2>Fonctions de comparaison et de conversion<a class="headerlink" href="#comparison-and-conversion-functions" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="s-cast">
<span id="cast"></span><h3><code class="docutils literal notranslate"><span class="pre">Cast</span></code><a class="headerlink" href="#cast" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Cast">
<em class="property">class </em><code class="descname">Cast</code>(<em>expression</em>, <em>output_field</em>)<a class="headerlink" href="#django.db.models.functions.Cast" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Force le type de résultat de <code class="docutils literal notranslate"><span class="pre">expression</span></code> à celui de <code class="docutils literal notranslate"><span class="pre">output_field</span></code>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Cast</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">age_as_float</span><span class="o">=</span><span class="n">Cast</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">output_field</span><span class="o">=</span><span class="n">FloatField</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">age_as_float</span><span class="p">)</span>
<span class="go">25.0</span>
</pre></div>
</div>
</div>
<div class="section" id="s-coalesce">
<span id="coalesce"></span><h3><code class="docutils literal notranslate"><span class="pre">Coalesce</span></code><a class="headerlink" href="#coalesce" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Coalesce">
<em class="property">class </em><code class="descname">Coalesce</code>(<em>*expressions</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Coalesce" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte une liste d’au moins deux noms de champ ou expressions et renvoie la première valeur non nulle (notez qu’une chaîne vide n’est pas considérée comme une valeur nulle). Chaque paramètre doit être d’un type similaire&nbsp;; si vous mélangez des textes et des nombres, la base de données produira une erreur.</p>
<p>Exemples d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get a screen name from least to most public</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">Sum</span><span class="p">,</span> <span class="n">Value</span> <span class="k">as</span> <span class="n">V</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Coalesce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">,</span> <span class="n">goes_by</span><span class="o">=</span><span class="s1">&#39;Maggie&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">screen_name</span><span class="o">=</span><span class="n">Coalesce</span><span class="p">(</span><span class="s1">&#39;alias&#39;</span><span class="p">,</span> <span class="s1">&#39;goes_by&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">screen_name</span><span class="p">)</span>
<span class="go">Maggie</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Prevent an aggregate Sum() from returning None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aggregated</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">combined_age</span><span class="o">=</span><span class="n">Coalesce</span><span class="p">(</span><span class="n">Sum</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">),</span> <span class="n">V</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
<span class="gp">... </span>   <span class="n">combined_age_default</span><span class="o">=</span><span class="n">Sum</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">aggregated</span><span class="p">[</span><span class="s1">&#39;combined_age&#39;</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">aggregated</span><span class="p">[</span><span class="s1">&#39;combined_age_default&#39;</span><span class="p">])</span>
<span class="go">None</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p>Avec MySQL, il est possible qu’une valeur Python transmise à <code class="docutils literal notranslate"><span class="pre">Coalesce</span></code> soit convertie en un type incorrect, sauf dans le cas où le bon type de base de données est explicitement forcé&nbsp;:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">DateTimeField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Cast</span><span class="p">,</span> <span class="n">Coalesce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.utils</span> <span class="k">import</span> <span class="n">timezone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">now</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Coalesce</span><span class="p">(</span><span class="s1">&#39;updated&#39;</span><span class="p">,</span> <span class="n">Cast</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">DateTimeField</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-greatest">
<span id="greatest"></span><h3><code class="docutils literal notranslate"><span class="pre">Greatest</span></code><a class="headerlink" href="#greatest" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Greatest">
<em class="property">class </em><code class="descname">Greatest</code>(<em>*expressions</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Greatest" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte une liste d’au moins deux noms de champ ou expressions et renvoie la plus grande valeur. Chaque paramètre doit être d’un type similaire&nbsp;; si vous mélangez des textes et des nombres, la base de données produira une erreur.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">modified</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Comment</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">modified</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Blog</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Greatest</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="s1">&#39;Greatest is the best.&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">Comment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="s1">&#39;No, Least is better.&#39;</span><span class="p">,</span> <span class="n">blog</span><span class="o">=</span><span class="n">blog</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">comments</span> <span class="o">=</span> <span class="n">Comment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">last_updated</span><span class="o">=</span><span class="n">Greatest</span><span class="p">(</span><span class="s1">&#39;modified&#39;</span><span class="p">,</span> <span class="s1">&#39;blog__modified&#39;</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">annotated_comment</span> <span class="o">=</span> <span class="n">comments</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">annotated_comment.last_updated</span></code> sera la valeur la plus récente entre <code class="docutils literal notranslate"><span class="pre">blog.modified</span></code> et <code class="docutils literal notranslate"><span class="pre">comment.modified</span></code>.</p>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p>Le comportement de <code class="docutils literal notranslate"><span class="pre">Greatest</span></code> varie entre les bases de données lorsqu’une ou plusieurs des expressions ont la valeur <code class="docutils literal notranslate"><span class="pre">null</span></code>:</p>
<ul class="simple">
<li>PostgreSQL&nbsp;: <code class="docutils literal notranslate"><span class="pre">Greatest</span></code> renvoie l’expression non nulle la plus grande, ou <code class="docutils literal notranslate"><span class="pre">null</span></code> si toutes les expressions valent <code class="docutils literal notranslate"><span class="pre">null</span></code>.</li>
<li>SQLite, Oracle et MySQL&nbsp;: si l’une des expressions vaut <code class="docutils literal notranslate"><span class="pre">null</span></code>, <code class="docutils literal notranslate"><span class="pre">Greatest</span></code> renvoie <code class="docutils literal notranslate"><span class="pre">null</span></code>.</li>
</ul>
<p class="last">Le comportement de PostgreSQL peut être émulé à l’aide de <code class="docutils literal notranslate"><span class="pre">Coalesce</span></code> si vous avez une valeur minimum adéquate à fournir comme valeur par défaut.</p>
</div>
</div>
<div class="section" id="s-least">
<span id="least"></span><h3><code class="docutils literal notranslate"><span class="pre">Least</span></code><a class="headerlink" href="#least" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Least">
<em class="property">class </em><code class="descname">Least</code>(<em>*expressions</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Least" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte une liste d’au moins deux noms de champ ou expressions et renvoie la plus petite valeur. Chaque paramètre doit être d’un type similaire&nbsp;; si vous mélangez des textes et des nombres, la base de données produira une erreur.</p>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p>Le comportement de <code class="docutils literal notranslate"><span class="pre">Least</span></code> varie entre les bases de données lorsqu’une ou plusieurs des expressions ont la valeur <code class="docutils literal notranslate"><span class="pre">null</span></code>:</p>
<ul class="simple">
<li>PostgreSQL&nbsp;: <code class="docutils literal notranslate"><span class="pre">Least</span></code> renvoie l’expression non nulle la plus petite, ou <code class="docutils literal notranslate"><span class="pre">null</span></code> si toutes les expressions valent <code class="docutils literal notranslate"><span class="pre">null</span></code>.</li>
<li>SQLite, Oracle et MySQL&nbsp;: si l’une des expressions vaut <code class="docutils literal notranslate"><span class="pre">null</span></code>, <code class="docutils literal notranslate"><span class="pre">Least</span></code> renvoie <code class="docutils literal notranslate"><span class="pre">null</span></code>.</li>
</ul>
<p class="last">Le comportement de PostgreSQL peut être émulé à l’aide de <code class="docutils literal notranslate"><span class="pre">Coalesce</span></code> si vous avez une valeur maximum adéquate à fournir comme valeur par défaut.</p>
</div>
</div>
<div class="section" id="s-nullif">
<span id="nullif"></span><h3><code class="docutils literal notranslate"><span class="pre">NullIf</span></code><a class="headerlink" href="#nullif" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.NullIf">
<em class="property">class </em><code class="descname">NullIf</code>(<em>expression1</em>, <em>expression2</em>)<a class="headerlink" href="#django.db.models.functions.NullIf" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte deux expressions et renvoie <code class="docutils literal notranslate"><span class="pre">None</span></code> si elles sont égales, sinon renvoie <code class="docutils literal notranslate"><span class="pre">expression1</span></code>.</p>
<div class="admonition-caveats-on-oracle admonition">
<p class="first admonition-title">Avertissement pour Oracle</p>
<p>En raison d’une <a class="reference internal" href="../databases.html#oracle-null-empty-strings"><span class="std std-ref">convention Oracle</span></a>, cette fonction renvoie la chaîne vide au lieu de <code class="docutils literal notranslate"><span class="pre">None</span></code> lorsque les expressions sont de type <a class="reference internal" href="fields.html#django.db.models.CharField" title="django.db.models.CharField"><code class="xref py py-class docutils literal notranslate"><span class="pre">CharField</span></code></a>.</p>
<p class="last">La transmission de <code class="docutils literal notranslate"><span class="pre">Value(None)</span></code> à <code class="docutils literal notranslate"><span class="pre">expression1</span></code> est interdite avec Oracle car cette base de données n’accepte pas <code class="docutils literal notranslate"><span class="pre">NULL</span></code> comme premier paramètre.</p>
</div>
</div>
</div>
<div class="section" id="s-date-functions">
<span id="s-id1"></span><span id="date-functions"></span><span id="id1"></span><h2>Fonctions de date<a class="headerlink" href="#date-functions" title="Lien permanent vers ce titre">¶</a></h2>
<p>Nous allons utiliser le modèle suivant dans les exemples de chaque fonction&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Experiment</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">start_datetime</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>
    <span class="n">start_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TimeField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">end_datetime</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TimeField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="s-extract">
<span id="extract"></span><h3><code class="docutils literal notranslate"><span class="pre">Extract</span></code><a class="headerlink" href="#extract" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Extract">
<em class="property">class </em><code class="descname">Extract</code>(<em>expression</em>, <em>lookup_name=None</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Extract" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Extrait un composant de date sous forme de nombre.</p>
<p>Accepte une <code class="docutils literal notranslate"><span class="pre">expression</span></code> représentant un champ <code class="docutils literal notranslate"><span class="pre">DateField</span></code>, <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code>, <code class="docutils literal notranslate"><span class="pre">TimeField</span></code> ou <code class="docutils literal notranslate"><span class="pre">DurationField</span></code> ainsi qu’un nom d’expression <code class="docutils literal notranslate"><span class="pre">lookup_name</span></code>, et renvoie la partie de date référencée par <code class="docutils literal notranslate"><span class="pre">lookup_name</span></code> sous forme de champ <code class="docutils literal notranslate"><span class="pre">IntegerField</span></code>. Django utilise habituellement la fonction d’extraction des bases de données, il est donc possible d’utiliser n’importe quel nom <code class="docutils literal notranslate"><span class="pre">lookup_name</span></code> pris en charge par la base de données en cours. Il est possible de passer aussi une sous-classe de <code class="docutils literal notranslate"><span class="pre">tzinfo</span></code>, habituellement fournie par <code class="docutils literal notranslate"><span class="pre">pytz</span></code>, pour extraire une valeur dans un fuseau horaire spécifique.</p>
<p>Étant donnée la date/heure <code class="docutils literal notranslate"><span class="pre">2015-06-15</span> <span class="pre">23:30:01.000321+00:00</span></code>, les valeurs <code class="docutils literal notranslate"><span class="pre">lookup_name</span></code> possibles renvoient&nbsp;:</p>
<ul class="simple">
<li>«&nbsp;year&nbsp;» (année)&nbsp;: 2015</li>
<li>«&nbsp;iso_year&nbsp;» (année ISO) : 2015</li>
<li>«&nbsp;quarter&nbsp;»: 2</li>
<li>«&nbsp;month&nbsp;»&nbsp;(mois)&nbsp;: 6</li>
<li>«&nbsp;day&nbsp;» (jour)&nbsp;: 15</li>
<li>«&nbsp;week&nbsp;»: 25</li>
<li>«&nbsp;week_day&nbsp;» (jour de semaine)&nbsp;: 2</li>
<li>«&nbsp;iso_week_day&nbsp;»: 1</li>
<li>«&nbsp;hour&nbsp;» (heure)&nbsp;: 23</li>
<li>«&nbsp;minute&nbsp;»: 30</li>
<li>«&nbsp;second&nbsp;»: 1</li>
</ul>
<p>Si un fuseau horaire différent comme <code class="docutils literal notranslate"><span class="pre">Australia/Melbourne</span></code> est actif dans Django, la date/heure est convertie dans le fuseau avant que la valeur soit extraite. Le décalage horaire de Melbourne dans la date d’exemple ci-dessus est +10:00. Les valeurs renvoyées lorsque ce fuseau est actif seront&nbsp;les mêmes que ci-dessus, à l’exception de&nbsp;:</p>
<ul class="simple">
<li>«&nbsp;day&nbsp;»: 16</li>
<li>«&nbsp;week_day&nbsp;»: 3</li>
<li>«&nbsp;iso_week_day&nbsp;»: 2</li>
<li>«&nbsp;hour&nbsp;»: 9</li>
</ul>
<div class="admonition-week-day-values admonition">
<p class="first admonition-title">Valeurs <code class="docutils literal notranslate"><span class="pre">week_day</span></code></p>
<p>L’extraction <code class="docutils literal notranslate"><span class="pre">week_day</span></code> est calculée différemment de la plupart des bases de données et des fonctions Python standards. Cette fonction renvoie <code class="docutils literal notranslate"><span class="pre">1</span></code> pour dimanche, <code class="docutils literal notranslate"><span class="pre">2</span></code> pour lundi, jusqu’à <code class="docutils literal notranslate"><span class="pre">7</span></code> pour samedi.</p>
<p>Le calcul équivalent en Python est&nbsp;:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">isoweekday</span><span class="p">()</span> <span class="o">%</span> <span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<div class="admonition-week-values admonition">
<p class="first admonition-title">Valeurs <code class="docutils literal notranslate"><span class="pre">week</span></code></p>
<p class="last">L’expression de recherche <code class="docutils literal notranslate"><span class="pre">week</span></code> est calculée sur la base du standard <a class="reference external" href="https://en.wikipedia.org/wiki/ISO-8601">ISO-8601</a>, c’est-à-dire qu’une semaine commence un lundi. La première semaine d’une année est celle qui contient le premier jeudi de l’année, c’est-à-dire que la première semaine à sa majorité (4 ou plus) de jours dans l’année. La valeur renvoyée se situe dans l’intervalle 1 à 52 ou 53.</p>
</div>
<p>Chaque valeur <code class="docutils literal notranslate"><span class="pre">lookup_name</span></code> ci-dessus possède une sous-classe de <code class="docutils literal notranslate"><span class="pre">Extract</span></code> correspondante (énumérées ci-dessous) qui devrait être utilisée au lieu de l’équivalent plus bavard, c’est-à-dire <code class="docutils literal notranslate"><span class="pre">ExtractYear(...)</span></code> au lieu de <code class="docutils literal notranslate"><span class="pre">Extract(...,</span> <span class="pre">lookup_name='year')</span></code>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Extract</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">start_datetime</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="n">start</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span>
<span class="gp">... </span>   <span class="n">end_datetime</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add the experiment start year as a field in the QuerySet.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">start_year</span><span class="o">=</span><span class="n">Extract</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span><span class="o">.</span><span class="n">start_year</span>
<span class="go">2015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># How many experiments completed in the same year in which they started?</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">start_datetime__year</span><span class="o">=</span><span class="n">Extract</span><span class="p">(</span><span class="s1">&#39;end_datetime&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="section" id="s-datefield-extracts">
<span id="datefield-extracts"></span><h4>Extractions <code class="docutils literal notranslate"><span class="pre">DateField</span></code><a class="headerlink" href="#datefield-extracts" title="Lien permanent vers ce titre">¶</a></h4>
<dl class="class">
<dt id="django.db.models.functions.ExtractYear">
<em class="property">class </em><code class="descname">ExtractYear</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractYear" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'year'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.ExtractIsoYear">
<em class="property">class </em><code class="descname">ExtractIsoYear</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractIsoYear" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Renvoie l’année avec numéro de semaine selon ISO-8601.</p>
<dl class="attribute">
<dt>
<code class="descname">lookup_name = 'iso_year'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.ExtractMonth">
<em class="property">class </em><code class="descname">ExtractMonth</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractMonth" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'month'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.ExtractDay">
<em class="property">class </em><code class="descname">ExtractDay</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractDay" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'day'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.ExtractWeekDay">
<em class="property">class </em><code class="descname">ExtractWeekDay</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractWeekDay" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'week_day'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.ExtractIsoWeekDay">
<em class="property">class </em><code class="descname">ExtractIsoWeekDay</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractIsoWeekDay" title="Lien permanent vers cette définition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 3.1.</span> </div>
<p>Renvoie le jour de la semaine ISO-8601, le jour 1 étant un lundi et le jour 7 un dimanche.</p>
<dl class="attribute">
<dt>
<code class="descname">lookup_name = 'iso_week_day'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.ExtractWeek">
<em class="property">class </em><code class="descname">ExtractWeek</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractWeek" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'week'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.ExtractQuarter">
<em class="property">class </em><code class="descname">ExtractQuarter</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractQuarter" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'quarter'</code></dt>
<dd></dd></dl>

</dd></dl>

<p>Il s’agit d’équivalents logiques à <code class="docutils literal notranslate"><span class="pre">Extract('champ_date',</span> <span class="pre">lookup_name)</span></code>. Chaque classe est aussi une classe <code class="docutils literal notranslate"><span class="pre">Transform</span></code> inscrite pour les champs <code class="docutils literal notranslate"><span class="pre">DateField</span></code> et <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code> comme <code class="docutils literal notranslate"><span class="pre">__(lookup_name)</span></code>, par ex. <code class="docutils literal notranslate"><span class="pre">__year</span></code>.</p>
<p>Comme les champs <code class="docutils literal notranslate"><span class="pre">DateField</span></code> n’ont pas de composant d’heure, seules les sous-classes de <code class="docutils literal notranslate"><span class="pre">Extract</span></code> qui s’appliquent aux parties de date peuvent être utilisées avec <code class="docutils literal notranslate"><span class="pre">DateField</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.utils</span> <span class="k">import</span> <span class="n">timezone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">ExtractDay</span><span class="p">,</span> <span class="n">ExtractMonth</span><span class="p">,</span> <span class="n">ExtractQuarter</span><span class="p">,</span> <span class="n">ExtractWeek</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ExtractIsoWeekDay</span><span class="p">,</span> <span class="n">ExtractWeekDay</span><span class="p">,</span> <span class="n">ExtractIsoYear</span><span class="p">,</span> <span class="n">ExtractYear</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start_2015</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">end_2015</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_2015</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="n">start_2015</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span>
<span class="gp">... </span>   <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_2015</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end_2015</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">year</span><span class="o">=</span><span class="n">ExtractYear</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">isoyear</span><span class="o">=</span><span class="n">ExtractIsoYear</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">quarter</span><span class="o">=</span><span class="n">ExtractQuarter</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">month</span><span class="o">=</span><span class="n">ExtractMonth</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">week</span><span class="o">=</span><span class="n">ExtractWeek</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">day</span><span class="o">=</span><span class="n">ExtractDay</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">weekday</span><span class="o">=</span><span class="n">ExtractWeekDay</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">isoweekday</span><span class="o">=</span><span class="n">ExtractIsoWeekDay</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;isoyear&#39;</span><span class="p">,</span> <span class="s1">&#39;quarter&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;week&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;weekday&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;isoweekday&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">end_date__year</span><span class="o">=</span><span class="n">ExtractYear</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">))</span>
<span class="go">{&#39;year&#39;: 2015, &#39;isoyear&#39;: 2015, &#39;quarter&#39;: 2, &#39;month&#39;: 6, &#39;week&#39;: 25,</span>
<span class="go"> &#39;day&#39;: 15, &#39;weekday&#39;: 2, &#39;isoweekday&#39;: 1}</span>
</pre></div>
</div>
</div>
<div class="section" id="s-datetimefield-extracts">
<span id="datetimefield-extracts"></span><h4>Extractions <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code><a class="headerlink" href="#datetimefield-extracts" title="Lien permanent vers ce titre">¶</a></h4>
<p>En plus de ce qui suit, toutes les extractions pour <code class="docutils literal notranslate"><span class="pre">DateField</span></code> énumérées ci-dessus peuvent aussi être utilisées pour <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code>.</p>
<dl class="class">
<dt id="django.db.models.functions.ExtractHour">
<em class="property">class </em><code class="descname">ExtractHour</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractHour" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'hour'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.ExtractMinute">
<em class="property">class </em><code class="descname">ExtractMinute</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractMinute" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'minute'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.ExtractSecond">
<em class="property">class </em><code class="descname">ExtractSecond</code>(<em>expression</em>, <em>tzinfo=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ExtractSecond" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'second'</code></dt>
<dd></dd></dl>

</dd></dl>

<p>Il s’agit d’équivalents logiques à <code class="docutils literal notranslate"><span class="pre">Extract('champ_datetime',</span> <span class="pre">lookup_name)</span></code>. Chaque classe est aussi une classe <code class="docutils literal notranslate"><span class="pre">Transform</span></code> inscrite pour le champ <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code> comme <code class="docutils literal notranslate"><span class="pre">__(lookup_name)</span></code>, par ex. <code class="docutils literal notranslate"><span class="pre">__minute</span></code>.</p>
<p>Exemples <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.utils</span> <span class="k">import</span> <span class="n">timezone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">ExtractDay</span><span class="p">,</span> <span class="n">ExtractHour</span><span class="p">,</span> <span class="n">ExtractMinute</span><span class="p">,</span> <span class="n">ExtractMonth</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ExtractQuarter</span><span class="p">,</span> <span class="n">ExtractSecond</span><span class="p">,</span> <span class="n">ExtractWeek</span><span class="p">,</span> <span class="n">ExtractIsoWeekDay</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ExtractWeekDay</span><span class="p">,</span> <span class="n">ExtractIsoYear</span><span class="p">,</span> <span class="n">ExtractYear</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start_2015</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">end_2015</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_2015</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="n">start_2015</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span>
<span class="gp">... </span>   <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_2015</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end_2015</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">year</span><span class="o">=</span><span class="n">ExtractYear</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">isoyear</span><span class="o">=</span><span class="n">ExtractIsoYear</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">quarter</span><span class="o">=</span><span class="n">ExtractQuarter</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">month</span><span class="o">=</span><span class="n">ExtractMonth</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">week</span><span class="o">=</span><span class="n">ExtractWeek</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">day</span><span class="o">=</span><span class="n">ExtractDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">weekday</span><span class="o">=</span><span class="n">ExtractWeekDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">isoweekday</span><span class="o">=</span><span class="n">ExtractIsoWeekDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">hour</span><span class="o">=</span><span class="n">ExtractHour</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">minute</span><span class="o">=</span><span class="n">ExtractMinute</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">second</span><span class="o">=</span><span class="n">ExtractSecond</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;isoyear&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;week&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;isoweekday&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="s1">&#39;minute&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">end_datetime__year</span><span class="o">=</span><span class="n">ExtractYear</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">))</span>
<span class="go">{&#39;year&#39;: 2015, &#39;isoyear&#39;: 2015, &#39;quarter&#39;: 2, &#39;month&#39;: 6, &#39;week&#39;: 25,</span>
<span class="go"> &#39;day&#39;: 15, &#39;weekday&#39;: 2, &#39;isoweekday&#39;: 1, &#39;hour&#39;: 23, &#39;minute&#39;: 30,</span>
<span class="go"> &#39;second&#39;: 1}</span>
</pre></div>
</div>
<p>Lorsque <a class="reference internal" href="../settings.html#std:setting-USE_TZ"><code class="xref std std-setting docutils literal notranslate"><span class="pre">USE_TZ</span></code></a> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>, les dates/heures sont stockées en UTC dans la base de données. Si un autre fuseau horaire est actif dans Django, la date/heure est convertie dans ce fuseau avant que la valeur soit extraite. L’exemple ci-dessous convertit dans le fuseau horaire de Melbourne (UTC +10:00), ce qui modifie les valeurs du jour, du jour de la semaine et de l’heure qui sont renvoyées&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">melb</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;Australia/Melbourne&#39;</span><span class="p">)</span>  <span class="c1"># UTC+10:00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">timezone</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">melb</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">day</span><span class="o">=</span><span class="n">ExtractDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>       <span class="n">weekday</span><span class="o">=</span><span class="n">ExtractWeekDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>       <span class="n">isoweekday</span><span class="o">=</span><span class="n">ExtractIsoWeekDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>       <span class="n">hour</span><span class="o">=</span><span class="n">ExtractHour</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>   <span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;isoweekday&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">end_datetime__year</span><span class="o">=</span><span class="n">ExtractYear</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>   <span class="p">)</span>
<span class="go">{&#39;day&#39;: 16, &#39;weekday&#39;: 3, &#39;isoweekday&#39;: 2, &#39;hour&#39;: 9}</span>
</pre></div>
</div>
<p>Le passage explicite du fuseau horaire à la fonction <code class="docutils literal notranslate"><span class="pre">Extract</span></code> fonctionne de la même manière et prend la priorité sur le fuseau horaire actif&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">melb</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;Australia/Melbourne&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">day</span><span class="o">=</span><span class="n">ExtractDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">melb</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">weekday</span><span class="o">=</span><span class="n">ExtractWeekDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">melb</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">isoweekday</span><span class="o">=</span><span class="n">ExtractIsoWeekDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">melb</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">hour</span><span class="o">=</span><span class="n">ExtractHour</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">melb</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;isoweekday&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">end_datetime__year</span><span class="o">=</span><span class="n">ExtractYear</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">{&#39;day&#39;: 16, &#39;weekday&#39;: 3, &#39;isoweekday&#39;: 2, &#39;hour&#39;: 9}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-now">
<span id="now"></span><h3><code class="docutils literal notranslate"><span class="pre">Now</span></code><a class="headerlink" href="#now" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Now">
<em class="property">class </em><code class="descname">Now</code><a class="headerlink" href="#django.db.models.functions.Now" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la date et l’heure courante du serveur de base de données au moment où la requête est exécutée, typiquement en utilisant le code SQL <code class="docutils literal notranslate"><span class="pre">CURRENT_TIMESTAMP</span></code>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Now</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">published__lte</span><span class="o">=</span><span class="n">Now</span><span class="p">())</span>
<span class="go">&lt;QuerySet [&lt;Article: How to Django&gt;]&gt;</span>
</pre></div>
</div>
<div class="admonition-postgresql-considerations admonition">
<p class="first admonition-title">Considérations sur PostgreSQL</p>
<p class="last">Avec PostgreSQL, l’instruction <code class="docutils literal notranslate"><span class="pre">CURRENT_TIMESTAMP</span></code> renvoie l’heure du début de la transaction actuelle. Par conséquent, pour garantir la compatibilité entre bases de données, <code class="docutils literal notranslate"><span class="pre">Now()</span></code> utilise <code class="docutils literal notranslate"><span class="pre">STATEMENT_TIMESTAMP</span></code> à la place. Si vous avez besoin de l’horodatage de la transaction, utilisez <a class="reference internal" href="../contrib/postgres/functions.html#django.contrib.postgres.functions.TransactionNow" title="django.contrib.postgres.functions.TransactionNow"><code class="xref py py-class docutils literal notranslate"><span class="pre">django.contrib.postgres.functions.TransactionNow</span></code></a>.</p>
</div>
</div>
<div class="section" id="s-trunc">
<span id="trunc"></span><h3><code class="docutils literal notranslate"><span class="pre">Trunc</span></code><a class="headerlink" href="#trunc" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Trunc">
<em class="property">class </em><code class="descname">Trunc</code>(<em>expression</em>, <em>kind</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Trunc" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Tronque une date jusqu’à un composant significatif.</p>
<p>Lorsque vous ne voulez que savoir si quelque chose s’est produit durant une année, une heure ou un jour particulier, mais pas à quelle  seconde, <code class="docutils literal notranslate"><span class="pre">Trunc</span></code> (et ses sous-classes) peut être utile pour filtrer ou agréger vos données. Par exemple, vous pouvez utiliser <code class="docutils literal notranslate"><span class="pre">Trunc</span></code> pour calculer le nombre de ventes par jour.</p>
<p><code class="docutils literal notranslate"><span class="pre">Trunc</span></code> accepte une seule <code class="docutils literal notranslate"><span class="pre">expression</span></code>, représentant un champ <code class="docutils literal notranslate"><span class="pre">DateField</span></code>, <code class="docutils literal notranslate"><span class="pre">TimeField</span></code> ou <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code>, une variable <code class="docutils literal notranslate"><span class="pre">kind</span></code> représentant une partie de date ou d’heure et un champ <code class="docutils literal notranslate"><span class="pre">output_field</span></code> qui vaut <code class="docutils literal notranslate"><span class="pre">DateTimeField()</span></code>, <code class="docutils literal notranslate"><span class="pre">TimeField()</span></code> ou <code class="docutils literal notranslate"><span class="pre">DateField()</span></code>. Elle renvoie une date, une heure ou une date/heure en fonction de <code class="docutils literal notranslate"><span class="pre">output_field</span></code>, avec les champs jusqu’à <code class="docutils literal notranslate"><span class="pre">kind</span></code> définis à leur valeur minimale. Si <code class="docutils literal notranslate"><span class="pre">output_field</span></code> est omis, la valeur par défaut sera le type <code class="docutils literal notranslate"><span class="pre">output_field</span></code> de <code class="docutils literal notranslate"><span class="pre">expression</span></code>. Il est possible de passer aussi une sous-classe de <code class="docutils literal notranslate"><span class="pre">tzinfo</span></code>, habituellement fournie par <code class="docutils literal notranslate"><span class="pre">pytz</span></code>, pour tronquer une valeur dans un fuseau horaire spécifique.</p>
<p>Le paramètre <code class="docutils literal notranslate"><span class="pre">is_dst</span></code> indique si <code class="docutils literal notranslate"><span class="pre">pytz</span></code> doit interpréter les heures non existantes et ambiguës dans les transitions de changements d’heures saisonniers. Par défaut (lorsque <code class="docutils literal notranslate"><span class="pre">is_dst=None</span></code>), <code class="docutils literal notranslate"><span class="pre">pytz</span></code> génère une exception pour de telles heures.</p>
<div class="versionadded">
<span class="title">New in Django 3.0:</span> <p>Le paramètre <code class="docutils literal notranslate"><span class="pre">is_dst</span></code> a été ajouté.</p>
</div>
<p>Étant donnée la date/heure <code class="docutils literal notranslate"><span class="pre">2015-06-15</span> <span class="pre">14:30:50.000321+00:00</span></code>, les valeurs <code class="docutils literal notranslate"><span class="pre">kind</span></code> possibles renvoient&nbsp;:</p>
<ul class="simple">
<li>«&nbsp;year&nbsp;»: 2015-01-01 00:00:00+00:00</li>
<li>«&nbsp;quarter&nbsp;»: 2015-04-01 00:00:00+00:00</li>
<li>«&nbsp;month&nbsp;»: 2015-06-01 00:00:00+00:00</li>
<li>«&nbsp;week&nbsp;»: 2015-06-15 00:00:00+00:00</li>
<li>«&nbsp;day&nbsp;»: 2015-06-15 00:00:00+00:00</li>
<li>«&nbsp;hour&nbsp;»: 2015-06-15 14:00:00+00:00</li>
<li>«&nbsp;minute&nbsp;»: 2015-06-15 14:30:00+00:00</li>
<li>«&nbsp;second&nbsp;»: 2015-06-15 14:30:50+00:00</li>
</ul>
<p>Si un fuseau horaire différent comme <code class="docutils literal notranslate"><span class="pre">Australia/Melbourne</span></code> est actif dans Django, la date/heure est convertie dans le nouveau fuseau avant que la valeur soit tronquée. Le décalage horaire de Melbourne dans la date d’exemple ci-dessus est +10:00. Les valeurs renvoyées lorsque ce fuseau est actif seront&nbsp;:</p>
<ul class="simple">
<li>«&nbsp;year&nbsp;»: 2015-01-01 00:00:00+11:00</li>
<li>«&nbsp;quarter&nbsp;»: 2015-04-01 00:00:00+10:00</li>
<li>«&nbsp;month&nbsp;»: 2015-06-01 00:00:00+10:00</li>
<li>«&nbsp;week&nbsp;»: 2015-06-16 00:00:00+10:00</li>
<li>«&nbsp;day&nbsp;»: 2015-06-16 00:00:00+10:00</li>
<li>«&nbsp;hour&nbsp;»: 2015-06-16 00:00:00+10:00</li>
<li>«&nbsp;minute&nbsp;»: 2015-06-16 00:30:00+10:00</li>
<li>«&nbsp;second&nbsp;»: 2015-06-16 00:30:50+10:00</li>
</ul>
<p>L’année présente un décalage de +11:00 parce que le résultat traverse un passage à l’heure d’été.</p>
<p>Chaque valeur <code class="docutils literal notranslate"><span class="pre">kind</span></code> ci-dessus possède une sous-classe de <code class="docutils literal notranslate"><span class="pre">Trunc</span></code> correspondante (énumérées ci-dessous) qui devrait être utilisée au lieu de l’équivalent plus bavard, c’est-à-dire <code class="docutils literal notranslate"><span class="pre">TruncYear(...)</span></code> au lieu de <code class="docutils literal notranslate"><span class="pre">Trunc(...,</span> <span class="pre">kind='year')</span></code>.</p>
<p>Les sous-classes sont toutes définies comme des transformations, mais elles ne sont inscrites pour aucun champ, car les noms de requête sont déjà réservés par les sous-classes de <code class="docutils literal notranslate"><span class="pre">Extract</span></code>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">Count</span><span class="p">,</span> <span class="n">DateTimeField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Trunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">321</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">123</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">999</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiments_per_day</span> <span class="o">=</span> <span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">start_day</span><span class="o">=</span><span class="n">Trunc</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">output_field</span><span class="o">=</span><span class="n">DateTimeField</span><span class="p">())</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;start_day&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">experiments</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">experiments_per_day</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="s1">&#39;start_day&#39;</span><span class="p">],</span> <span class="n">exp</span><span class="p">[</span><span class="s1">&#39;experiments&#39;</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">2015-06-15 00:00:00 2</span>
<span class="go">2015-12-25 00:00:00 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiments</span> <span class="o">=</span> <span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">start_day</span><span class="o">=</span><span class="n">Trunc</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">output_field</span><span class="o">=</span><span class="n">DateTimeField</span><span class="p">())</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">start_day</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">experiments</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">start_datetime</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">2015-06-15 14:30:50.000321</span>
<span class="go">2015-06-15 14:40:02.000123</span>
</pre></div>
</div>
<div class="section" id="s-datefield-truncation">
<span id="datefield-truncation"></span><h4>Troncature de <code class="docutils literal notranslate"><span class="pre">DateField</span></code><a class="headerlink" href="#datefield-truncation" title="Lien permanent vers ce titre">¶</a></h4>
<dl class="class">
<dt id="django.db.models.functions.TruncYear">
<em class="property">class </em><code class="descname">TruncYear</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncYear" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'year'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.TruncMonth">
<em class="property">class </em><code class="descname">TruncMonth</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncMonth" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'month'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.TruncWeek">
<em class="property">class </em><code class="descname">TruncWeek</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncWeek" title="Lien permanent vers cette définition">¶</a></dt>
<dd><p>Tronque à minuit le lundi de la semaine.</p>
<dl class="attribute">
<dt>
<code class="descname">kind = 'week'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.TruncQuarter">
<em class="property">class </em><code class="descname">TruncQuarter</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncQuarter" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'quarter'</code></dt>
<dd></dd></dl>

</dd></dl>

<p>Ce sont des équivalences logiques à <code class="docutils literal notranslate"><span class="pre">Trunc('champ_date',</span> <span class="pre">kind)</span></code>. Elles tronquent toutes les parties de la date jusqu’à <code class="docutils literal notranslate"><span class="pre">kind</span></code>, ce qui permet de grouper ou de filtrer des dates avec une plus faible précision. <code class="docutils literal notranslate"><span class="pre">expression</span></code> peut avoir une valeur <code class="docutils literal notranslate"><span class="pre">output_field</span></code> de <code class="docutils literal notranslate"><span class="pre">DateField</span></code> ou de <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code>.</p>
<p>Comme les champs <code class="docutils literal notranslate"><span class="pre">DateField</span></code> n’ont pas de composant d’heure, seules les sous-classes de <code class="docutils literal notranslate"><span class="pre">Trunc</span></code> qui s’appliquent aux parties de date peuvent être utilisées avec <code class="docutils literal notranslate"><span class="pre">DateField</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">Count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">TruncMonth</span><span class="p">,</span> <span class="n">TruncYear</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.utils</span> <span class="k">import</span> <span class="n">timezone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start1</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">321</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start2</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start3</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">start1</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="n">start1</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">start2</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="n">start2</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">start3</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="n">start3</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiments_per_year</span> <span class="o">=</span> <span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">year</span><span class="o">=</span><span class="n">TruncYear</span><span class="p">(</span><span class="s1">&#39;start_date&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">experiments</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">experiments_per_year</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">exp</span><span class="p">[</span><span class="s1">&#39;experiments&#39;</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">2014-01-01 1</span>
<span class="go">2015-01-01 2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">melb</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;Australia/Melbourne&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiments_per_month</span> <span class="o">=</span> <span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">month</span><span class="o">=</span><span class="n">TruncMonth</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">melb</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">experiments</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">experiments_per_month</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">],</span> <span class="n">exp</span><span class="p">[</span><span class="s1">&#39;experiments&#39;</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">2015-06-01 00:00:00+10:00 1</span>
<span class="go">2016-01-01 00:00:00+11:00 1</span>
<span class="go">2014-06-01 00:00:00+10:00 1</span>
</pre></div>
</div>
</div>
<div class="section" id="s-datetimefield-truncation">
<span id="datetimefield-truncation"></span><h4>Troncature de <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code><a class="headerlink" href="#datetimefield-truncation" title="Lien permanent vers ce titre">¶</a></h4>
<dl class="class">
<dt id="django.db.models.functions.TruncDate">
<em class="property">class </em><code class="descname">TruncDate</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncDate" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'date'</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">output_field = DateField()</code></dt>
<dd></dd></dl>

</dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">TruncDate</span></code> force le type de <code class="docutils literal notranslate"><span class="pre">expression</span></code> à une date plutôt que d’utiliser l’instruction SQL de troncature. Elle est aussi inscrite comme transformation pour <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code> sous la forme <code class="docutils literal notranslate"><span class="pre">__date</span></code>.</p>
<dl class="class">
<dt id="django.db.models.functions.TruncTime">
<em class="property">class </em><code class="descname">TruncTime</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncTime" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">lookup_name = 'time'</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">output_field = TimeField()</code></dt>
<dd></dd></dl>

</dd></dl>

<p><code class="docutils literal notranslate"><span class="pre">TruncTime</span></code> force le type de <code class="docutils literal notranslate"><span class="pre">expression</span></code> à une heure plutôt que d’utiliser l’instruction SQL de troncature. Elle est aussi inscrite comme transformation pour <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code> sous la forme <code class="docutils literal notranslate"><span class="pre">__time</span></code>.</p>
<dl class="class">
<dt id="django.db.models.functions.TruncDay">
<em class="property">class </em><code class="descname">TruncDay</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncDay" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'day'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.TruncHour">
<em class="property">class </em><code class="descname">TruncHour</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncHour" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'hour'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.TruncMinute">
<em class="property">class </em><code class="descname">TruncMinute</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncMinute" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'minute'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="django.db.models.functions.TruncSecond">
<em class="property">class </em><code class="descname">TruncSecond</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.TruncSecond" title="Lien permanent vers cette définition">¶</a></dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'second'</code></dt>
<dd></dd></dl>

</dd></dl>

<p>Ce sont des équivalences logiques à <code class="docutils literal notranslate"><span class="pre">Trunc('champ_dateheure',</span> <span class="pre">kind)</span></code>. Elles tronquent toutes les parties de la date jusqu’à <code class="docutils literal notranslate"><span class="pre">kind</span></code>, ce qui permet de grouper ou de filtrer des dates/heures avec une plus faible précision. <code class="docutils literal notranslate"><span class="pre">expression</span></code> doit avoir une valeur <code class="docutils literal notranslate"><span class="pre">output_field</span></code> de <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">Count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">TruncDate</span><span class="p">,</span> <span class="n">TruncDay</span><span class="p">,</span> <span class="n">TruncHour</span><span class="p">,</span> <span class="n">TruncMinute</span><span class="p">,</span> <span class="n">TruncSecond</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.utils</span> <span class="k">import</span> <span class="n">timezone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start1</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">321</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">start1</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="n">start1</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">melb</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;Australia/Melbourne&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">date</span><span class="o">=</span><span class="n">TruncDate</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">day</span><span class="o">=</span><span class="n">TruncDay</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">melb</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">hour</span><span class="o">=</span><span class="n">TruncHour</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">melb</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">minute</span><span class="o">=</span><span class="n">TruncMinute</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">second</span><span class="o">=</span><span class="n">TruncSecond</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="s1">&#39;minute&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">{&#39;date&#39;: datetime.date(2014, 6, 15),</span>
<span class="go"> &#39;day&#39;: datetime.datetime(2014, 6, 16, 0, 0, tzinfo=&lt;DstTzInfo &#39;Australia/Melbourne&#39; AEST+10:00:00 STD&gt;),</span>
<span class="go"> &#39;hour&#39;: datetime.datetime(2014, 6, 16, 0, 0, tzinfo=&lt;DstTzInfo &#39;Australia/Melbourne&#39; AEST+10:00:00 STD&gt;),</span>
<span class="go"> &#39;minute&#39;: &#39;minute&#39;: datetime.datetime(2014, 6, 15, 14, 30, tzinfo=&lt;UTC&gt;),</span>
<span class="go"> &#39;second&#39;: datetime.datetime(2014, 6, 15, 14, 30, 50, tzinfo=&lt;UTC&gt;)</span>
<span class="go">}</span>
</pre></div>
</div>
</div>
<div class="section" id="s-timefield-truncation">
<span id="timefield-truncation"></span><h4>Troncature de <code class="docutils literal notranslate"><span class="pre">TimeField</span></code><a class="headerlink" href="#timefield-truncation" title="Lien permanent vers ce titre">¶</a></h4>
<dl class="class">
<dt>
<em class="property">class </em><code class="descname">TruncHour</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)</dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'hour'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descname">TruncMinute</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)</dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'minute'</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descname">TruncSecond</code>(<em>expression</em>, <em>output_field=None</em>, <em>tzinfo=None</em>, <em>is_dst=None</em>, <em>**extra</em>)</dt>
<dd><dl class="attribute">
<dt>
<code class="descname">kind = 'second'</code></dt>
<dd></dd></dl>

</dd></dl>

<p>Ce sont des équivalences logiques à <code class="docutils literal notranslate"><span class="pre">Trunc('champ_heure',</span> <span class="pre">kind)</span></code>. Elles tronquent toutes les parties de l’heure jusqu’à <code class="docutils literal notranslate"><span class="pre">kind</span></code>, ce qui permet de grouper ou de filtrer des heures avec une plus faible précision. <code class="docutils literal notranslate"><span class="pre">expression</span></code> peut avoir une valeur <code class="docutils literal notranslate"><span class="pre">output_field</span></code> de <code class="docutils literal notranslate"><span class="pre">TimeField</span></code> ou de <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code>.</p>
<p>Comme les champs <code class="docutils literal notranslate"><span class="pre">TimeField</span></code> n’ont pas de composant de date, seules les sous-classes de <code class="docutils literal notranslate"><span class="pre">Trunc</span></code> qui s’appliquent aux parties d’heure peuvent être utilisées avec <code class="docutils literal notranslate"><span class="pre">TimeField</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">Count</span><span class="p">,</span> <span class="n">TimeField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">TruncHour</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.utils</span> <span class="k">import</span> <span class="n">timezone</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start1</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">321</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start2</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start3</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">start1</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="n">start1</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">start2</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="n">start2</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">=</span><span class="n">start3</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="n">start3</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiments_per_hour</span> <span class="o">=</span> <span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">hour</span><span class="o">=</span><span class="n">TruncHour</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="n">output_field</span><span class="o">=</span><span class="n">TimeField</span><span class="p">()),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">experiments</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">experiments_per_hour</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">],</span> <span class="n">exp</span><span class="p">[</span><span class="s1">&#39;experiments&#39;</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">14:00:00 2</span>
<span class="go">17:00:00 1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">melb</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;Australia/Melbourne&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiments_per_hour</span> <span class="o">=</span> <span class="n">Experiment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">hour</span><span class="o">=</span><span class="n">TruncHour</span><span class="p">(</span><span class="s1">&#39;start_datetime&#39;</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">melb</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">experiments</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">experiments_per_hour</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">],</span> <span class="n">exp</span><span class="p">[</span><span class="s1">&#39;experiments&#39;</span><span class="p">])</span>
<span class="gp">...</span>
<span class="go">2014-06-16 00:00:00+10:00 2</span>
<span class="go">2016-01-01 04:00:00+11:00 1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="s-math-functions">
<span id="s-id2"></span><span id="math-functions"></span><span id="id2"></span><h2>Fonctions mathématiques<a class="headerlink" href="#math-functions" title="Lien permanent vers ce titre">¶</a></h2>
<p>Nous allons utiliser le modèle suivant dans les exemples de fonction mathématique qui suivront&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Vector</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="s-abs">
<span id="abs"></span><h3><code class="docutils literal notranslate"><span class="pre">Abs</span></code><a class="headerlink" href="#abs" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Abs">
<em class="property">class </em><code class="descname">Abs</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Abs" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la valeur absolue d’un champ ou d’une expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Abs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_abs</span><span class="o">=</span><span class="n">Abs</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_abs</span><span class="o">=</span><span class="n">Abs</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_abs</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_abs</span>
<span class="go">(0.5, 1.1)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Abs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Abs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors inside the unit cube</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__abs__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y__abs__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-acos">
<span id="acos"></span><h3><code class="docutils literal notranslate"><span class="pre">ACos</span></code><a class="headerlink" href="#acos" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.ACos">
<em class="property">class </em><code class="descname">ACos</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ACos" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie l’arccosinus d’un champ ou d’une expression numérique. La valeur de l’expression doit se situer dans l’intervalle -1 à 1.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">ACos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_acos</span><span class="o">=</span><span class="n">ACos</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_acos</span><span class="o">=</span><span class="n">ACos</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_acos</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_acos</span>
<span class="go">(1.0471975511965979, 2.6905658417935308)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">ACos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">ACos</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose arccosine is less than 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__acos__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y__acos__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-asin">
<span id="asin"></span><h3><code class="docutils literal notranslate"><span class="pre">ASin</span></code><a class="headerlink" href="#asin" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.ASin">
<em class="property">class </em><code class="descname">ASin</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ASin" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie l’arcsinus d’un champ ou d’une expression numérique. La valeur de l’expression doit se situer dans l’intervalle -1 à 1.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">ASin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_asin</span><span class="o">=</span><span class="n">ASin</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_asin</span><span class="o">=</span><span class="n">ASin</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_asin</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_asin</span>
<span class="go">(0.0, 1.5707963267948966)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">ASin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">ASin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose arcsine is less than 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__asin__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y__asin__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-atan">
<span id="atan"></span><h3><code class="docutils literal notranslate"><span class="pre">ATan</span></code><a class="headerlink" href="#atan" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.ATan">
<em class="property">class </em><code class="descname">ATan</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ATan" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie l’arctangente d’un champ ou d’une expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">ATan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3.12</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">6.987</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_atan</span><span class="o">=</span><span class="n">ATan</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_atan</span><span class="o">=</span><span class="n">ATan</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_atan</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_atan</span>
<span class="go">(1.2606282660069106, 1.428638798133829)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">ATan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">ATan</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose arctangent is less than 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__atan__lt</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y__atan__lt</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-atan2">
<span id="atan2"></span><h3><code class="docutils literal notranslate"><span class="pre">ATan2</span></code><a class="headerlink" href="#atan2" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.ATan2">
<em class="property">class </em><code class="descname">ATan2</code>(<em>expression1</em>, <em>expression2</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.ATan2" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie l’arctangente de <code class="docutils literal notranslate"><span class="pre">expression1</span> <span class="pre">/</span> <span class="pre">expression2</span></code>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">ATan2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">atan2</span><span class="o">=</span><span class="n">ATan2</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">atan2</span>
<span class="go">0.9209258773829491</span>
</pre></div>
</div>
</div>
<div class="section" id="s-ceil">
<span id="ceil"></span><h3><code class="docutils literal notranslate"><span class="pre">Ceil</span></code><a class="headerlink" href="#ceil" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Ceil">
<em class="property">class </em><code class="descname">Ceil</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Ceil" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie le plus petit nombre entier plus grand ou égal au champ ou à l’expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Ceil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3.12</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">7.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_ceil</span><span class="o">=</span><span class="n">Ceil</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_ceil</span><span class="o">=</span><span class="n">Ceil</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_ceil</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_ceil</span>
<span class="go">(4.0, 7.0)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Ceil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Ceil</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose ceil is less than 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__ceil__lt</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y__ceil__lt</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-cos">
<span id="cos"></span><h3><code class="docutils literal notranslate"><span class="pre">Cos</span></code><a class="headerlink" href="#cos" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Cos">
<em class="property">class </em><code class="descname">Cos</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Cos" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie le cosinus d’un champ ou d’une expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">3.1415926</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_cos</span><span class="o">=</span><span class="n">Cos</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_cos</span><span class="o">=</span><span class="n">Cos</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_cos</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_cos</span>
<span class="go">(-0.14550003380861354, -0.9999999999999986)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Cos</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose cosine is less than 0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__cos__lt</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y__cos__lt</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-cot">
<span id="cot"></span><h3><code class="docutils literal notranslate"><span class="pre">Cot</span></code><a class="headerlink" href="#cot" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Cot">
<em class="property">class </em><code class="descname">Cot</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Cot" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la cotangente d’un champ ou d’une expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_cot</span><span class="o">=</span><span class="n">Cot</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_cot</span><span class="o">=</span><span class="n">Cot</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_cot</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_cot</span>
<span class="go">(-1.5726734063976826, 0.642092615934331)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Cot</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose cotangent is less than 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__cot__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y__cot__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-degrees">
<span id="degrees"></span><h3><code class="docutils literal notranslate"><span class="pre">Degrees</span></code><a class="headerlink" href="#degrees" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Degrees">
<em class="property">class </em><code class="descname">Degrees</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Degrees" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Convertit un champ ou une expression numérique de radians en degrés.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Degrees</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mf">1.57</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">3.14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_d</span><span class="o">=</span><span class="n">Degrees</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_d</span><span class="o">=</span><span class="n">Degrees</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_d</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_d</span>
<span class="go">(-89.95437383553924, 179.9087476710785)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Degrees</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Degrees</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose degrees are less than 360</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__degrees__lt</span><span class="o">=</span><span class="mi">360</span><span class="p">,</span> <span class="n">y__degrees__lt</span><span class="o">=</span><span class="mi">360</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-exp">
<span id="exp"></span><h3><code class="docutils literal notranslate"><span class="pre">Exp</span></code><a class="headerlink" href="#exp" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Exp">
<em class="property">class </em><code class="descname">Exp</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Exp" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la valeur de <code class="docutils literal notranslate"><span class="pre">e</span></code> (la base du logarithme naturel) élevé à la puissance du champ ou de l’expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Exp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.4</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_exp</span><span class="o">=</span><span class="n">Exp</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_exp</span><span class="o">=</span><span class="n">Exp</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_exp</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_exp</span>
<span class="go">(221.40641620418717, 0.1353352832366127)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Exp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Exp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose exp() is greater than 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__exp__gt</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y__exp__gt</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-floor">
<span id="floor"></span><h3><code class="docutils literal notranslate"><span class="pre">Floor</span></code><a class="headerlink" href="#floor" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Floor">
<em class="property">class </em><code class="descname">Floor</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Floor" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie le plus grand nombre entier qui n’est pas plus grand que le champ ou l’expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Floor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.4</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_floor</span><span class="o">=</span><span class="n">Floor</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_floor</span><span class="o">=</span><span class="n">Floor</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_floor</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_floor</span>
<span class="go">(5.0, -3.0)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Floor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Floor</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose floor() is greater than 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__floor__gt</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y__floor__gt</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-ln">
<span id="ln"></span><h3><code class="docutils literal notranslate"><span class="pre">Ln</span></code><a class="headerlink" href="#ln" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Ln">
<em class="property">class </em><code class="descname">Ln</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Ln" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie le logarithme naturel d’un champ ou d’une expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Ln</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.4</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">233.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_ln</span><span class="o">=</span><span class="n">Ln</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_ln</span><span class="o">=</span><span class="n">Ln</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_ln</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_ln</span>
<span class="go">(1.6863989535702288, 5.4510384535657)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Ln</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Ln</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose value greater than e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__ln__gt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y__ln__gt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-log">
<span id="log"></span><h3><code class="docutils literal notranslate"><span class="pre">Log</span></code><a class="headerlink" href="#log" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Log">
<em class="property">class </em><code class="descname">Log</code>(<em>expression1</em>, <em>expression2</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Log" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte deux champs ou expressions numériques et renvoie le logarithme du premier en base du second.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="n">Log</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">log</span>
<span class="go">2.0</span>
</pre></div>
</div>
</div>
<div class="section" id="s-mod">
<span id="mod"></span><h3><code class="docutils literal notranslate"><span class="pre">Mod</span></code><a class="headerlink" href="#mod" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Mod">
<em class="property">class </em><code class="descname">Mod</code>(<em>expression1</em>, <em>expression2</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Mod" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte deux champs ou expressions numériques et renvoie le reste du premier divisé par le second (opération modulo).</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Mod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.4</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">mod</span><span class="o">=</span><span class="n">Mod</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">mod</span>
<span class="go">0.8</span>
</pre></div>
</div>
</div>
<div class="section" id="s-pi">
<span id="pi"></span><h3><code class="docutils literal notranslate"><span class="pre">Pi</span></code><a class="headerlink" href="#pi" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Pi">
<em class="property">class </em><code class="descname">Pi</code>(<em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Pi" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la valeur de la constante mathématique <code class="docutils literal notranslate"><span class="pre">π</span></code>.</p>
</div>
<div class="section" id="s-power">
<span id="power"></span><h3><code class="docutils literal notranslate"><span class="pre">Power</span></code><a class="headerlink" href="#power" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Power">
<em class="property">class </em><code class="descname">Power</code>(<em>expression1</em>, <em>expression2</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Power" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte deux champs ou expressions numériques et renvoie la valeur du premier élevé à la puissance du second.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Power</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">power</span><span class="o">=</span><span class="n">Power</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">power</span>
<span class="go">0.25</span>
</pre></div>
</div>
</div>
<div class="section" id="s-radians">
<span id="radians"></span><h3><code class="docutils literal notranslate"><span class="pre">Radians</span></code><a class="headerlink" href="#radians" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Radians">
<em class="property">class </em><code class="descname">Radians</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Radians" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Convertit un champ ou une expression numérique de degrés en radians.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Radians</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_r</span><span class="o">=</span><span class="n">Radians</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_r</span><span class="o">=</span><span class="n">Radians</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_r</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_r</span>
<span class="go">(-1.5707963267948966, 3.141592653589793)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Radians</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Radians</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose radians are less than 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__radians__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y__radians__lt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-round">
<span id="round"></span><h3><code class="docutils literal notranslate"><span class="pre">Round</span></code><a class="headerlink" href="#round" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Round">
<em class="property">class </em><code class="descname">Round</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Round" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Arrondit un champ ou une expression numérique à l’entier le plus proche. L’arrondi vers le haut ou vers le bas des valeurs médianes (.5) dépend de la base de données utilisée.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Round</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.4</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_r</span><span class="o">=</span><span class="n">Round</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_r</span><span class="o">=</span><span class="n">Round</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_r</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_r</span>
<span class="go">(5.0, -2.0)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Round</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Round</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose round() is less than 20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__round__lt</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y__round__lt</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-sign">
<span id="sign"></span><h3><code class="docutils literal notranslate"><span class="pre">Sign</span></code><a class="headerlink" href="#sign" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Sign">
<em class="property">class </em><code class="descname">Sign</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Sign" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<div class="versionadded">
<span class="title">New in Django 3.0.</span> </div>
<p>Renvoie le signe (-1, 0, 1) d’un champ ou d’une expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Sign</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.4</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_sign</span><span class="o">=</span><span class="n">Sign</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_sign</span><span class="o">=</span><span class="n">Sign</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_sign</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_sign</span>
<span class="go">(1, -1)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Sign</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Sign</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose signs of components are less than 0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__sign__lt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y__sign__lt</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-sin">
<span id="sin"></span><h3><code class="docutils literal notranslate"><span class="pre">Sin</span></code><a class="headerlink" href="#sin" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Sin">
<em class="property">class </em><code class="descname">Sin</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Sin" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie le sinus d’un champ ou d’une expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.4</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">2.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_sin</span><span class="o">=</span><span class="n">Sin</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_sin</span><span class="o">=</span><span class="n">Sin</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_sin</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_sin</span>
<span class="go">(-0.7727644875559871, -0.7457052121767203)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Sin</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose sin() is less than 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__sin__lt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y__sin__lt</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-sqrt">
<span id="sqrt"></span><h3><code class="docutils literal notranslate"><span class="pre">Sqrt</span></code><a class="headerlink" href="#sqrt" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Sqrt">
<em class="property">class </em><code class="descname">Sqrt</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Sqrt" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la racine carrée d’un champ ou d’une expression numérique non négative.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">12.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_sqrt</span><span class="o">=</span><span class="n">Sqrt</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_sqrt</span><span class="o">=</span><span class="n">Sqrt</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_sqrt</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_sqrt</span>
<span class="go">(2.0, 3.46410)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Sqrt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose sqrt() is less than 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__sqrt__lt</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">y__sqrt__lt</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-tan">
<span id="tan"></span><h3><code class="docutils literal notranslate"><span class="pre">Tan</span></code><a class="headerlink" href="#tan" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Tan">
<em class="property">class </em><code class="descname">Tan</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Tan" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la tangente d’un champ ou d’une expression numérique.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Tan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">x_tan</span><span class="o">=</span><span class="n">Tan</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">y_tan</span><span class="o">=</span><span class="n">Tan</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector</span><span class="o">.</span><span class="n">x_tan</span><span class="p">,</span> <span class="n">vector</span><span class="o">.</span><span class="n">y_tan</span>
<span class="go">(0.0, -0.6358599286615808)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">FloatField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Tan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FloatField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Tan</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get vectors whose tangent is less than 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">Vector</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x__tan__lt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y__tan__lt</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-text-functions">
<span id="s-id3"></span><span id="text-functions"></span><span id="id3"></span><h2>Fonctions textuelles<a class="headerlink" href="#text-functions" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="s-chr">
<span id="chr"></span><h3><code class="docutils literal notranslate"><span class="pre">Chr</span></code><a class="headerlink" href="#chr" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Chr">
<em class="property">class </em><code class="descname">Chr</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Chr" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte un champ ou une expression numérique et renvoie la représentation textuelle de l’expression sous forme de caractère unique. Il fonctionne comme la fonction <a class="reference external" href="https://docs.python.org/3/library/functions.html#chr" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">chr()</span></code></a> de Python.</p>
<p>Comme <a class="reference internal" href="#django.db.models.functions.Length" title="django.db.models.functions.Length"><code class="xref py py-class docutils literal notranslate"><span class="pre">Length</span></code></a>, il peut être inscrit comme transformation pour <code class="docutils literal notranslate"><span class="pre">IntegerField</span></code>. Le nom de requête par défaut est <code class="docutils literal notranslate"><span class="pre">chr</span></code>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Chr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__startswith</span><span class="o">=</span><span class="n">Chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">Margaret Smith</span>
</pre></div>
</div>
</div>
<div class="section" id="s-concat">
<span id="concat"></span><h3><code class="docutils literal notranslate"><span class="pre">Concat</span></code><a class="headerlink" href="#concat" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Concat">
<em class="property">class </em><code class="descname">Concat</code>(<em>*expressions</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Concat" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte une liste d’au moins deux champs textes ou expressions et renvoie la concaténation de ces paramètres. Chaque paramètre doit être de type texte ou caractère. Si vous voulez concaténer un champ <code class="docutils literal notranslate"><span class="pre">TextField()</span></code> avec un champ <code class="docutils literal notranslate"><span class="pre">CharField()</span></code>, prenez alors la précaution d’indiquer à Django que le résultat <code class="docutils literal notranslate"><span class="pre">output_field</span></code> sera un champ <code class="docutils literal notranslate"><span class="pre">TextField()</span></code>. C’est aussi nécessaire lors de la concaténation avec une valeur <code class="docutils literal notranslate"><span class="pre">Value</span></code> comme dans l’exemple ci-dessous.</p>
<p>Le résultat de cette fonction n’est jamais nul. Pour les moteurs où un paramètre nul aboutit à ce que toute l’expression devienne nulle, Django s’assure que chaque partie nulle est préalablement convertie en chaîne vide.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the display name as &quot;name (goes_by)&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">CharField</span><span class="p">,</span> <span class="n">Value</span> <span class="k">as</span> <span class="n">V</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Concat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">,</span> <span class="n">goes_by</span><span class="o">=</span><span class="s1">&#39;Maggie&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">screen_name</span><span class="o">=</span><span class="n">Concat</span><span class="p">(</span>
<span class="gp">... </span>        <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">V</span><span class="p">(</span><span class="s1">&#39; (&#39;</span><span class="p">),</span> <span class="s1">&#39;goes_by&#39;</span><span class="p">,</span> <span class="n">V</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">output_field</span><span class="o">=</span><span class="n">CharField</span><span class="p">()</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">screen_name</span><span class="p">)</span>
<span class="go">Margaret Smith (Maggie)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-left">
<span id="left"></span><h3><code class="docutils literal notranslate"><span class="pre">Left</span></code><a class="headerlink" href="#left" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Left">
<em class="property">class </em><code class="descname">Left</code>(<em>expression</em>, <em>length</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Left" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie les n (<code class="docutils literal notranslate"><span class="pre">length</span></code>) premiers caractères du champ texte ou de l’expression donnée.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Left</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">first_initial</span><span class="o">=</span><span class="n">Left</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">first_initial</span><span class="p">)</span>
<span class="go">M</span>
</pre></div>
</div>
</div>
<div class="section" id="s-length">
<span id="length"></span><h3><code class="docutils literal notranslate"><span class="pre">Length</span></code><a class="headerlink" href="#length" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Length">
<em class="property">class </em><code class="descname">Length</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Length" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte un champ texte ou une expression unique et renvoie le nombre de caractères de la valeur. Si l’expression est nulle, la longueur renvoyée sera également nulle.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the length of the name and goes_by fields</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Length</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">name_length</span><span class="o">=</span><span class="n">Length</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span>
<span class="gp">... </span>   <span class="n">goes_by_length</span><span class="o">=</span><span class="n">Length</span><span class="p">(</span><span class="s1">&#39;goes_by&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">name_length</span><span class="p">,</span> <span class="n">author</span><span class="o">.</span><span class="n">goes_by_length</span><span class="p">)</span>
<span class="go">(14, None)</span>
</pre></div>
</div>
<p>Cette expression peut aussi être inscrite comme transformation. Par exemple&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">CharField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Length</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CharField</span><span class="o">.</span><span class="n">register_lookup</span><span class="p">(</span><span class="n">Length</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get authors whose name is longer than 7 characters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">authors</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__length__gt</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-lower">
<span id="lower"></span><h3><code class="docutils literal notranslate"><span class="pre">Lower</span></code><a class="headerlink" href="#lower" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Lower">
<em class="property">class </em><code class="descname">Lower</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Lower" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte un champ texte ou une expression unique et renvoie sa représentation en minuscules.</p>
<p>Cette expression peut aussi être inscrite comme transformation comme expliqué pour <a class="reference internal" href="#django.db.models.functions.Length" title="django.db.models.functions.Length"><code class="xref py py-class docutils literal notranslate"><span class="pre">Length</span></code></a>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Lower</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">name_lower</span><span class="o">=</span><span class="n">Lower</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">name_lower</span><span class="p">)</span>
<span class="go">margaret smith</span>
</pre></div>
</div>
</div>
<div class="section" id="s-lpad">
<span id="lpad"></span><h3><code class="docutils literal notranslate"><span class="pre">LPad</span></code><a class="headerlink" href="#lpad" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.LPad">
<em class="property">class </em><code class="descname">LPad</code>(<em>expression</em>, <em>length</em>, <em>fill_text=Value(' ')</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.LPad" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la valeur du champ texte ou de l’expression donnée remplie à sa gauche par <code class="docutils literal notranslate"><span class="pre">fill_text</span></code> afin que la longueur de la valeur résultante possède <code class="docutils literal notranslate"><span class="pre">length</span></code> caractères. La valeur par défaut de <code class="docutils literal notranslate"><span class="pre">fill_text</span></code> est un espace.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">Value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">LPad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">LPad</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">Value</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)))</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">abcaJohn</span>
</pre></div>
</div>
</div>
<div class="section" id="s-ltrim">
<span id="ltrim"></span><h3><code class="docutils literal notranslate"><span class="pre">LTrim</span></code><a class="headerlink" href="#ltrim" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.LTrim">
<em class="property">class </em><code class="descname">LTrim</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.LTrim" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Semblable à <a class="reference internal" href="#django.db.models.functions.Trim" title="django.db.models.functions.Trim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trim</span></code></a>, mais n’enlève que les espaces de début de chaîne.</p>
</div>
<div class="section" id="s-md5">
<span id="md5"></span><h3><code class="docutils literal notranslate"><span class="pre">MD5</span></code><a class="headerlink" href="#md5" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.MD5">
<em class="property">class </em><code class="descname">MD5</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.MD5" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<div class="versionadded">
<span class="title">New in Django 3.0.</span> </div>
<p>Accepte un champ texte ou une expression unique et renvoie l’empreinte MD5 de la chaîne.</p>
<p>Cette expression peut aussi être inscrite comme transformation comme expliqué pour <a class="reference internal" href="#django.db.models.functions.Length" title="django.db.models.functions.Length"><code class="xref py py-class docutils literal notranslate"><span class="pre">Length</span></code></a>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">MD5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">name_md5</span><span class="o">=</span><span class="n">MD5</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">name_md5</span><span class="p">)</span>
<span class="go">749fb689816b2db85f5b169c2055b247</span>
</pre></div>
</div>
</div>
<div class="section" id="s-ord">
<span id="ord"></span><h3><code class="docutils literal notranslate"><span class="pre">Ord</span></code><a class="headerlink" href="#ord" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Ord">
<em class="property">class </em><code class="descname">Ord</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Ord" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte un seul champ texte ou une expression et renvoie la valeur du point de code Unicode du premier caractère de cette expression. Il fonctionne comme la fonction <a class="reference external" href="https://docs.python.org/3/library/functions.html#ord" title="(disponible dans Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">ord()</span></code></a> de Python, mais aucune exception n’est générée si l’expression comporte plus d’un caractère.</p>
<p>Cette expression peut aussi être inscrite comme transformation comme expliqué pour <a class="reference internal" href="#django.db.models.functions.Length" title="django.db.models.functions.Length"><code class="xref py py-class docutils literal notranslate"><span class="pre">Length</span></code></a>. Le nom de requête par défaut est <code class="docutils literal notranslate"><span class="pre">ord</span></code>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Ord</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">name_code_point</span><span class="o">=</span><span class="n">Ord</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">name_code_point</span><span class="p">)</span>
<span class="go">77</span>
</pre></div>
</div>
</div>
<div class="section" id="s-repeat">
<span id="repeat"></span><h3><code class="docutils literal notranslate"><span class="pre">Repeat</span></code><a class="headerlink" href="#repeat" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Repeat">
<em class="property">class </em><code class="descname">Repeat</code>(<em>expression</em>, <em>number</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Repeat" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la valeur du champ texte ou de l’expression indiquée répétée <code class="docutils literal notranslate"><span class="pre">number</span></code> fois.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Repeat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">Repeat</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">JohnJohnJohn</span>
</pre></div>
</div>
</div>
<div class="section" id="s-replace">
<span id="replace"></span><h3><code class="docutils literal notranslate"><span class="pre">Replace</span></code><a class="headerlink" href="#replace" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Replace">
<em class="property">class </em><code class="descname">Replace</code>(<em>expression</em>, <em>text</em>, <em>replacement=Value('')</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Replace" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Remplace toutes les occurrences de <code class="docutils literal notranslate"><span class="pre">text</span></code> dans <code class="docutils literal notranslate"><span class="pre">expression</span></code> par <code class="docutils literal notranslate"><span class="pre">replacement</span></code>. Le texte de remplacement par défaut est la chaîne vide. Les paramètres de la fonction sont sensibles à la casse.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">Value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Replace</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Johnson&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">Replace</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">Value</span><span class="p">(</span><span class="s1">&#39;Margaret&#39;</span><span class="p">),</span> <span class="n">Value</span><span class="p">(</span><span class="s1">&#39;Margareth&#39;</span><span class="p">)))</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="go">&lt;QuerySet [{&#39;name&#39;: &#39;Margareth Johnson&#39;}, {&#39;name&#39;: &#39;Margareth Smith&#39;}]&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="s-reverse">
<span id="reverse"></span><h3><code class="docutils literal notranslate"><span class="pre">Reverse</span></code><a class="headerlink" href="#reverse" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Reverse">
<em class="property">class </em><code class="descname">Reverse</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Reverse" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte un champ texte ou une expression unique et renvoie les caractères de cette expression en ordre inverse.</p>
<p>Cette expression peut aussi être inscrite comme transformation comme expliqué pour <a class="reference internal" href="#django.db.models.functions.Length" title="django.db.models.functions.Length"><code class="xref py py-class docutils literal notranslate"><span class="pre">Length</span></code></a>. Le nom de requête par défaut est <code class="docutils literal notranslate"><span class="pre">reverse</span></code>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Reverse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">backward</span><span class="o">=</span><span class="n">Reverse</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">backward</span><span class="p">)</span>
<span class="go">htimS teragraM</span>
</pre></div>
</div>
</div>
<div class="section" id="s-right">
<span id="right"></span><h3><code class="docutils literal notranslate"><span class="pre">Right</span></code><a class="headerlink" href="#right" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Right">
<em class="property">class </em><code class="descname">Right</code>(<em>expression</em>, <em>length</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Right" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie les n (<code class="docutils literal notranslate"><span class="pre">length</span></code>) derniers caractères du champ texte ou de l’expression donnée.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Right</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">last_letter</span><span class="o">=</span><span class="n">Right</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">last_letter</span><span class="p">)</span>
<span class="go">h</span>
</pre></div>
</div>
</div>
<div class="section" id="s-rpad">
<span id="rpad"></span><h3><code class="docutils literal notranslate"><span class="pre">RPad</span></code><a class="headerlink" href="#rpad" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.RPad">
<em class="property">class </em><code class="descname">RPad</code>(<em>expression</em>, <em>length</em>, <em>fill_text=Value(' ')</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.RPad" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Semblable à <a class="reference internal" href="#django.db.models.functions.LPad" title="django.db.models.functions.LPad"><code class="xref py py-class docutils literal notranslate"><span class="pre">LPad</span></code></a>, mais applique le remplissage en fin de chaîne.</p>
</div>
<div class="section" id="s-rtrim">
<span id="rtrim"></span><h3><code class="docutils literal notranslate"><span class="pre">RTrim</span></code><a class="headerlink" href="#rtrim" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.RTrim">
<em class="property">class </em><code class="descname">RTrim</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.RTrim" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Semblable à <a class="reference internal" href="#django.db.models.functions.Trim" title="django.db.models.functions.Trim"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trim</span></code></a>, mais n’enlève que les espaces de fin de chaîne.</p>
</div>
<div class="section" id="s-sha1-sha224-sha256-sha384-and-sha512">
<span id="sha1-sha224-sha256-sha384-and-sha512"></span><h3><code class="docutils literal notranslate"><span class="pre">SHA1</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA224</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA256</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA384</span></code> et <code class="docutils literal notranslate"><span class="pre">SHA512</span></code><a class="headerlink" href="#sha1-sha224-sha256-sha384-and-sha512" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.SHA1">
<em class="property">class </em><code class="descname">SHA1</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.SHA1" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="django.db.models.functions.SHA224">
<em class="property">class </em><code class="descname">SHA224</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.SHA224" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="django.db.models.functions.SHA256">
<em class="property">class </em><code class="descname">SHA256</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.SHA256" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="django.db.models.functions.SHA384">
<em class="property">class </em><code class="descname">SHA384</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.SHA384" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="django.db.models.functions.SHA512">
<em class="property">class </em><code class="descname">SHA512</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.SHA512" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<div class="versionadded">
<span class="title">New in Django 3.0.</span> </div>
<p>Accepte un champ texte ou une expression unique et renvoie l’empreinte correspondante de la chaîne.</p>
<p>Elles peuvent aussi être inscrites comme transformations comme expliqué pour <a class="reference internal" href="#django.db.models.functions.Length" title="django.db.models.functions.Length"><code class="xref py py-class docutils literal notranslate"><span class="pre">Length</span></code></a>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">SHA1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">name_sha1</span><span class="o">=</span><span class="n">SHA1</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">name_sha1</span><span class="p">)</span>
<span class="go">b87efd8a6c991c390be5a68e8a7945a7851c7e5c</span>
</pre></div>
</div>
<div class="admonition-postgresql admonition">
<p class="first admonition-title">PostgreSQL</p>
<p class="last">L”<a class="reference external" href="https://www.postgresql.org/docs/current/pgcrypto.html">extension pgcrypto</a> doit être installée. Vous pouvez utiliser l’opération de migration <a class="reference internal" href="../contrib/postgres/operations.html#django.contrib.postgres.operations.CryptoExtension" title="django.contrib.postgres.operations.CryptoExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">CryptoExtension</span></code></a> pour l’installer.</p>
</div>
<div class="admonition-oracle admonition">
<p class="first admonition-title">Oracle</p>
<p class="last">Oracle ne prend pas en charge la fonction <code class="docutils literal notranslate"><span class="pre">SHA224</span></code>.</p>
</div>
</div>
<div class="section" id="s-strindex">
<span id="strindex"></span><h3><code class="docutils literal notranslate"><span class="pre">StrIndex</span></code><a class="headerlink" href="#strindex" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.StrIndex">
<em class="property">class </em><code class="descname">StrIndex</code>(<em>string</em>, <em>substring</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.StrIndex" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie un nombre entier positif correspondant à la position indicée (commençant à 1) de la première occurrence de <code class="docutils literal notranslate"><span class="pre">substring</span></code> dans <code class="docutils literal notranslate"><span class="pre">string</span></code>, ou 0 si <code class="docutils literal notranslate"><span class="pre">substring</span></code> est introuvable.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">Value</span> <span class="k">as</span> <span class="n">V</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">StrIndex</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Smith, Margaret&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Jackson&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Jackson&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">smith_index</span><span class="o">=</span><span class="n">StrIndex</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">V</span><span class="p">(</span><span class="s1">&#39;Smith&#39;</span><span class="p">))</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">smith_index</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">authors</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">smith_index</span><span class="o">=</span><span class="n">StrIndex</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">V</span><span class="p">(</span><span class="s1">&#39;Smith&#39;</span><span class="p">))</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">smith_index__gt</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&lt;QuerySet [&lt;Author: Margaret Smith&gt;, &lt;Author: Smith, Margaret&gt;]&gt;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Avertissement</p>
<p class="last">Avec MySQL, la <a class="reference internal" href="../databases.html#mysql-collation"><span class="std std-ref">collation</span></a> d’une table de base de données détermine si les comparaisons de chaînes (telles que dans <code class="docutils literal notranslate"><span class="pre">expression</span></code> et <code class="docutils literal notranslate"><span class="pre">substring</span></code> de cette fonction) sont sensibles à la casse. Par défaut, les comparaisons ne sont pas sensibles à la casse.</p>
</div>
</div>
<div class="section" id="s-substr">
<span id="substr"></span><h3><code class="docutils literal notranslate"><span class="pre">Substr</span></code><a class="headerlink" href="#substr" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Substr">
<em class="property">class </em><code class="descname">Substr</code>(<em>expression</em>, <em>pos</em>, <em>length=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Substr" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie une sous-chaîne de longueur <code class="docutils literal notranslate"><span class="pre">length</span></code> extraite du champ ou de l’expression à partir de la position <code class="docutils literal notranslate"><span class="pre">pos</span></code>. L’indice de position commence à 1, il doit donc être plus grand que 0. Si <code class="docutils literal notranslate"><span class="pre">length</span></code> vaut <code class="docutils literal notranslate"><span class="pre">None</span></code>, tout le reste de la chaîne est renvoyé comme résultat.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set the alias to the first 5 characters of the name as lowercase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Lower</span><span class="p">,</span> <span class="n">Substr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="n">Lower</span><span class="p">(</span><span class="n">Substr</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">)</span>
<span class="go">marga</span>
</pre></div>
</div>
</div>
<div class="section" id="s-trim">
<span id="trim"></span><h3><code class="docutils literal notranslate"><span class="pre">Trim</span></code><a class="headerlink" href="#trim" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Trim">
<em class="property">class </em><code class="descname">Trim</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Trim" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la valeur du champ texte ou de l’expression indiquée sans les espaces de début et de fin de chaîne.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Trim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;  John  &#39;</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">Trim</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">John</span>
</pre></div>
</div>
</div>
<div class="section" id="s-upper">
<span id="upper"></span><h3><code class="docutils literal notranslate"><span class="pre">Upper</span></code><a class="headerlink" href="#upper" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Upper">
<em class="property">class </em><code class="descname">Upper</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Upper" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Accepte un champ texte ou une expression unique et renvoie sa représentation en majuscules.</p>
<p>Cette expression peut aussi être inscrite comme transformation comme expliqué pour <a class="reference internal" href="#django.db.models.functions.Length" title="django.db.models.functions.Length"><code class="xref py py-class docutils literal notranslate"><span class="pre">Length</span></code></a>.</p>
<p>Exemple d’utilisation&nbsp;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="k">import</span> <span class="n">Upper</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Margaret Smith&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">author</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">name_upper</span><span class="o">=</span><span class="n">Upper</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">name_upper</span><span class="p">)</span>
<span class="go">MARGARET SMITH</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-window-functions">
<span id="s-id4"></span><span id="window-functions"></span><span id="id4"></span><h2>Fonctions de fenêtrage<a class="headerlink" href="#window-functions" title="Lien permanent vers ce titre">¶</a></h2>
<p>Il existe un certain nombre de fonctions à utiliser dans une expression <a class="reference internal" href="expressions.html#django.db.models.expressions.Window" title="django.db.models.expressions.Window"><code class="xref py py-class docutils literal notranslate"><span class="pre">Window</span></code></a> pour calculer la position des éléments ou le <a class="reference internal" href="#django.db.models.functions.Ntile" title="django.db.models.functions.Ntile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ntile</span></code></a> de certaines lignes.</p>
<div class="section" id="s-cumedist">
<span id="cumedist"></span><h3><code class="docutils literal notranslate"><span class="pre">CumeDist</span></code><a class="headerlink" href="#cumedist" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.CumeDist">
<em class="property">class </em><code class="descname">CumeDist</code>(<em>*expressions</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.CumeDist" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Calcule la distribution cumulative d’une valeur à l’intérieur d’une fenêtre ou d’une partition. La distribution cumulative est définie comme le nombre de lignes précédant ou apparentées à la ligne actuelle divisé par le nombre total de lignes dans l’intervalle.</p>
</div>
<div class="section" id="s-denserank">
<span id="denserank"></span><h3><code class="docutils literal notranslate"><span class="pre">DenseRank</span></code><a class="headerlink" href="#denserank" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.DenseRank">
<em class="property">class </em><code class="descname">DenseRank</code>(<em>*expressions</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.DenseRank" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Équivalent à <a class="reference internal" href="#django.db.models.functions.Rank" title="django.db.models.functions.Rank"><code class="xref py py-class docutils literal notranslate"><span class="pre">Rank</span></code></a> mais sans « trous ».</p>
</div>
<div class="section" id="s-firstvalue">
<span id="firstvalue"></span><h3><code class="docutils literal notranslate"><span class="pre">FirstValue</span></code><a class="headerlink" href="#firstvalue" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.FirstValue">
<em class="property">class </em><code class="descname">FirstValue</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.FirstValue" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Renvoie la valeur évaluée à la ligne se situant en premier dans l’intervalle de fenêtre, ou <code class="docutils literal notranslate"><span class="pre">None</span></code> si une telle valeur n’existe pas.</p>
</div>
<div class="section" id="s-lag">
<span id="lag"></span><h3><code class="docutils literal notranslate"><span class="pre">Lag</span></code><a class="headerlink" href="#lag" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Lag">
<em class="property">class </em><code class="descname">Lag</code>(<em>expression</em>, <em>offset=1</em>, <em>default=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Lag" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Calcule le décalage de valeur selon <code class="docutils literal notranslate"><span class="pre">offset</span></code>, et si aucune ligne n’existe à cet endroit, renvoie <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">default</span></code> doit avoir le même type que <code class="docutils literal notranslate"><span class="pre">expression</span></code>; cependant, cette validation se fait dans la base de données et pas dans le code Python.</p>
<div class="admonition-mariadb-and-default admonition">
<p class="first admonition-title">MariaDB et <code class="docutils literal notranslate"><span class="pre">default</span></code></p>
<p class="last">MariaDB <a class="reference external" href="https://jira.mariadb.org/browse/MDEV-12981">ne prend pas en charge</a> le paramètre <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
</div>
</div>
<div class="section" id="s-lastvalue">
<span id="lastvalue"></span><h3><code class="docutils literal notranslate"><span class="pre">LastValue</span></code><a class="headerlink" href="#lastvalue" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.LastValue">
<em class="property">class </em><code class="descname">LastValue</code>(<em>expression</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.LastValue" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Comparable à <a class="reference internal" href="#django.db.models.functions.FirstValue" title="django.db.models.functions.FirstValue"><code class="xref py py-class docutils literal notranslate"><span class="pre">FirstValue</span></code></a>, renvoie la dernière valeur dans une clause d’intervalle donnée.</p>
</div>
<div class="section" id="s-lead">
<span id="lead"></span><h3><code class="docutils literal notranslate"><span class="pre">Lead</span></code><a class="headerlink" href="#lead" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Lead">
<em class="property">class </em><code class="descname">Lead</code>(<em>expression</em>, <em>offset=1</em>, <em>default=None</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Lead" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Calcule la valeur de tête dans un <a class="reference internal" href="expressions.html#window-frames"><span class="std std-ref">intervalle</span></a> donné. <code class="docutils literal notranslate"><span class="pre">offset</span></code> et <code class="docutils literal notranslate"><span class="pre">default</span></code> sont tous deux évalués en fonction de la ligne actuelle.</p>
<p><code class="docutils literal notranslate"><span class="pre">default</span></code> doit avoir le même type que <code class="docutils literal notranslate"><span class="pre">expression</span></code>; cependant, cette validation se fait dans la base de données et pas dans le code Python.</p>
<div class="admonition-mariadb-and-default admonition">
<p class="first admonition-title">MariaDB et <code class="docutils literal notranslate"><span class="pre">default</span></code></p>
<p class="last">MariaDB <a class="reference external" href="https://jira.mariadb.org/browse/MDEV-12981">ne prend pas en charge</a> le paramètre <code class="docutils literal notranslate"><span class="pre">default</span></code>.</p>
</div>
</div>
<div class="section" id="s-nthvalue">
<span id="nthvalue"></span><h3><code class="docutils literal notranslate"><span class="pre">NthValue</span></code><a class="headerlink" href="#nthvalue" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.NthValue">
<em class="property">class </em><code class="descname">NthValue</code>(<em>expression</em>, <em>nth=1</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.NthValue" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Calcule la ligne relative au décalage <code class="docutils literal notranslate"><span class="pre">nth</span></code> (la valeur doit être positive) à l’intérieur de la fenêtre. Renvoie <code class="docutils literal notranslate"><span class="pre">None</span></code> si aucune ligne ne correspond.</p>
<p>Certaines bases de données gèrent différemment une nième valeur inexistante. Par exemple, Oracle renvoie une chaîne vide au lieu de <code class="docutils literal notranslate"><span class="pre">None</span></code> pour les expressions basées sur des caractères. Django n’applique aucune conversion dans ces cas.</p>
</div>
<div class="section" id="s-ntile">
<span id="ntile"></span><h3><code class="docutils literal notranslate"><span class="pre">Ntile</span></code><a class="headerlink" href="#ntile" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Ntile">
<em class="property">class </em><code class="descname">Ntile</code>(<em>num_buckets=1</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Ntile" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Calcule une partition pour chacune des lignes dans la clause d’intervalle, distribuant les nombres aussi également que possible entre 1 et <code class="docutils literal notranslate"><span class="pre">num_buckets</span></code>. Si les lignes ne sont pas divisibles de manière égale par le nombre de « buckets », un ou plusieurs de ceux-ci seront représentés plus fréquemment.</p>
</div>
<div class="section" id="s-percentrank">
<span id="percentrank"></span><h3><code class="docutils literal notranslate"><span class="pre">PercentRank</span></code><a class="headerlink" href="#percentrank" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.PercentRank">
<em class="property">class </em><code class="descname">PercentRank</code>(<em>*expressions</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.PercentRank" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Calcule le rang de centile des lignes dans la clause d’intervalle. Ce calcul est équivalent à l’évaluation de</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">rank</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">total</span> <span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Le tableau suivant explique le calcul du rang de centile d’une ligne :</p>
<table class="docutils">
<colgroup>
<col width="13%" />
<col width="13%" />
<col width="11%" />
<col width="32%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">N° de ligne</th>
<th class="head">Valeur</th>
<th class="head">Rang</th>
<th class="head">Calcul</th>
<th class="head">Rang en pourcentage</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>15</td>
<td>1</td>
<td>(1-1)/(7-1)</td>
<td>0.0000</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>20</td>
<td>2</td>
<td>(2-1)/(7-1)</td>
<td>0.1666</td>
</tr>
<tr class="row-even"><td>3</td>
<td>20</td>
<td>2</td>
<td>(2-1)/(7-1)</td>
<td>0.1666</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>20</td>
<td>2</td>
<td>(2-1)/(7-1)</td>
<td>0.1666</td>
</tr>
<tr class="row-even"><td>5</td>
<td>30</td>
<td>5</td>
<td>(5-1)/(7-1)</td>
<td>0.6666</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>30</td>
<td>5</td>
<td>(5-1)/(7-1)</td>
<td>0.6666</td>
</tr>
<tr class="row-even"><td>7</td>
<td>40</td>
<td>7</td>
<td>(7-1)/(7-1)</td>
<td>1.0000</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="s-rank">
<span id="rank"></span><h3><code class="docutils literal notranslate"><span class="pre">Rank</span></code><a class="headerlink" href="#rank" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.Rank">
<em class="property">class </em><code class="descname">Rank</code>(<em>*expressions</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.Rank" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Comparable à <code class="docutils literal notranslate"><span class="pre">RowNumber</span></code>, cette fonction calcule le rang des lignes de la fenêtre. Le rang calculé comporte des trous. Utilisez <a class="reference internal" href="#django.db.models.functions.DenseRank" title="django.db.models.functions.DenseRank"><code class="xref py py-class docutils literal notranslate"><span class="pre">DenseRank</span></code></a> pour calculer le rang sans trous.</p>
</div>
<div class="section" id="s-rownumber">
<span id="rownumber"></span><h3><code class="docutils literal notranslate"><span class="pre">RowNumber</span></code><a class="headerlink" href="#rownumber" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="class">
<dt id="django.db.models.functions.RowNumber">
<em class="property">class </em><code class="descname">RowNumber</code>(<em>*expressions</em>, <em>**extra</em>)<a class="headerlink" href="#django.db.models.functions.RowNumber" title="Lien permanent vers cette définition">¶</a></dt>
<dd></dd></dl>

<p>Calcule le numéro de ligne selon le tri de la clause d’intervalle ou selon le tri de toute la requête s’il n’y a pas partition dans l”<a class="reference internal" href="expressions.html#window-frames"><span class="std std-ref">intervalle de fenêtre</span></a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Fonctions de base de données</a><ul>
<li><a class="reference internal" href="#comparison-and-conversion-functions">Fonctions de comparaison et de conversion</a><ul>
<li><a class="reference internal" href="#cast"><code class="docutils literal notranslate"><span class="pre">Cast</span></code></a></li>
<li><a class="reference internal" href="#coalesce"><code class="docutils literal notranslate"><span class="pre">Coalesce</span></code></a></li>
<li><a class="reference internal" href="#greatest"><code class="docutils literal notranslate"><span class="pre">Greatest</span></code></a></li>
<li><a class="reference internal" href="#least"><code class="docutils literal notranslate"><span class="pre">Least</span></code></a></li>
<li><a class="reference internal" href="#nullif"><code class="docutils literal notranslate"><span class="pre">NullIf</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#date-functions">Fonctions de date</a><ul>
<li><a class="reference internal" href="#extract"><code class="docutils literal notranslate"><span class="pre">Extract</span></code></a><ul>
<li><a class="reference internal" href="#datefield-extracts">Extractions <code class="docutils literal notranslate"><span class="pre">DateField</span></code></a></li>
<li><a class="reference internal" href="#datetimefield-extracts">Extractions <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#now"><code class="docutils literal notranslate"><span class="pre">Now</span></code></a></li>
<li><a class="reference internal" href="#trunc"><code class="docutils literal notranslate"><span class="pre">Trunc</span></code></a><ul>
<li><a class="reference internal" href="#datefield-truncation">Troncature de <code class="docutils literal notranslate"><span class="pre">DateField</span></code></a></li>
<li><a class="reference internal" href="#datetimefield-truncation">Troncature de <code class="docutils literal notranslate"><span class="pre">DateTimeField</span></code></a></li>
<li><a class="reference internal" href="#timefield-truncation">Troncature de <code class="docutils literal notranslate"><span class="pre">TimeField</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#math-functions">Fonctions mathématiques</a><ul>
<li><a class="reference internal" href="#abs"><code class="docutils literal notranslate"><span class="pre">Abs</span></code></a></li>
<li><a class="reference internal" href="#acos"><code class="docutils literal notranslate"><span class="pre">ACos</span></code></a></li>
<li><a class="reference internal" href="#asin"><code class="docutils literal notranslate"><span class="pre">ASin</span></code></a></li>
<li><a class="reference internal" href="#atan"><code class="docutils literal notranslate"><span class="pre">ATan</span></code></a></li>
<li><a class="reference internal" href="#atan2"><code class="docutils literal notranslate"><span class="pre">ATan2</span></code></a></li>
<li><a class="reference internal" href="#ceil"><code class="docutils literal notranslate"><span class="pre">Ceil</span></code></a></li>
<li><a class="reference internal" href="#cos"><code class="docutils literal notranslate"><span class="pre">Cos</span></code></a></li>
<li><a class="reference internal" href="#cot"><code class="docutils literal notranslate"><span class="pre">Cot</span></code></a></li>
<li><a class="reference internal" href="#degrees"><code class="docutils literal notranslate"><span class="pre">Degrees</span></code></a></li>
<li><a class="reference internal" href="#exp"><code class="docutils literal notranslate"><span class="pre">Exp</span></code></a></li>
<li><a class="reference internal" href="#floor"><code class="docutils literal notranslate"><span class="pre">Floor</span></code></a></li>
<li><a class="reference internal" href="#ln"><code class="docutils literal notranslate"><span class="pre">Ln</span></code></a></li>
<li><a class="reference internal" href="#log"><code class="docutils literal notranslate"><span class="pre">Log</span></code></a></li>
<li><a class="reference internal" href="#mod"><code class="docutils literal notranslate"><span class="pre">Mod</span></code></a></li>
<li><a class="reference internal" href="#pi"><code class="docutils literal notranslate"><span class="pre">Pi</span></code></a></li>
<li><a class="reference internal" href="#power"><code class="docutils literal notranslate"><span class="pre">Power</span></code></a></li>
<li><a class="reference internal" href="#radians"><code class="docutils literal notranslate"><span class="pre">Radians</span></code></a></li>
<li><a class="reference internal" href="#round"><code class="docutils literal notranslate"><span class="pre">Round</span></code></a></li>
<li><a class="reference internal" href="#sign"><code class="docutils literal notranslate"><span class="pre">Sign</span></code></a></li>
<li><a class="reference internal" href="#sin"><code class="docutils literal notranslate"><span class="pre">Sin</span></code></a></li>
<li><a class="reference internal" href="#sqrt"><code class="docutils literal notranslate"><span class="pre">Sqrt</span></code></a></li>
<li><a class="reference internal" href="#tan"><code class="docutils literal notranslate"><span class="pre">Tan</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#text-functions">Fonctions textuelles</a><ul>
<li><a class="reference internal" href="#chr"><code class="docutils literal notranslate"><span class="pre">Chr</span></code></a></li>
<li><a class="reference internal" href="#concat"><code class="docutils literal notranslate"><span class="pre">Concat</span></code></a></li>
<li><a class="reference internal" href="#left"><code class="docutils literal notranslate"><span class="pre">Left</span></code></a></li>
<li><a class="reference internal" href="#length"><code class="docutils literal notranslate"><span class="pre">Length</span></code></a></li>
<li><a class="reference internal" href="#lower"><code class="docutils literal notranslate"><span class="pre">Lower</span></code></a></li>
<li><a class="reference internal" href="#lpad"><code class="docutils literal notranslate"><span class="pre">LPad</span></code></a></li>
<li><a class="reference internal" href="#ltrim"><code class="docutils literal notranslate"><span class="pre">LTrim</span></code></a></li>
<li><a class="reference internal" href="#md5"><code class="docutils literal notranslate"><span class="pre">MD5</span></code></a></li>
<li><a class="reference internal" href="#ord"><code class="docutils literal notranslate"><span class="pre">Ord</span></code></a></li>
<li><a class="reference internal" href="#repeat"><code class="docutils literal notranslate"><span class="pre">Repeat</span></code></a></li>
<li><a class="reference internal" href="#replace"><code class="docutils literal notranslate"><span class="pre">Replace</span></code></a></li>
<li><a class="reference internal" href="#reverse"><code class="docutils literal notranslate"><span class="pre">Reverse</span></code></a></li>
<li><a class="reference internal" href="#right"><code class="docutils literal notranslate"><span class="pre">Right</span></code></a></li>
<li><a class="reference internal" href="#rpad"><code class="docutils literal notranslate"><span class="pre">RPad</span></code></a></li>
<li><a class="reference internal" href="#rtrim"><code class="docutils literal notranslate"><span class="pre">RTrim</span></code></a></li>
<li><a class="reference internal" href="#sha1-sha224-sha256-sha384-and-sha512"><code class="docutils literal notranslate"><span class="pre">SHA1</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA224</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA256</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA384</span></code> et <code class="docutils literal notranslate"><span class="pre">SHA512</span></code></a></li>
<li><a class="reference internal" href="#strindex"><code class="docutils literal notranslate"><span class="pre">StrIndex</span></code></a></li>
<li><a class="reference internal" href="#substr"><code class="docutils literal notranslate"><span class="pre">Substr</span></code></a></li>
<li><a class="reference internal" href="#trim"><code class="docutils literal notranslate"><span class="pre">Trim</span></code></a></li>
<li><a class="reference internal" href="#upper"><code class="docutils literal notranslate"><span class="pre">Upper</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#window-functions">Fonctions de fenêtrage</a><ul>
<li><a class="reference internal" href="#cumedist"><code class="docutils literal notranslate"><span class="pre">CumeDist</span></code></a></li>
<li><a class="reference internal" href="#denserank"><code class="docutils literal notranslate"><span class="pre">DenseRank</span></code></a></li>
<li><a class="reference internal" href="#firstvalue"><code class="docutils literal notranslate"><span class="pre">FirstValue</span></code></a></li>
<li><a class="reference internal" href="#lag"><code class="docutils literal notranslate"><span class="pre">Lag</span></code></a></li>
<li><a class="reference internal" href="#lastvalue"><code class="docutils literal notranslate"><span class="pre">LastValue</span></code></a></li>
<li><a class="reference internal" href="#lead"><code class="docutils literal notranslate"><span class="pre">Lead</span></code></a></li>
<li><a class="reference internal" href="#nthvalue"><code class="docutils literal notranslate"><span class="pre">NthValue</span></code></a></li>
<li><a class="reference internal" href="#ntile"><code class="docutils literal notranslate"><span class="pre">Ntile</span></code></a></li>
<li><a class="reference internal" href="#percentrank"><code class="docutils literal notranslate"><span class="pre">PercentRank</span></code></a></li>
<li><a class="reference internal" href="#rank"><code class="docutils literal notranslate"><span class="pre">Rank</span></code></a></li>
<li><a class="reference internal" href="#rownumber"><code class="docutils literal notranslate"><span class="pre">RowNumber</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Sujet précédent</h4>
  <p class="topless"><a href="conditional-expressions.html"
                        title="Chapitre précédent">Expressions conditionnelles</a></p>
  <h4>Sujet suivant</h4>
  <p class="topless"><a href="../paginator.html"
                        title="Chapitre suivant">Pagination</a></p>
  <div role="note" aria-label="source link">
    <h3>Cette page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/ref/models/database-functions.txt"
            rel="nofollow">Montrer le code source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">oct. 29, 2020</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="conditional-expressions.html" title="Expressions conditionnelles">previous</a>
     |
    <a href="../index.html" title="Référence de l’API" accesskey="U">up</a>
   |
    <a href="../paginator.html" title="Pagination">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>